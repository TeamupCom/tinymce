/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.8.1 (2021-05-20)
 */
!function(){"use strict";var n,t=function(e){return function(t){return t=typeof(n=t),(null===n?"null":"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t)===e;var n}},e=function(n){return function(t){return typeof t===n}},v=t("string"),b=t("object"),c=t("array"),y=e("boolean"),o=(n=undefined,function(t){return n===t}),i=function(t){return!(null===(t=t)||t===undefined)},f=e("function"),$=e("number"),u=function(t,n){if(c(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},Q=function(){},a=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(o.apply(null,t))}},W=function(t){return function(){return t}},w=function(t){return t};function m(o){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=r.concat(t);return o.apply(null,e)}}var x=function(n){return function(t){return!n(t)}},s=function(t){return function(){throw new Error(t)}},l=W(!1),S=W(!0),r=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Z=function(){return(Z=Object.assign||function Z(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function d(t,n){var e={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]]);return e}function p(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;for(var o=Array(t),r=0,n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var g,h=function(){return k},k=(Ua=function(t){return t.isNone()},{fold:function(t,n){return t()},is:l,isSome:l,isNone:S,getOr:ma=function(t){return t},getOrThunk:ja=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:W(null),getOrUndefined:W(undefined),or:ma,orThunk:ja,map:h,each:Q,bind:h,exists:l,forall:S,filter:h,equals:Ua,equals_:Ua,toArray:function(){return[]},toString:W("none()")}),C=function(e){var t=W(e),n=function(){return r},o=function(t){return t(e)},r={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:S,isNone:l,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return C(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?r:k},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(l,function(t){return n(e,t)})}};return r},tt={some:C,none:h,from:function(t){return null===t||t===undefined?k:C(t)}},O=Array.prototype.slice,_=Array.prototype.indexOf,T=Array.prototype.push,E=function(t,n){return _.call(t,n)},D=function(t,n){return-1<E(t,n)},B=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},A=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},M=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=O.call(t,o,o+n);e.push(r)}return e},F=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},nt=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},I=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},R=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},V=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e)}(t,function(t){e=n(e,t)}),e},P=function(t,n,e){return nt(t,function(t){e=n(e,t)}),e},H=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return tt.some(i);if(e(i,o))break}return tt.none()}(t,n,l)},z=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return tt.some(e);return tt.none()},et=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!c(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);T.apply(n,t[e])}return n},N=function(t,n){return et(F(t,n))},L=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},j=function(t){t=O.call(t,0);return t.reverse(),t},U=function(t,n){return R(t,function(t){return!D(n,t)})},G=function(t,n){t=O.call(t,0);return t.sort(n),t},X=function(t,n){return 0<=n&&n<t.length?tt.some(t[n]):tt.none()},Y=function(t){return X(t,0)},q=function(t){return X(t,t.length-1)},K=f(Array.from)?Array.from:function(t){return O.call(t)},J=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return tt.none()},ot=function(e){return{is:function(t){return e===t},isValue:S,isError:l,getOr:W(e),getOrThunk:W(e),getOrDie:W(e),or:function(t){return ot(e)},orThunk:function(t){return ot(e)},fold:function(t,n){return n(e)},map:function(t){return ot(t(e))},mapError:function(t){return ot(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return tt.some(e)}}},rt=function(e){return{is:l,isValue:l,isError:S,getOr:w,getOrThunk:function(t){return t()},getOrDie:function(){return s(String(e))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,n){return t(e)},map:function(t){return rt(e)},mapError:function(t){return rt(t(e))},each:Q,bind:function(t){return rt(e)},exists:l,forall:S,toOptional:tt.none}},it={value:ot,error:rt,fromOption:function(t,n){return t.fold(function(){return rt(n)},ot)}};(nc=g=g||{})[nc.Error=0]="Error",nc[nc.Value=1]="Value";var ut,at,ct=function(t,n,e){return t.stype===g.Error?n(t.serror):e(t.svalue)},st=function(t){return{stype:g.Value,svalue:t}},lt=function(t){return{stype:g.Error,serror:t}},ft=function(t){return t.fold(lt,st)},dt=function(t){return ct(t,it.error,it.value)},mt=st,gt=function(t){var n=[],e=[];return nt(t,function(t){ct(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},pt=lt,ht=function(t,n){return t.stype===g.Value?n(t.svalue):t},vt=function(t,n){return t.stype===g.Error?n(t.serror):t},bt=function(t,n){return t.stype===g.Value?{stype:g.Value,svalue:n(t.svalue)}:t},yt=function(t,n){return t.stype===g.Error?{stype:g.Error,serror:n(t.serror)}:t},xt=Object.keys,wt=Object.hasOwnProperty,St=function(t,n){for(var e=xt(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},kt=function(t,e){return Ct(t,function(t,n){return{k:n,v:e(t,n)}})},Ct=function(t,e){var o={};return St(t,function(t,n){n=e(t,n);o[n.k]=n.v}),o},Ot=function(t,n){var e,o,r,i,u={};return e=n,i=u,o=function(t,n){i[n]=t},r=Q,St(t,function(t,n){(e(t,n)?o:r)(t,n)}),u},_t=function(t,e){var o=[];return St(t,function(t,n){o.push(e(t,n))}),o},Tt=function(t,n){for(var e=xt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return tt.some(u)}return tt.none()},Et=function(t){return _t(t,function(t){return t})},Dt=function(t,n){return Bt(t,n)?tt.from(t[n]):tt.none()},Bt=function(t,n){return wt.call(t,n)},At=function(t,n){return Bt(t,n)&&t[n]!==undefined&&null!==t[n]},Mt=function(u){if(!c(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],e={};return nt(u,function(t,o){var n=xt(t);if(1!==n.length)throw new Error("one and only one name per case");var r=n[0],i=t[r];if(e[r]!==undefined)throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!c(i))throw new Error("case arguments must be an array");a.push(r),e[r]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+n);return{fold:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+t.length);return t[o].apply(null,e)},match:function(t){var n=xt(t);if(a.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+n.join(","));if(!L(a,function(t){return D(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+a.join(", "));return t[r].apply(null,e)},log:function(t){console.log(t,{constructors:a,constructor:r,params:e})}}}}),e},Ft=Object.prototype.hasOwnProperty,It=function(u){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<t.length;o++){var r,i=t[o];for(r in i)Ft.call(i,r)&&(e[r]=u(e[r],i[r]))}return e}},Rt=It(function(t,n){return b(t)&&b(n)?Rt(t,n):n}),Vt=It(function(t,n){return n}),Pt=function(e){var o,r=!1;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r||(r=!0,o=e.apply(null,t)),o}},Ht=Mt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),zt=function(t){return Ht.defaultedThunk(W(t))},Nt=Ht.strict,Lt=Ht.asOption,jt=Ht.defaultedThunk,Ut=(Ht.asDefaultedOptionThunk,Ht.mergeWithThunk),Wt=(Mt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={};return e[t]=n,e}),Gt=function(t,n){return e=n,o={},St(t,function(t,n){D(e,n)||(o[n]=t)}),o;var e,o},Xt=Wt,Yt=function(t){return n={},nt(t,function(t){n[t.key]=t.value}),n;var n},qt=function(t,n){var e,o,r=(e=[],o=[],nt(t,function(t){t.fold(function(t){e.push(t)},function(t){o.push(t)})}),{errors:e,values:o});return 0<r.errors.length?(t=r.errors,it.error(et(t))):(n=n,0===(r=r.values).length?it.value(n):it.value(Rt(n,Vt.apply(undefined,r))))},Kt=function(t){return a(pt,et)(t)},Jt=function(t,n){t=gt(t);return 0<t.errors.length?Kt(t.errors):(t=t.values,n=n,0<t.length?mt(Rt(n,Vt.apply(undefined,t))):mt(n))},$t=function(t){t=gt(t);return 0<t.errors.length?Kt(t.errors):mt(t.values)},Qt=function(t){return b(t)&&100<xt(t).length?" removed due to size":JSON.stringify(t,null,2)},Zt=function(t,n){return pt([{path:t,getErrorInfo:n}])},tn=Mt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),nn=function(e,o,r){return Dt(o,r).fold(function(){return t=r,n=o,Zt(e,function(){return'Could not find valid *strict* value for "'+t+'" in '+Qt(n)});var t,n},mt)},en=function(t,n,e){n=Dt(t,n).fold(function(){return e(t)},w);return mt(n)},on=function(u,a,t,c){return t.fold(function(e,n,t,o){var r=function(t){t=o.extract(u.concat([e]),c,t);return bt(t,function(t){return Wt(n,c(t))})},i=function(t){return t.fold(function(){var t=Wt(n,c(tt.none()));return mt(t)},function(t){t=o.extract(u.concat([e]),c,t);return bt(t,function(t){return Wt(n,c(tt.some(t)))})})};return t.fold(function(){return ht(nn(u,a,e),r)},function(t){return ht(en(a,e,t),r)},function(){return ht(mt(Dt(a,e)),i)},function(t){return ht(function(n,t,e){t=Dt(n,t).map(function(t){return!0===t?e(n):t});return mt(t)}(a,e,t),i)},function(t){var n=t(a),t=bt(en(a,e,W({})),function(t){return Rt(n,t)});return ht(t,r)})},function(t,n){n=n(a);return mt(Wt(t,c(n)))})},rn=function(o){return{extract:function(e,t,n){return vt(o(n,t),function(t){return n=t,Zt(e,function(){return n});var n})},toString:function(){return"val"}}},un=function(t){var i=an(t),u=V(t,function(n,t){return t.fold(function(t){return Rt(n,Xt(t,!0))},W(n))},{});return{extract:function(t,n,e){var o,r=y(e)?[]:xt(Ot(e,function(t){return t!==undefined&&null!==t})),r=R(r,function(t){return!At(u,t)});return 0===r.length?i.extract(t,n,e):(o=r,Zt(t,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:i.toString}},an=function(o){return{extract:function(t,n,e){return function(n,e,t,o){t=F(t,function(t){return on(n,e,t,o)});return Jt(t,{})}(t,e,o,n)},toString:function(){return"obj{\n"+F(o,function(t){return t.fold(function(t,n,e,o){return t+" -> "+o.toString()},function(t,n){return"state("+t+")"})}).join("\n")+"}"}}},cn=function(r){return{extract:function(e,o,t){t=F(t,function(t,n){return r.extract(e.concat(["["+n+"]"]),o,t)});return $t(t)},toString:function(){return"array("+r.toString()+")"}}},sn=function(a){return{extract:function(t,n,e){for(var o=[],r=0,i=a;r<i.length;r++){var u=i[r].extract(t,n,e);if(u.stype===g.Value)return u;o.push(u)}return $t(o)},toString:function(){return"oneOf("+F(a,function(t){return t.toString()}).join(", ")+")"}}},ln=function(r,i){return{extract:function(n,e,o){var t=xt(o),t=cn(rn(r)).extract(n,w,t);return ht(t,function(t){t=F(t,function(t){return tn.field(t,t,Nt(),i)});return an(t).extract(n,e,o)})},toString:function(){return"setOf("+i.toString()+")"}}},fn=W(rn(mt)),dn=a(cn,an),mn=tn.state,gn=tn.field,pn=function(e,n,o,r,i){return Dt(r,i).fold(function(){return t=r,n=i,Zt(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Qt(t)});var t,n},function(t){return t.extract(e.concat(["branch: "+i]),n,o)})},hn=function(r,i){return{extract:function(n,e,o){return Dt(o,r).fold(function(){return t=r,Zt(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(t){return pn(n,e,o,i,t)})},toString:function(){return"chooseOn("+r+"). Possible values: "+xt(i)}}},vn=rn(mt),bn=function(t){return dn(t)},yn=function(o){return{extract:function(t,n,e){return o().extract(t,n,e)},toString:function(){return o().toString()}}},xn=function(n){return rn(function(t){return n(t).fold(pt,mt)})},wn=function(n,t){return ln(function(t){return ft(n(t))},t)},Sn=function(t,n,e){return dt(function(t,n,e,o){e=n.extract([t],e,o);return yt(e,function(t){return{input:o,errors:t}})}(t,n,w,e))},kn=function(t){return t.fold(function(t){throw new Error(On(t))},w)},Cn=function(t,n,e){return kn(Sn(t,n,e))},On=function(t){return"Errors: \n"+function(t){t=10<t.length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t;return F(t,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})}(t.errors).join("\n")+"\n\nInput object: "+Qt(t.input)},_n=hn,Tn=function(t,n){return hn(t,kt(n,an))},En=W(vn),Dn=function(e,o){return rn(function(t){var n=typeof t;return e(t)?mt(t):pt("Expected type: "+o+" but got: "+n)})},Bn=Dn($,"number"),An=Dn(v,"string"),Mn=Dn(y,"boolean"),Fn=Dn(f,"function"),In=function(n){var t=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every(function(t){return In(n[t])});case"Map":return t(n.keys(),In)&&t(n.values(),In);case"Set":return t(n.keys(),In);default:return!1}},Rn=rn(function(t){return In(t)?mt(t):pt("Expected value to be acceptable for sending via postMessage")}),Vn=function(n){return xn(function(t){return D(n,t)?it.value(t):it.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')})},Pn=function(t){return gn(t,t,Nt(),fn())},Hn=function(t,n){return gn(t,t,Nt(),n)},zn=function(t){return Hn(t,An)},Nn=function(t,n){return gn(t,t,Nt(),Vn(n))},Ln=function(t){return Hn(t,Fn)},jn=function(t,n){return gn(t,t,Nt(),an(n))},Un=function(t,n){return gn(t,t,Nt(),dn(n))},Wn=function(t,n){return gn(t,t,Nt(),cn(n))},Gn=function(t){return gn(t,t,Lt(),fn())},Xn=function(t,n){return gn(t,t,Lt(),n)},Yn=function(t){return Xn(t,Bn)},qn=function(t){return Xn(t,An)},Kn=function(t){return Xn(t,Fn)},Jn=function(t,n){return Xn(t,an(n))},$n=function(t,n){return gn(t,t,zt(n),fn())},Qn=function(t,n,e){return gn(t,t,zt(n),e)},Zn=function(t,n){return Qn(t,n,Bn)},te=function(t,n){return Qn(t,n,An)},ne=function(t,n,e){return Qn(t,n,Vn(e))},ee=function(t,n){return Qn(t,n,Mn)},oe=function(t,n){return Qn(t,n,Fn)},re=function(t,n,e){return Qn(t,n,cn(e))},ie=function(t,n,e){return Qn(t,n,an(e))},ue=function(t,n){return mn(t,n)},ae=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},ce=function(t){if(null===t||t===undefined)throw new Error("Node cannot be null or undefined");return{dom:t}},se={fromHtml:function(t,n){n=(n||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return ce(n.childNodes[0])},fromTag:function(t,n){t=(n||document).createElement(t);return ce(t)},fromText:function(t,n){t=(n||document).createTextNode(t);return ce(t)},fromDom:ce,fromPoint:function(t,n,e){return tt.from(t.dom.elementFromPoint(n,e)).map(ce)}},le=function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}return undefined}(t,n);if(!e)return{major:0,minor:0};t=function(t){return Number(n.replace(e,"$"+t))};return de(t(1),t(2))},fe=function(){return de(0,0)},de=function(t,n){return{major:t,minor:n}},me={nu:de,detect:function(t,n){n=String(n).toLowerCase();return 0===t.length?fe():le(t,n)},unknown:fe},ge=function(t,n){var e=String(n).toLowerCase();return H(t,function(t){return t.search(e)})},pe=function(t,e){return ge(t,e).map(function(t){var n=me.detect(t.versionRegexes,e);return{current:t.name,version:n}})},he=function(t,e){return ge(t,e).map(function(t){var n=me.detect(t.versionRegexes,e);return{current:t.name,version:n}})},ve=function(t,n){return-1!==t.indexOf(n)},be=function(t,n){return e=n,n=(t=t).length-n.length,""===e||t.length>=e.length&&t.substr(n,n+e.length)===e;var e},ye=(ut=/^\s+|\s+$/g,function(t){return t.replace(ut,"")}),xe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,we=function(n){return function(t){return ve(t,n)}},Se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return ve(t,"edge/")&&ve(t,"chrome")&&ve(t,"safari")&&ve(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,xe],search:function(t){return ve(t,"chrome")&&!ve(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return ve(t,"msie")||ve(t,"trident")}},{name:"Opera",versionRegexes:[xe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:we("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:we("firefox")},{name:"Safari",versionRegexes:[xe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(ve(t,"safari")||ve(t,"mobile/"))&&ve(t,"applewebkit")}}],ke=[{name:"Windows",search:we("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return ve(t,"iphone")||ve(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:we("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:we("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:we("linux"),versionRegexes:[]},{name:"Solaris",search:we("sunos"),versionRegexes:[]},{name:"FreeBSD",search:we("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:we("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ce={browsers:W(Se),oses:W(ke)},Oe="Firefox",_e=function(t){var n=t.current,e=t.version,t=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:t("Edge"),isChrome:t("Chrome"),isIE:t("IE"),isOpera:t("Opera"),isFirefox:t(Oe),isSafari:t("Safari")}},Te={unknown:function(){return _e({current:undefined,version:me.unknown()})},nu:_e,edge:W("Edge"),chrome:W("Chrome"),ie:W("IE"),opera:W("Opera"),firefox:W(Oe),safari:W("Safari")},Ee="Windows",De="Android",Be="Solaris",Ae="FreeBSD",Me="ChromeOS",Fe=function(t){var n=t.current,e=t.version,t=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:t(Ee),isiOS:t("iOS"),isAndroid:t(De),isOSX:t("OSX"),isLinux:t("Linux"),isSolaris:t(Be),isFreeBSD:t(Ae),isChromeOS:t(Me)}},Ie={unknown:function(){return Fe({current:undefined,version:me.unknown()})},nu:Fe,windows:W(Ee),ios:W("iOS"),android:W(De),linux:W("Linux"),osx:W("OSX"),solaris:W(Be),freebsd:W(Ae),chromeos:W(Me)},Re=function(t,n){var e,o,r=Ce.browsers(),i=Ce.oses(),u=pe(r,t).fold(Te.unknown,Te.nu),a=he(i,t).fold(Ie.unknown,Ie.nu);return{browser:u,os:a,deviceType:(e=u,o=t,r=n,u=(i=a).isiOS()&&!0===/ipad/i.test(o),t=i.isiOS()&&!u,n=i.isiOS()||i.isAndroid(),a=n||r("(pointer:coarse)"),r=u||!t&&n&&r("(min-device-width:768px)"),n=t||n&&!r,o=e.isSafari()&&i.isiOS()&&!1===/safari/i.test(o),{isiPad:W(u),isiPhone:W(t),isTablet:W(r),isPhone:W(n),isTouch:W(a),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:W(o),isDesktop:W(!n&&!r&&!o)})}},Ve=function(t){return window.matchMedia(t).matches},Pe=Pt(function(){return Re(navigator.userAgent,Ve)}),He=function(t,n){t=t.dom;if(1!==t.nodeType)return!1;if(t.matches!==undefined)return t.matches(n);if(t.msMatchesSelector!==undefined)return t.msMatchesSelector(n);if(t.webkitMatchesSelector!==undefined)return t.webkitMatchesSelector(n);if(t.mozMatchesSelector!==undefined)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},ze=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Ne=function(t,n){return t.dom===n.dom},Le=function(t,n){return e=t.dom,t=n.dom,n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(t)&n);var e},je=function(t,n){return(Pe().browser.isIE()?Le:function(t,n){t=t.dom,n=n.dom;return t!==n&&t.contains(n)})(t,n)},Ue=function(t){return f(t)?t:l},We=function(t,n,e){for(var o=t.dom,r=Ue(e);o.parentNode;){var o=o.parentNode,i=se.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return tt.none()},Ge=function(t,n,e){var o=n(t),r=Ue(e);return o.orThunk(function(){return r(t)?tt.none():We(t,n,r)})},Xe=function(t,n){return Ne(t.element,n.event.target)},Ye=function(t){if(!At(t,"can")&&!At(t,"abort")&&!At(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return Cn("Extracting event.handler",un([$n("can",S),$n("abort",l),$n("run",Q)]),t)},qe=function(e){var n,o,r,i,t=(o=function(t){return t.can},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P(n,function(t,n){return t&&o(n).apply(undefined,e)},!0)}),u=(r=n=e,i=function(t){return t.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P(r,function(t,n){return t||i(n).apply(undefined,e)},!1)});return Ye({can:t,abort:u,run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];nt(e,function(t){t.run.apply(undefined,n)})}})},Ke=W,Je=Ke("touchstart"),$e=Ke("touchmove"),Qe=Ke("touchend"),Ze=Ke("touchcancel"),to=Ke("mousedown"),no=Ke("mousemove"),eo=Ke("mouseout"),oo=Ke("mouseup"),ro=Ke("mouseover"),io=Ke("focusin"),uo=Ke("focusout"),ao=Ke("keydown"),co=Ke("keyup"),so=Ke("input"),lo=Ke("change"),fo=Ke("click"),mo=Ke("transitionend"),go=Ke("selectstart"),po=function(t){return W("alloy."+t)},ho={tap:po("tap")},vo=po("focus"),bo=po("blur.post"),yo=po("paste.post"),xo=po("receive"),wo=po("execute"),So=po("focus.item"),ko=ho.tap,Co=po("longpress"),Oo=po("sandbox.close"),_o=po("typeahead.cancel"),To=po("system.init"),Eo=po("system.touchmove"),Do=po("system.touchend"),Bo=po("system.scroll"),Ao=po("system.resize"),Mo=po("system.attached"),Fo=po("system.detached"),Io=po("system.dismissRequested"),Ro=po("system.repositionRequested"),Vo=po("focusmanager.shifted"),Po=po("slotcontainer.visibility"),Ho=po("change.tab"),zo=po("dismiss.tab"),No=po("highlight"),Lo=po("dehighlight"),jo=function(t,n){Xo(t,t.element,n,{})},Uo=function(t,n,e){Xo(t,t.element,n,e)},Wo=function(t){jo(t,wo())},Go=function(t,n,e){Xo(t,n,e,{})},Xo=function(t,n,e,o){o=Z({target:n},o);t.getSystem().triggerEvent(e,n,o)},Yo=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},qo=Yt,Ko=function(t,n){return{key:t,value:Ye({abort:n})}},Jo=function(t){return{key:t,value:Ye({run:function(t,n){n.event.prevent()}})}},$o=function(t,n){return{key:t,value:Ye({run:n})}},Qo=function(t,e,o){return{key:t,value:Ye({run:function(t,n){e.apply(undefined,[t,n].concat(o))}})}},Zo=function(t){return function(e){return{key:t,value:Ye({run:function(t,n){Xe(t,n)&&e(t,n)}})}}},tr=function(t,n,e){var o,r,e=n.partUids[e];return r=e,$o(o=t,function(t,n){t.getSystem().getByUid(r).each(function(t){Yo(t,t.element,o,n)})})},nr=function(t,r){return $o(t,function(n,t){var e=t.event,o=n.getSystem().getByDom(e.target).fold(function(){return Ge(e.target,function(t){return n.getSystem().getByDom(t).toOptional()},l).getOr(n)},function(t){return t});r(n,o,t)})},er=function(t){return $o(t,function(t,n){n.cut()})},or=function(t,n){return Zo(t)(n)},rr=Zo(Mo()),ir=Zo(Fo()),ur=Zo(To()),ar=(at=wo(),function(t){return $o(at,t)}),cr=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),sr=function(n){return function(t){return t.dom.nodeType===n}},lr=sr(1),fr=sr(3),dr=sr(9),mr=sr(11),gr=function(t){return se.fromDom(t.dom.ownerDocument)},pr=function(t){return dr(t)?t:gr(t)},hr=function(t){return se.fromDom(pr(t).dom.documentElement)},vr=function(t){return se.fromDom(pr(t).dom.defaultView)},br=function(t){return tt.from(t.dom.parentNode).map(se.fromDom)},yr=br,xr=function(t){return tt.from(t.dom.offsetParent).map(se.fromDom)},wr=function(t){return F(t.dom.childNodes,se.fromDom)},Sr=function(t,n){t=t.dom.childNodes;return tt.from(t[n]).map(se.fromDom)},kr=function(t){return mr(t)&&i(t.dom.host)},Cr=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),Or=W(Cr),_r=Cr?function(t){return se.fromDom(t.dom.getRootNode())}:pr,Tr=function(t){return kr(t)?t:se.fromDom(pr(t).dom.body)},Er=function(t){t=_r(t);return kr(t)?tt.some(t):tt.none()},Dr=function(t){return se.fromDom(t.dom.host)},Br=function(t){return i(t.dom.shadowRoot)},Ar=function(n,e){br(n).each(function(t){t.dom.insertBefore(e.dom,n.dom)})},Mr=function(t,n){tt.from(t.dom.nextSibling).map(se.fromDom).fold(function(){br(t).each(function(t){Ir(t,n)})},function(t){Ar(t,n)})},Fr=function(n,e){Sr(n,0).fold(function(){Ir(n,e)},function(t){n.dom.insertBefore(e.dom,t.dom)})},Ir=function(t,n){t.dom.appendChild(n.dom)},Rr=function(n,t){nt(t,function(t){Ir(n,t)})},Vr=function(t){t.dom.textContent="",nt(wr(t),function(t){Pr(t)})},Pr=function(t){t=t.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Hr=function(t){var n,e=wr(t);0<e.length&&(n=t,nt(e,function(t){Ar(n,t)})),Pr(t)},zr=function(t){return t.dom.innerHTML},Nr=function(t,n){var e=gr(t).dom,o=se.fromDom(e.createDocumentFragment()),e=function(t,n){n=(n||document).createElement("div");return n.innerHTML=t,wr(se.fromDom(n))}(n,e);Rr(o,e),Vr(t),Ir(t,o)},Lr=function(t,n,e){if(!(v(e)||y(e)||$(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},jr=function(t,n,e){Lr(t.dom,n,e)},Ur=function(t,n){n=t.dom.getAttribute(n);return null===n?undefined:n},Wr=function(t,n){return tt.from(Ur(t,n))},Gr=function(t,n){t=t.dom;return!(!t||!t.hasAttribute)&&t.hasAttribute(n)},Xr=function(t,n){t.dom.removeAttribute(n)},Yr=function(t){return n=!1,se.fromDom(t.dom.cloneNode(n));var n},qr=function(t){if(kr(t))return"#shadow-root";var n=Yr(t);return t=n,n=se.fromTag("div"),t=se.fromDom(t.dom.cloneNode(!0)),Ir(n,t),zr(n)},Kr=qo([{key:vo(),value:Ye({can:function(t,n){var e=n.event,o=e.originator,r=e.target;return n=r,!(Ne(e=o,t.element)&&!Ne(e,n))||(console.warn(vo()+" did not get interpreted by the desired target. \nOriginator: "+qr(o)+"\nTarget: "+qr(r)+"\nCheck the "+vo()+" event handlers"),!1)}})}]),Jr=Object.freeze({__proto__:null,events:Kr}),$r=0,Qr=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++$r+String(n)},Zr=W("alloy-id-"),ti=W("data-alloy-id"),ni=Zr(),ei=ti(),oi=function(t,n){Object.defineProperty(t.dom,ei,{value:n,writable:!0})},ri=function(t){t=lr(t)?t.dom[ei]:null;return tt.from(t)},ii=Qr,ui=w,ai=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+qr(n().element)+" is not in context.":""))}};return{debugInfo:W("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:l}},ci=ai(),si=function(t){return F(t,function(t){return be(t,"/*")?t.substring(0,t.length-"/*".length):t})},li=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:si(i)}},t},fi=Qr("alloy-premade"),di=function(t){return Xt(fi,t)},mi=function(o){return t=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return o.apply(void 0,p([t.getApis(),t],n))},e=(n=o).toString(),r=e.indexOf(")")+1,n=e.indexOf("("),i=e.substring(n+1,r-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:si(i.slice(1))}},t;var t,n,e,r,i},gi={init:function(){return pi({readState:function(){return"No State required"}})}},pi=function(t){return t},hi=function(t,r){var i={};return St(t,function(t,o){St(t,function(t,n){var e=Dt(i,n).getOr([]);i[n]=e.concat([r(o,t)])})}),i},vi=function(t){return{classes:t.classes!==undefined?t.classes:[],attributes:t.attributes!==undefined?t.attributes:{},styles:t.styles!==undefined?t.styles:{}}},bi=function(r,i,t,u){try{var n=G(t,function(t,n){var e=t[i],o=n[i],t=u.indexOf(e),n=u.indexOf(o);if(-1===t)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(u,null,2));return t<n?-1:n<t?1:0});return it.value(n)}catch(e){return it.error([e])}},yi=function(t){return t.cHandler},xi=function(t,n){return{name:t,handler:n}},wi=function(t,n,e){var o,r,n=Z(Z({},e),(o=t,r={},nt(n,function(t){r[t.name()]=t.handlers(o)}),r));return hi(n,xi)},Si=function(t){var r=f(t=t)?{can:S,abort:l,run:t}:t;return function(t,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];t=[t,n].concat(e);r.abort.apply(undefined,t)?n.stop():r.can.apply(undefined,t)&&r.run.apply(undefined,t)}},ki=function(t,n,e){n=n[e];return n?bi("Event: "+e,"name",t,n).map(function(t){t=F(t,function(t){return t.handler});return qe(t)}):it.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(F(t,function(t){return t.name}),null,2)])},Ci=function(t,r){t=_t(t,function(e,o){return(1===e.length?it.value(e[0].handler):ki(e,r,o)).map(function(t){var n=Si(t),t=1<e.length?R(r[o],function(n){return B(e,function(t){return t.name===n})}).join(" > "):e[0].name;return Xt(o,{handler:n,purpose:t})})});return qt(t,{})},Oi="alloy.base.behaviour",_i=function(t){var n;return Sn("custom.definition",an([gn("dom","dom",Nt(),an([Pn("tag"),$n("styles",{}),$n("classes",[]),$n("attributes",{}),Gn("value"),Gn("innerHtml")])),Pn("components"),Pn("uid"),$n("events",{}),$n("apis",{}),gn("eventOrder","eventOrder",((n={})[wo()]=["disabling",Oi,"toggling","typeaheadevents"],n[vo()]=[Oi,"focusing","keying"],n[To()]=[Oi,"disabling","toggling","representing"],n[so()]=[Oi,"representing","streaming","invalidating"],n[Fo()]=[Oi,"representing","item-events","tooltipping"],n[to()]=["focusing",Oi,"item-type-events"],n[Je()]=["focusing",Oi,"item-type-events"],n[ro()]=["item-type-events","tooltipping"],n[xo()]=["receiving","reflecting","tooltipping"],n,Ht.mergeWithThunk(W(n))),En()),Gn("domModification")]),t)},Ti=function(t,n){n=Ur(t,n);return n===undefined||""===n?[]:n.split(" ")},Ei=function(t){return t.dom.classList!==undefined},Di=function(t,n){return function(t,n,e){e=Ti(t,n).concat([e]);return jr(t,n,e.join(" ")),!0}(t,"class",n)},Bi=function(t,n){return o=n,0<(t=R(Ti(e=t,n="class"),function(t){return t!==o})).length?jr(e,n,t.join(" ")):Xr(e,n),!1;var e,o},Ai=function(t,n){Ei(t)?t.dom.classList.add(n):Di(t,n)},Mi=function(t){0===(Ei(t)?t.dom.classList:Ti(t,"class")).length&&Xr(t,"class")},Fi=function(t,n){Ei(t)?t.dom.classList.remove(n):Bi(t,n),Mi(t)},Ii=function(t,n){return Ei(t)&&t.dom.classList.contains(n)},Ri=function(n,t){nt(t,function(t){Ai(n,t)})},Vi=function(n,t){nt(t,function(t){Fi(n,t)})},Pi=function(t){return t.style!==undefined&&f(t.style.getPropertyValue)},Hi=function(t){var n=fr(t)?t.dom.parentNode:t.dom;if(n===undefined||null===n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return Er(se.fromDom(n)).fold(function(){return r.body.contains(n)},(e=Hi,o=Dr,function(t){return e(o(t))}))},zi=function(){return Ni(se.fromDom(document))},Ni=function(t){t=t.dom.body;if(null===t||t===undefined)throw new Error("Body is not available yet");return se.fromDom(t)},Li=function(t,n,e){if(!v(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Pi(t)&&t.style.setProperty(n,e)},ji=function(t,n){Pi(t)&&t.style.removeProperty(n)},Ui=function(t,n,e){t=t.dom;Li(t,n,e)},Wi=function(t,n){var e=t.dom;St(n,function(t,n){Li(e,n,t)})},Gi=function(t,n){var e=t.dom;St(n,function(t,n){t.fold(function(){ji(e,n)},function(t){Li(e,n,t)})})},Xi=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Hi(t)?o:Yi(e,n)},Yi=function(t,n){return Pi(t)?t.style.getPropertyValue(n):""},qi=function(t,n){t=t.dom,n=Yi(t,n);return tt.from(n).filter(function(t){return 0<t.length})},Ki=function(t,n,e){t=se.fromTag(t);return Ui(t,n,e),qi(t,n).isSome()},Ji=function(t,n){var e=t.dom;ji(e,n),Wr(t,"style").map(ye).is("")&&Xr(t,"style")},$i=function(t){return t.dom.offsetWidth},Qi=function(t){return t.dom.value},Zi=function(t,n){if(n===undefined)throw new Error("Value.set was undefined");t.dom.value=n},tu=function(t){var e,n=se.fromTag(t.tag);o=t.attributes,e=n.dom,St(o,function(t,n){Lr(e,n,t)}),Ri(n,t.classes),Wi(n,t.styles),t.innerHtml.each(function(t){return Nr(n,t)});var o=t.domChildren;return Rr(n,o),t.value.each(function(t){Zi(n,t)}),t.uid,oi(n,t.uid),n},nu=function(t,n){return e=t,n=F(t=n,function(t){return Jn(t.name(),[Pn("config"),$n("state",gi)])}),n=Sn("component.behaviours",an(n),e.behaviours).fold(function(t){throw new Error(On(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},function(t){return t}),{list:t,data:kt(n,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return n}})};var e},eu=function(t){var n,e,n=(e=Dt(n=t,"behaviours").getOr({}),n=R(xt(e),function(t){return e[t]!==undefined}),F(n,function(t){return e[t].me}));return nu(t,n)},ou=function(t,n,e){var o,o=Z(Z({},(o=t).dom),{uid:o.uid,domChildren:F(o.components,function(t){return t.element})}),t=t.domModification.fold(function(){return vi({})},vi),t=0<n.length?function(n,t,e,o){var r=Z({},t);nt(e,function(t){r[t.name()]=t.exhibit(n,o)});var i=hi(r,function(t,n){return{name:t,modification:n}}),u=function(t){return V(t,function(t,n){return Z(Z({},n.modification),t)},{})},t=V(i.classes,function(t,n){return n.modification.concat(t)},[]),e=u(i.attributes),i=u(i.styles);return vi({classes:t,attributes:e,styles:i})}(e,{"alloy.base.modification":t},n,o):t;return t=t,Z(Z({},o=o),{attributes:Z(Z({},o.attributes),t.attributes),styles:Z(Z({},o.styles),t.styles),classes:o.classes.concat(t.classes)})},ru=function(t,n,e){var o={"alloy.base.behaviour":t.events};return function(t,n,e,o){o=wi(t,e,o);return Ci(o,n)}(e,t.eventOrder,n,o).getOrDie()},iu=function(t){var e,n,o,r,i,u,a,c,s=ui(t),l=s.events,t=d(s,["events"]),s=function(t){t=Dt(t,"components").getOr([]);return F(t,su)}(t),l=Z(Z({},t),{events:Z(Z({},Jr),l),components:s});return it.value((n=function(){return c},o=ae(ci),r=kn(_i(e=l)),s=eu(e),l=s.list,i=s.data,s=ou(r,l,i),u=tu(s),l=ru(r,l,i),a=ae(r.components),c={getSystem:o.get,config:function(t){var n=i;return(f(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return f(i[t.name()])},spec:e,readState:function(t){return i[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return r.apis},connect:function(t){o.set(t)},disconnect:function(){o.set(ai(n))},element:u,syncComponents:function(){var t=wr(u),t=N(t,function(t){return o.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});a.set(t)},components:a.get,events:l}))},uu=function(t){t=se.fromText(t);return au({element:t})},au=function(t){var n=Cn("external.component",un([Pn("element"),Gn("uid")]),t),e=ae(ai());n.uid.each(function(t){oi(n.element,t)});var o={getSystem:e.get,config:tt.none,hasConfigured:l,connect:function(t){e.set(t)},disconnect:function(){e.set(ai(function(){return o}))},getApis:function(){return{}},element:n.element,spec:t,readState:W("No state"),syncComponents:Q,components:W([]),events:{}};return di(o)},cu=ii,su=function(n){return Dt(n,fi).fold(function(){var t=n.hasOwnProperty("uid")?n:Z({uid:cu("")},n);return iu(t).getOrDie()},function(t){return t})},lu=di,fu=function(e,o){var t=function(t){var n=o(t);if(n<=0||null===n){t=Xi(t,e);return parseFloat(t)||0}return n},r=function(e,t){return P(t,function(t,n){n=Xi(e,n),n=n===undefined?0:parseInt(n,10);return isNaN(n)?t:t+n},0)};return{set:function(t,n){if(!$(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);t=t.dom;Pi(t)&&(t.style[e]=n+"px")},get:t,getOuter:t,aggregate:r,max:function(t,n,e){e=r(t,e);return e<n?n-e:0}}},du=fu("height",function(t){var n=t.dom;return Hi(t)?n.getBoundingClientRect().height:n.offsetHeight}),mu=function(t){return du.get(t)},gu=function(t){return du.getOuter(t)},pu=function(e,o){return{left:e,top:o,translate:function(t,n){return pu(e+t,o+n)}}},hu=pu,vu=function(t,n){return t!==undefined?t:n!==undefined?n:0},bu=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return hu(e.offsetLeft,e.offsetTop);var i=vu(null==o?void 0:o.pageYOffset,r.scrollTop),n=vu(null==o?void 0:o.pageXOffset,r.scrollLeft),o=vu(r.clientTop,e.clientTop),e=vu(r.clientLeft,e.clientLeft);return yu(t).translate(n-e,i-o)},yu=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?hu(e.offsetLeft,e.offsetTop):Hi(t)?function(t){t=t.getBoundingClientRect();return hu(t.left,t.top)}(n):hu(0,0)},xu=fu("width",function(t){return t.dom.offsetWidth}),wu=function(t){return xu.get(t)},Su=function(t){return xu.getOuter(t)},ku=function(t){var n=se.fromDom(function(t){if(Or()&&i(t.target)){var n=se.fromDom(t.target);if(lr(n)&&Br(n)&&t.composed&&t.composedPath){n=t.composedPath();if(n)return Y(n)}}return tt.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=a(o,e);return{target:n,x:t.clientX,y:t.clientY,stop:e,prevent:o,kill:r,raw:t}},Cu=function(t,n,e,o,r){var i,u,o=(i=e,u=o,function(t){i(t)&&u(ku(t))});return t.dom.addEventListener(n,o,r),{unbind:m(Ou,t,n,o,r)}},Ou=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},_u=function(t){var n=t!==undefined?t.dom:document,t=n.body.scrollLeft||n.documentElement.scrollLeft,n=n.body.scrollTop||n.documentElement.scrollTop;return hu(t,n)},Tu=function(t,n,e){e=(e!==undefined?e.dom:document).defaultView;e&&e.scrollTo(t,n)},Eu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Du=function(t){var e=t===undefined?window:t,t=e.document,o=_u(se.fromDom(t));return function(t){t=t===undefined?window:t;return tt.from(t.visualViewport)}(e).fold(function(){var t=e.document.documentElement,n=t.clientWidth,t=t.clientHeight;return Eu(o.left,o.top,n,t)},function(t){return Eu(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)})},Bu=function(e,t){return e.view(t).fold(W([]),function(t){var n=e.owner(t),n=Bu(e,n);return[t].concat(n)})},Au=Object.freeze({__proto__:null,view:function(t){return(t.dom===document?tt.none():tt.from(null===(t=t.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(se.fromDom)},owner:gr}),Mu=function(e){var t=se.fromDom(document),o=_u(t);return function(t,n){t=n.owner(t),t=Bu(n,t);return tt.some(t)}(e,Au).fold(m(bu,e),function(t){var n=yu(e),t=V(t,function(t,n){n=yu(n);return{left:t.left+n.left,top:t.top+n.top}},{left:0,top:0});return hu(t.left+n.left+o.left,t.top+n.top+o.top)})},Fu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Iu=function(t){var n=bu(t),e=Su(t),t=gu(t);return Fu(n.left,n.top,e,t)},Ru=function(t){var n=Mu(t),e=Su(t),t=gu(t);return Fu(n.left,n.top,e,t)},Vu=function(){return Du(window)};function Pu(t,n,e,o,r){return t(e,o)?tt.some(e):f(r)&&r(e)?tt.none():n(e,o,r)}var Hu,zu=function(t,n,e){for(var o=t.dom,r=f(e)?e:l;o.parentNode;){var o=o.parentNode,i=se.fromDom(o);if(n(i))return tt.some(i);if(r(i))break}return tt.none()},Nu=function(t,n,e){return Pu(function(t,n){return n(t)},zu,t,n,e)},Lu=function(t,n,e){return Nu(t,n,e).isSome()},ju=function(t,n,e){return zu(t,function(t){return He(t,n)},e)},Uu=function(t,n){return function(t,n){n=n===undefined?document:n.dom;return ze(n)?tt.none():tt.from(n.querySelector(t)).map(se.fromDom)}(n,t)},Wu=function(t,n,e){return Pu(He,ju,t,n,e)},Gu=function(){var n=Qr("aria-owns");return{id:n,link:function(t){jr(t,"aria-owns",n)},unlink:function(t){Xr(t,"aria-owns")}}},Xu=function(n,t){return Nu(t,function(t){if(!lr(t))return!1;t=Ur(t,"id");return t!==undefined&&-1<t.indexOf("aria-owns")}).bind(function(t){var n=Ur(t,"id"),t=_r(t);return Uu(t,'[aria-owns="'+n+'"]')}).exists(function(t){return Yu(n,t)})},Yu=function(n,t){return Lu(t,function(t){return Ne(t,n.element)},l)||Xu(n,t)},qu="unknown";(il=Hu=Hu||{})[il.STOP=0]="STOP",il[il.NORMAL=1]="NORMAL",il[il.LOGGING=2]="LOGGING";var Ku,Ju=ae({}),$u=["alloy/data/Fields","alloy/debugging/Debugging"],Qu=function(n,t,e){var o,r,i,u;switch(Dt(Ju.get(),n).orThunk(function(){var t=xt(Ju.get());return J(t,function(t){return-1<n.indexOf(t)?tt.some(Ju.get()[t]):tt.none()})}).getOr(Hu.NORMAL)){case Hu.NORMAL:return e(Zu());case Hu.LOGGING:var a=(o=n,r=t,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();D(["mousemove","mouseover","mouseout",To()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:F(i,function(t){return D(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+qr(t.target)+")":t.outcome})})}}),c=e(a);return a.write(),c;case Hu.STOP:return!0}},Zu=W({logEventCut:Q,logEventStopped:Q,logNoParent:Q,logEventNoHandlers:Q,logEventResponse:Q,write:Q}),ta=W([Pn("menu"),Pn("selectedMenu")]),na=W([Pn("item"),Pn("selectedItem")]),ea=(W(an(na().concat(ta()))),W(an(na()))),oa=jn("initSize",[Pn("numColumns"),Pn("numRows")]),ra=function(){return jn("markers",[Pn("backgroundMenu")].concat(ta()).concat(na()))},ia=function(t){return jn("markers",F(t,Pn))},ua=function(t,n,e){!function(){var t=new Error;if(t.stack===undefined)return;t=t.stack.split("\n");H(t,function(n){return 0<n.indexOf("alloy")&&!B($u,function(t){return-1<n.indexOf(t)})}).getOr(qu)}();return gn(n,n,e,xn(function(e){return it.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(undefined,t)})}))},aa=function(t){return ua(0,t,zt(Q))},ca=function(t){return ua(0,t,zt(tt.none))},sa=function(t){return ua(0,t,Nt())},t=function(t){return ua(0,t,Nt())},la=function(t,n){return ue(t,W(n))},fa=function(t){return ue(t,w)},e=W(oa),da=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},ma=Mt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ga=ma.southeast,pa=ma.southwest,ha=ma.northeast,va=ma.northwest,ba=ma.south,ya=ma.north,xa=ma.east,wa=ma.west,Sa=function(n,e){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e}(["left","right","top","bottom"],function(t){return Dt(e,t).map(function(t){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(n,t)})})},ka=function(t,n){return t.x+t.width/2-n.width/2},Ca=function(t,n){return t.x+t.width-n.width},Oa=function(t,n){return t.y-n.height},_a=function(t){return t.y+t.height},Ta=function(t,n){return t.y+t.height/2-n.height/2},Ea=function(t,n,e){return da(t.x,_a(t),e.southeast(),ga(),Sa(t,{left:1,top:3}),"layout-se")},Da=function(t,n,e){return da(Ca(t,n),_a(t),e.southwest(),pa(),Sa(t,{right:0,top:3}),"layout-sw")},Ba=function(t,n,e){return da(t.x,Oa(t,n),e.northeast(),ha(),Sa(t,{left:1,bottom:2}),"layout-ne")},Aa=function(t,n,e){return da(Ca(t,n),Oa(t,n),e.northwest(),va(),Sa(t,{right:0,bottom:2}),"layout-nw")},Ma=function(t,n,e){return da(ka(t,n),Oa(t,n),e.north(),ya(),Sa(t,{bottom:2}),"layout-n")},Fa=function(t,n,e){return da(ka(t,n),_a(t),e.south(),ba(),Sa(t,{top:3}),"layout-s")},Ia=function(t,n,e){return da(t.x+t.width,Ta(t,n),e.east(),xa(),Sa(t,{left:0}),"layout-e")},Ra=function(t,n,e){return da(t.x-n.width,Ta(t,n),e.west(),wa(),Sa(t,{right:1}),"layout-w")},Va=function(){return[Ea,Da,Ba,Aa,Fa,Ma,Ia,Ra]},Pa=function(){return[Da,Ea,Aa,Ba,Fa,Ma,Ia,Ra]},Ha=function(){return[Ba,Aa,Ea,Da,Ma,Fa]},za=function(){return[Aa,Ba,Da,Ea,Ma,Fa]},Na=function(){return[Ea,Da,Ba,Aa,Fa,Ma]},La=function(){return[Da,Ea,Aa,Ba,Fa,Ma]},ja=Object.freeze({__proto__:null,events:function(u){return qo([$o(xo(),function(o,t){var n,r=u.channels,e=xt(r),i=t,e=(e=e,(n=i).universal?e:R(e,function(t){return D(n.channels,t)}));nt(e,function(t){var n=r[t],e=n.schema,e=Cn("channel["+t+"] data\nReceiver: "+qr(o.element),e,i.data);n.onReceive(o,e)})})])}}),Ua=[Hn("channels",wn(it.value,un([sa("onReceive"),$n("schema",En())])))],Wa=function(e,o,r){return ur(function(t,n){r(t,e,o)})},Ga=function(t,n,e,o,r,i){var u=un(t),t=Jn(n,[Xn("config",un(t))]);return qa(u,t,n,e,o,r,i)},Xa=function(r,i,u){var t,n,e,o,a,c;return t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[e].concat(t);return e.config({name:W(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(t){var n=Array.prototype.slice.call(o,1);return i.apply(undefined,[e,t.config,t.state].concat(n))})},n=u,o=(e=i).toString(),a=o.indexOf(")")+1,e=o.indexOf("("),c=o.substring(e+1,a-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:n,parameters:si(c.slice(0,1).concat(c.slice(3)))}},t},Ya=function(t){return{key:t,value:undefined}},qa=function(e,t,o,r,n,i,u){var a=function(t){return At(t,o)?t[o]():tt.none()},n=kt(n,function(t,n){return Xa(o,t,n)}),i=kt(i,li),c=Z(Z(Z({},i),n),{revoke:m(Ya,o),config:function(t){var n=Cn(o+"-config",e,t);return{key:o,value:{config:n,me:c,configAsRaw:Pt(function(){return Cn(o+"-config",e,t)}),initialConfig:t,state:u}}},schema:W(t),exhibit:function(t,e){return a(t).bind(function(n){return Dt(r,"exhibit").map(function(t){return t(e,n.config,n.state)})}).getOr(vi({}))},name:W(o),handlers:function(t){return a(t).map(function(t){return Dt(r,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return c},Ka=Yt,Ja=un([Pn("fields"),Pn("name"),$n("active",{}),$n("apis",{}),$n("state",gi),$n("extra",{})]),$a=function(t){t=Cn("Creating behaviour: "+t.name,Ja,t);return Ga(t.fields,t.name,t.active,t.apis,t.extra,t.state)},Qa=un([Pn("branchKey"),Pn("branches"),Pn("name"),$n("active",{}),$n("apis",{}),$n("state",gi),$n("extra",{})]),h=function(t){var n,e,o,r,i,u=Cn("Creating behaviour: "+t.name,Qa,t);return n=Tn(u.branchKey,u.branches),e=u.name,o=u.active,r=u.apis,i=u.extra,t=u.state,n=Jn(e,[Xn("config",u=n)]),qa(u,n,e,o,r,i,t)},Za=W(undefined),tc=$a({fields:Ua,name:"receiving",active:ja}),nc=Object.freeze({__proto__:null,exhibit:function(t,n){return vi({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),ec=function(t){return t.dom.focus()},oc=function(t){return void 0===t&&(t=se.fromDom(document)),tt.from(t.dom.activeElement).map(se.fromDom)},rc=function(n){return oc(_r(n)).filter(function(t){return n.dom.contains(t.dom)})},ic=function(t,e){var o=_r(e),n=oc(o).bind(function(n){var o,r,t=function(t){return Ne(n,t)};return t(e)?tt.some(e):(o=t,(r=function(t){for(var n=0;n<t.childNodes.length;n++){var e=se.fromDom(t.childNodes[n]);if(o(e))return tt.some(e);e=r(t.childNodes[n]);if(e.isSome())return e}return tt.none()})(e.dom))}),t=t(e);return n.each(function(n){oc(o).filter(function(t){return Ne(t,n)}).fold(function(){ec(n)},Q)}),t},uc=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},ac=function(t,n){var e=function(t){return t+"px"};Gi(t,{position:tt.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},It=Mt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),cc=function(t,n,e,o,r,i){var u=n.x-e,a=n.y-o,c=r-(u+n.width),s=i-(a+n.height),l=tt.some(u),f=tt.some(a),d=tt.some(c),m=tt.some(s),g=tt.none();return e=n.direction,o=function(){return uc(t,l,f,g,g)},r=function(){return uc(t,g,f,d,g)},i=function(){return uc(t,l,g,g,m)},u=function(){return uc(t,g,g,d,m)},a=function(){return uc(t,l,f,g,g)},c=function(){return uc(t,l,g,g,m)},s=function(){return uc(t,l,f,g,g)},n=function(){return uc(t,g,f,d,g)},e.fold(o,r,i,u,a,c,s,n)},sc=function(t,n){var e=m(Mu,n),o=t.fold(e,e,function(){var t=_u();return Mu(n).translate(-t.left,-t.top)}),t=Su(n),e=gu(n);return Fu(o.left,o.top,t,e)},lc=function(t,n,e){var o=hu(n,e);return t.fold(W(o),W(o),function(){var t=_u();return o.translate(-t.left,-t.top)})},fc=(It.none,It.relative),dc=It.fixed,mc=function(t,n,e,o){n=t+n;return o<n?e:n<e?o:n},gc=function(t,n,e){return Math.min(Math.max(t,n),e)},pc=Mt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),hc=function(t,n,e,o){var r,i,u,a,c,s,l,f=t.x,d=t.y,m=t.bubble.offset,g=m.left,p=m.top,h=(s=o,r=t.boundsRestriction,i=m,c=(u=function(n,e){var o="top"===n||"bottom"===n?i.top:i.left;return Dt(r,n).bind(w).bind(function(t){return"left"===n||"top"===n?e<=t?tt.some(t):tt.none():t<=e?tt.some(t):tt.none()}).map(function(t){return t+o}).getOr(e)})("left",s.x),l=u("top",s.y),a=u("right",s.right),s=u("bottom",s.bottom),Fu(c,l,a-c,s-l)),v=h.y,b=h.bottom,y=h.x,x=h.right,o=d+p,a=(m=f+g,u=o,a=n,c=e,l=(s=h).x,d=s.y,p=s.width,f=s.height,g=d<=u,e=(n=l<=m)&&g,h=m+a<=l+p&&u+c<=d+f,l=Math.abs(Math.min(a,n?l+p-m:l-(m+a))),d=Math.abs(Math.min(c,g?d+f-u:d-(u+c))),a=Math.max(s.x,s.right-a),c=Math.max(s.y,s.bottom-c),{originInBounds:e,sizeInBounds:h,limitX:gc(m,s.x,a),limitY:gc(u,s.y,c),deltaW:l,deltaH:d}),u=a.originInBounds,s=a.sizeInBounds,c=a.limitX,l=a.limitY,d=a.deltaW,a=a.deltaH,v=W(l+a-v),b=W(b-l),b=t.direction.fold(b,b,v,v,b,v,b,b),y=W(c+d-y),x=W(x-c),o={x:c,y:l,width:d,height:a,maxHeight:b,maxWidth:t.direction.fold(x,y,x,y,x,x,x,y),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:o};return u&&s?pc.fit(o):pc.nofit(o,d,a)},vc=function(t,n,e,o){Ji(n,"max-height"),Ji(n,"max-width");var r,u,a,c,s,l,f,i,n={width:Su(r=n),height:gu(r)};return r=o.preference,u=t,a=n,c=e,s=o.bounds,l=a.width,f=a.height,i=function(t,o,r,i){t=t(u,a,c);return hc(t,l,f,s).fold(pc.fit,function(t,n,e){return i<e||r<n?pc.nofit(t,n,e):pc.nofit(o,r,i)})},P(r,function(t,n){n=m(i,n);return t.fold(pc.fit,n)},pc.nofit({x:u.x,y:u.y,width:a.width,height:a.height,maxHeight:a.height,maxWidth:a.width,direction:ga(),classes:{on:[],off:[]},label:"none",candidateYforTest:u.y},-1,-1)).fold(w,w)},bc=function(t,n,e){var r;ac(t,(e=e.origin,r=n,e.fold(function(){return uc("absolute",tt.some(r.x),tt.some(r.y),tt.none(),tt.none())},function(t,n,e,o){return cc("absolute",r,t,n,e,o)},function(t,n,e,o){return cc("fixed",r,t,n,e,o)})))},yc=function(t,n){!function(t,n){n=du.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Ui(t,"max-height",n+"px")}(t,Math.floor(n))},xc=W(function(t,n){yc(t,n),Wi(t,{"overflow-x":"hidden","overflow-y":"auto"})}),wc=W(function(t,n){yc(t,n)}),Sc=function(t,n,e){return t[n]===undefined?e:t[n]},kc=function(t,n,e,o,r,i){var u,a=Sc(i,"maxHeightFunction",xc()),c=Sc(i,"maxWidthFunction",Q),i=t.anchorBox,t=t.origin,c={bounds:(u=t,r.fold(function(){return u.fold(Vu,Vu,Fu)},function(e){return u.fold(e,e,function(){var t=e(),n=lc(u,t.x,t.y);return Fu(n.left,n.top,t.width,t.height)})})),origin:t,preference:o,maxHeightFunction:a,maxWidthFunction:c};Cc(i,n,e,c)},Cc=function(t,n,e,o){e=vc(t,n,e,o);bc(n,e,o),function(t,n){n=n.classes;Vi(t,n.off),Ri(t,n.on)}(n,e),(0,o.maxHeightFunction)(n,e.maxHeight),(0,o.maxWidthFunction)(n,e.maxWidth)},Oc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],_c=function(t,n,e){var r=function(t){return Dt(e,t).getOr([])},o=function(t,n,e){var o=U(Oc,e);return{offset:hu(t,n),classesOn:N(e,r),classesOff:N(o,r)}};return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return o(-t,n,["top","alignRight"])},innerNortheast:function(){return o(t,n,["top","alignLeft"])},innerNorth:function(){return o(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return o(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return o(t,-n,["bottom","alignLeft"])},innerSouth:function(){return o(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return o(t,-n/2,["valignCentre","right"])},innerEast:function(){return o(-t,-n/2,["valignCentre","left"])}}},Tc=function(){return _c(0,0,{})},Ec=function(n,e){return function(t){return"rtl"===Dc(t)?e:n}},Dc=function(t){return"rtl"===Xi(t,"direction")?"rtl":"ltr"};(Dn=Ku=Ku||{}).TopToBottom="toptobottom",Dn.BottomToTop="bottomtotop";var Bc,Ac,Mc,Fc,Ic="data-alloy-vertical-dir",Rc=function(t){return Lu(t,function(t){return lr(t)&&Ur(t,"data-alloy-vertical-dir")===Ku.BottomToTop})},xe=function(){return Jn("layouts",[Pn("onLtr"),Pn("onRtl"),Gn("onBottomLtr"),Gn("onBottomRtl")])},Vc=function(n,t,e,o,r,i,u){var a=u.map(Rc).getOr(!1),c=t.layouts.map(function(t){return t.onLtr(n)}),u=t.layouts.map(function(t){return t.onRtl(n)}),e=a?t.layouts.bind(function(t){return t.onBottomLtr.map(function(t){return t(n)})}).or(c).getOr(r):c.getOr(e),o=a?t.layouts.bind(function(t){return t.onBottomRtl.map(function(t){return t(n)})}).or(u).getOr(i):u.getOr(o);return Ec(e,o)(n)},we=[Pn("hotspot"),Gn("bubble"),$n("overrides",{}),xe(),la("placement",function(t,n,e){var o=n.hotspot,o=sc(e,o.element),t=Vc(t.element,n,Na(),La(),Ha(),za(),tt.some(n.hotspot.element));return tt.some({anchorBox:o,bubble:n.bubble.getOr(Tc()),overrides:n.overrides,layouts:t,placer:tt.none()})})],Se=[Pn("x"),Pn("y"),$n("height",0),$n("width",0),$n("bubble",Tc()),$n("overrides",{}),xe(),la("placement",function(t,n,e){e=lc(e,n.x,n.y),e=Fu(e.left,e.top,n.width,n.height),t=Vc(t.element,n,Va(),Pa(),Va(),Pa(),tt.none());return tt.some({anchorBox:e,bubble:n.bubble,overrides:n.overrides,layouts:t,placer:tt.none()})})],ke=Mt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Pc=function(t){return t.fold(w,function(t,n,e){return t.translate(-n,-e)})},Hc=function(t){return t.fold(w,w)},zc=function(t){return P(t,function(t,n){return t.translate(n.left,n.top)},hu(0,0))},Nc=function(t){t=F(t,Hc);return zc(t)},Lc=ke.screen,jc=ke.absolute,Uc=function(t,n,e){var o=gr(t.element),o=_u(o),e=function(e,t){t=vr(t.root).dom;return tt.from(t.frameElement).map(se.fromDom).filter(function(t){var n=gr(t),t=gr(e.element);return Ne(n,t)}).map(bu)}(t,e).getOr(o);return jc(e,o.left,o.top)},Wc=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);i=Lc(hu(r,i));return tt.some({point:i,width:u,height:a})},Gc=function(t,i,u,a,c){return t.map(function(t){var n,e=[i,t.point],o=(n=function(){return Nc(e)},o=function(){return Nc(e)},r=function(){return function(t){t=F(t,Pc);return zc(t)}(e)},a.fold(n,o,r)),r={x:o.left,y:o.top,width:t.width,height:t.height},o=(u.showAbove?Ha:Na)(),t=(u.showAbove?za:La)(),t=Vc(c,u,o,t,o,t,tt.none());return{anchorBox:r,bubble:u.bubble.getOr(Tc()),overrides:u.overrides,layouts:t,placer:tt.none()}})},Ke=[Pn("node"),Pn("root"),Gn("bubble"),xe(),$n("overrides",{}),$n("showAbove",!1),la("placement",function(e,o,r){var i=Uc(e,0,o);return o.node.filter(Hi).bind(function(t){var n=t.dom.getBoundingClientRect(),t=Wc(n.left,n.top,n.width,n.height),n=o.node.getOr(e.element);return Gc(t,i,o,r,n)})})],Xc=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},ho=Mt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Yc=(ho.before,ho.on,ho.after,function(t){return t.fold(w,w,w)}),qc=Mt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Kc={domRange:qc.domRange,relative:qc.relative,exact:qc.exact,exactFromRange:function(t){return qc.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){t=t.match({domRange:function(t){return se.fromDom(t.startContainer)},relative:function(t,n){return Yc(t)},exact:function(t,n,e,o){return t}});return vr(t)},range:Xc},Jc=function(t,n,e){var o,r,t=t.document.createRange();return o=t,n.fold(function(t){o.setStartBefore(t.dom)},function(t,n){o.setStart(t.dom,n)},function(t){o.setStartAfter(t.dom)}),r=t,e.fold(function(t){r.setEndBefore(t.dom)},function(t,n){r.setEnd(t.dom,n)},function(t){r.setEndAfter(t.dom)}),t},$c=function(t,n,e,o,r){t=t.document.createRange();return t.setStart(n.dom,e),t.setEnd(o.dom,r),t},Qc=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Zc=Mt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ts=function(t,n,e){return n(se.fromDom(e.startContainer),e.startOffset,se.fromDom(e.endContainer),e.endOffset)},ns=function(t,n){var r,e,n=(r=t,n.match({domRange:function(t){return{ltr:W(t),rtl:tt.none}},relative:function(t,n){return{ltr:Pt(function(){return Jc(r,t,n)}),rtl:Pt(function(){return tt.some(Jc(r,n,t))})}},exact:function(t,n,e,o){return{ltr:Pt(function(){return $c(r,t,n,e,o)}),rtl:Pt(function(){return tt.some($c(r,e,o,t,n))})}}}));return(e=(n=n).ltr()).collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Zc.rtl(se.fromDom(t.endContainer),t.endOffset,se.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return ts(0,Zc.ltr,e)}):ts(0,Zc.ltr,e)},es=(Zc.ltr,Zc.rtl,Bc=fr,Ac="text",{get:function(t){if(!Bc(t))throw new Error("Can only get "+Ac+" value of a "+Ac+" node");return Mc(t).getOr("")},getOption:Mc=function(t){return Bc(t)?tt.from(t.dom.nodeValue):tt.none()},set:function(t,n){if(!Bc(t))throw new Error("Can only set raw "+Ac+" value of a "+Ac+" node");t.dom.nodeValue=n}}),os=function(t){return es.getOption(t)},rs=["img","br"],is=function(t){return os(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf("\xa0")}).isSome()||D(rs,cr(t))},us=function(t,r){var i=function(t){for(var n=wr(t),e=n.length-1;0<=e;e--){var o=n[e];if(r(o))return tt.some(o);o=i(o);if(o.isSome())return o}return tt.none()};return i(t)},as=function(t,n){return function(t,n){n=n===undefined?document:n.dom;return ze(n)?[]:F(n.querySelectorAll(t),se.fromDom)}(n,t)},cs=function(t,n,e,o){var r,i,u,a,c,c=(i=n,u=e,a=o,(c=gr(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),o=Ne(t,e)&&n===o;return c.collapsed&&!o},ss=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),t=t.getRangeAt(t.rangeCount-1);return tt.some(Xc(se.fromDom(n.startContainer),n.startOffset,se.fromDom(t.endContainer),t.endOffset))}return tt.none()},ls=function(t){if(null===t.anchorNode||null===t.focusNode)return ss(t);var n=se.fromDom(t.anchorNode),e=se.fromDom(t.focusNode);return cs(n,t.anchorOffset,e,t.focusOffset)?tt.some(Xc(n,t.anchorOffset,e,t.focusOffset)):ss(t)},fs=function(t){return tt.from(t.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(ls)},ds=function(t,n){var i,t=ns(i=t,n).match({ltr:function(t,n,e,o){var r=i.document.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r},rtl:function(t,n,e,o){var r=i.document.createRange();return r.setStart(e.dom,o),r.setEnd(t.dom,n),r}});return 0<(n=0<(t=(n=t).getClientRects()).length?t[0]:n.getBoundingClientRect()).width||0<n.height?tt.some(n).map(Qc):tt.none()},ms=function(t,n){return{element:t,offset:n}},gs=function(t,n){var e=wr(t);if(0===e.length)return ms(t,n);if(n<e.length)return ms(e[n],0);n=e[e.length-1],e=fr(n)?es.get(n).length:wr(n).length;return ms(n,e)},ps=function(t,n){return(fr(t)?ms:gs)(t,n)},hs=function(t,n){return n.getSelection.getOrThunk(function(){return function(){return fs(t)}})().map(function(t){var n=ps(t.start,t.soffset),t=ps(t.finish,t.foffset);return Kc.range(n.element,n.offset,t.element,t.offset)})},po=[Gn("getSelection"),Pn("root"),Gn("bubble"),xe(),$n("overrides",{}),$n("showAbove",!1),la("placement",function(t,n,e){var o=vr(n.root).dom,r=Uc(t,0,n),i=hs(o,n).bind(function(t){return ds(o,Kc.exactFromRange(t)).orThunk(function(){var n=se.fromText("\ufeff");return Ar(t.start,n),ds(o,Kc.exact(n,0,n,1)).map(function(t){return Pr(n),t})}).bind(function(t){return Wc(t.left,t.top,t.width,t.height)})}),t=hs(o,n).bind(function(t){return lr(t.start)?tt.some(t.start):yr(t.start)}).getOr(t.element);return Gc(i,r,n,e,t)})],vs=function(t){return t.x+t.width},bs=function(t,n){return t.x-n.width},ys=function(t,n){return t.y-n.height+t.height},xs=function(t,n,e){return da(vs(t),t.y,e.southeast(),ga(),Sa(t,{left:0,top:2}),"link-layout-se")},ws=function(t,n,e){return da(bs(t,n),t.y,e.southwest(),pa(),Sa(t,{right:1,top:2}),"link-layout-sw")},Ss=function(t,n,e){return da(vs(t),ys(t,n),e.northeast(),ha(),Sa(t,{left:0,bottom:3}),"link-layout-ne")},ks=function(t,n,e){return da(bs(t,n),ys(t,n),e.northwest(),va(),Sa(t,{right:1,bottom:3}),"link-layout-nw")},Cs=function(){return[xs,ws,Ss,ks]},Os=function(){return[ws,xs,ks,Ss]},sr=[Pn("item"),xe(),$n("overrides",{}),la("placement",function(t,n,e){e=sc(e,n.item.element),t=Vc(t.element,n,Cs(),Os(),Cs(),Os(),tt.none());return tt.some({anchorBox:e,bubble:Tc(),overrides:n.overrides,layouts:t,placer:tt.none()})})],_s=Tn("anchor",{selection:po,node:Ke,hotspot:we,submenu:sr,makeshift:Se}),Ts=function(t,n,e,o,r){n={anchorBox:e.anchorBox,origin:n};kc(n,r.element,e.bubble,e.layouts,o,e.overrides)},Es=function(t,n,e,o,r,i){i=i.map(Iu);return Ds(t,n,e,o,r,i)},Ds=function(i,u,t,n,a,c){var s=Cn("positioning anchor.info",_s,n);ic(function(){Ui(a.element,"position","fixed");var t=qi(a.element,"visibility");Ui(a.element,"visibility","hidden");var n,e=u.useFixed()?(n=document.documentElement,dc(0,0,n.clientWidth,n.clientHeight)):(n=bu((o=i).element),o=o.element.dom.getBoundingClientRect(),fc(n.left,n.top,o.width,o.height)),o=s.placement,r=c.map(W).or(u.getBounds);o(i,s,e).each(function(t){t.placer.getOr(Ts)(i,e,t,r,a)}),t.fold(function(){Ji(a.element,"visibility")},function(t){Ui(a.element,"visibility",t)}),qi(a.element,"left").isNone()&&qi(a.element,"top").isNone()&&qi(a.element,"right").isNone()&&qi(a.element,"bottom").isNone()&&qi(a.element,"position").is("fixed")&&Ji(a.element,"position")},a.element)},Cr=Object.freeze({__proto__:null,position:function(t,n,e,o,r){Es(t,n,e,o,r,tt.none())},positionWithin:Es,positionWithinBounds:Ds,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),Kr=[$n("useFixed",l),Gn("getBounds")],Bs=$a({fields:Kr,name:"positioning",active:nc,apis:Cr}),As=function(t){jo(t,Fo());t=t.components();nt(t,As)},Ms=function(t){var n=t.components();nt(n,Ms),jo(t,Mo())},Fs=function(t,n){Ir(t.element,n.element)},Is=function(n,t){var e,o=n.components();nt((e=n).components(),function(t){return Pr(t.element)}),Vr(e.element),e.syncComponents();o=U(o,t);nt(o,function(t){As(t),n.getSystem().removeFromWorld(t)}),nt(t,function(t){t.getSystem().isConnected()?Fs(n,t):(n.getSystem().addToWorld(t),Fs(n,t),Hi(n.element)&&Ms(t)),n.syncComponents()})},Rs=function(t,n){Vs(t,n,Ir)},Vs=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Hi(t.element)&&Ms(n),t.syncComponents()},Ps=function(t){As(t),Pr(t.element),t.getSystem().removeFromWorld(t)},Hs=function(n){var t=br(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()});Ps(n),t.each(function(t){t.syncComponents()})},zs=function(t){var n=t.components();nt(n,Ps),Vr(t.element),t.syncComponents()},Ns=function(t,n){Ls(t,n,Ir)},Ls=function(t,n,e){e(t,n.element);t=wr(n.element);nt(t,function(t){n.getByDom(t).each(Ms)})},js=function(n){var t=wr(n.element);nt(t,function(t){n.getByDom(t).each(As)}),Pr(n.element)},Us=function(n,t,e,o){e.get().each(function(t){zs(n)});t=t.getAttachPoint(n);Rs(t,n);o=n.getSystem().build(o);return Rs(n,o),e.set(o),o},Ws=function(t,n,e,o){o=Us(t,n,e,o);return n.onOpen(t,o),o},Gs=function(n,e,o){o.get().each(function(t){zs(n),Hs(n),e.onClose(n,t),o.clear()})},Xs=function(t,n,e){return e.isOpen()},Ys=function(t,n,e){var o,r,i=n.getAttachPoint(t);Ui(t.element,"position",Bs.getMode(i)),o=t,t="visibility",r=n.cloakVisibilityAttr,n="hidden",qi(o.element,t).fold(function(){Xr(o.element,r)},function(t){jr(o.element,r,t)}),Ui(o.element,t,n)},qs=function(t,n,e){var o,r,i;o=t.element,B(["top","left","right","bottom"],function(t){return qi(o,t).isSome()})||Ji(t.element,"position"),r=t,i="visibility",n=n.cloakVisibilityAttr,Wr(r.element,n).fold(function(){return Ji(r.element,i)},function(t){return Ui(r.element,i,t)})},Zr=Object.freeze({__proto__:null,cloak:Ys,decloak:qs,open:Ws,openWhileCloaked:function(t,n,e,o,r){Ys(t,n),Ws(t,n,e,o),r(),qs(t,n)},close:Gs,isOpen:Xs,isPartOf:function(n,e,t,o){return Xs(0,0,t)&&t.get().exists(function(t){return e.isPartOf(n,t,o)})},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map(function(){return Us(t,n,e,o)})}}),ti=Object.freeze({__proto__:null,events:function(e,o){return qo([$o(Oo(),function(t,n){Gs(t,e,o)})])}}),fu=[aa("onOpen"),aa("onClose"),Pn("isPartOf"),Pn("getAttachPoint"),$n("cloakVisibilityAttr","data-precloak-visibility")],Ks=$a({fields:fu,name:"sandboxing",active:ti,apis:Zr,state:Object.freeze({__proto__:null,init:function(){var n=ae(tt.none()),t=W("not-implemented");return pi({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set(tt.none())},set:function(t){n.set(tt.some(t))},get:function(){return n.get()}})}})}),Js=W("dismiss.popups"),$s=W("reposition.popups"),Qs=W("mouse.released"),Zs=un([$n("isExtraPart",l),Jn("fireEventInstead",[$n("event",Io())])]),tl=function(t){var e=Cn("Dismissal",Zs,t),t={};return t[Js()]={schema:un([Pn("target")]),onReceive:function(n,t){Ks.isOpen(n)&&(Ks.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold(function(){return Ks.close(n)},function(t){return jo(n,t.event)}))}},t},nl=un([Jn("fireEventInstead",[$n("event",Ro())]),Ln("doReposition")]),el=function(t){var e=Cn("Reposition",nl,t),t={};return t[$s()]={onReceive:function(n){Ks.isOpen(n)&&e.fireEventInstead.fold(function(){return e.doReposition(n)},function(t){return jo(n,t.event)})}},t},ol=function(t,n,e){n.store.manager.onLoad(t,n,e)},rl=function(t,n,e){n.store.manager.onUnload(t,n,e)},il=Object.freeze({__proto__:null,onLoad:ol,onUnload:rl,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),oa=Object.freeze({__proto__:null,events:function(e,o){var t=e.resetOnDom?[rr(function(t,n){ol(t,e,o)}),ir(function(t,n){rl(t,e,o)})]:[Wa(e,o,ol)];return qo(t)}}),ma=function(){var t=ae(null);return pi({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},Ua=function(){var i=ae({}),u=ae({});return pi({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(t){return Dt(i.get(),t).orThunk(function(){return Dt(u.get(),t)})},update:function(t){var n=i.get(),e=u.get(),o={},r={};nt(t,function(n){o[n.value]=n,Dt(n,"meta").each(function(t){Dt(t,"text").each(function(t){r[t]=n})})}),i.set(Z(Z({},n),o)),u.set(Z(Z({},e),r))},clear:function(){i.set({}),u.set({})}})},ja=Object.freeze({__proto__:null,memory:ma,dataset:Ua,manual:function(){return pi({readState:Q})},init:function(t){return t.store.manager.state(t)}}),ul=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},It=[Gn("initialValue"),Pn("getFallbackEntry"),Pn("getDataKey"),Pn("setValue"),la("manager",{setValue:ul,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(t){return t})},onLoad:function(n,e,o){e.store.initialValue.each(function(t){ul(n,e,o,t)})},onUnload:function(t,n,e){e.clear()},state:Ua})],Dn=[Pn("getValue"),$n("setValue",Q),Gn("initialValue"),la("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(n,e,t){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:Q,state:gi.init})],ke=[Gn("initialValue"),la("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:ma})],ho=[Qn("store",{mode:"memory"},Tn("mode",{memory:ke,manual:Dn,dataset:It})),aa("onSetValue"),$n("resetOnDom",!1)],al=$a({fields:ho,name:"representing",active:oa,apis:il,extra:{setValueFrom:function(t,n){n=al.getValue(n);al.setValue(t,n)}},state:ja}),po=function(o,t){return ie(o,{},F(t,function(t){return n=t.name(),e="Cannot configure "+t.name()+" for "+o,gn(n,n,Lt(),rn(function(t){return pt("The field: "+n+" is forbidden. "+e)}));var n,e}).concat([ue("dump",w)]))},cl=function(t){return t.dump},sl=function(t,n){return Z(Z({},t.dump),Ka(n))},ll=po,fl=sl,dl="placeholder",ml=Mt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),gl=function(t){return Bt(t,"uiType")},pl=function(t,n,e,o){return gl(e)&&e.uiType===dl?(i=e,u=o,(r=t).exists(function(t){return t!==i.owner})?ml.single(!0,W(i)):Dt(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+xt(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(t){return t.replace()})):ml.single(!1,W(e));var r,i,u},hl=function(o,r,i,u){return pl(o,0,i,u).fold(function(t,n){var e=gl(i)?n(r,i.config,i.validated):n(r),n=Dt(e,"components").getOr([]),n=N(n,function(t){return hl(o,r,t,u)});return[Z(Z({},e),{components:n})]},function(t,n){if(gl(i)){var e=n(r,i.config,i.validated);return i.validated.preprocess.getOr(w)(e)}return n(r)})},vl=function(n,e,t,o){var r,i,u,o=kt(o,function(t,n){return o=t,r=!1,{name:W(e=n),required:function(){return o.fold(function(t,n){return t},function(t,n){return t})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r}),t=(r=n,i=e,u=o,N(t,function(t){return hl(r,i,t,u)}));return St(o,function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),t},bl=ml.single,yl=ml.multiple,xl=W(dl),Ke=Mt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),we=$n("factory",{sketch:w}),sr=$n("schema",[]),Se=Pn("name"),Kr=gn("pname","pname",jt(function(t){return"<alloy."+Qr(t.name)+">"}),En()),nc=mn("schema",function(){return[Gn("preprocess")]}),Cr=$n("defaults",W({})),fu=$n("overrides",W({})),ti=an([we,sr,Se,Kr,Cr,fu]),Zr=an([we,sr,Se,Cr,fu]),Ua=an([we,sr,Se,Kr,Cr,fu]),ma=an([we,nc,Se,Pn("unit"),Kr,Cr,fu]),wl=function(t){return t.fold(tt.some,tt.none,tt.some,tt.some)},Sl=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},ke=function(n,e){return function(t){t=Cn("Converting part type",e,t);return n(t)}},kl=ke(Ke.required,ti),Dn=ke(Ke.external,Zr),Cl=ke(Ke.optional,Ua),It=ke(Ke.group,ma),Ol=W("entirety"),ho=Object.freeze({__proto__:null,required:kl,external:Dn,optional:Cl,group:It,asNamedPart:wl,name:Sl,asCommon:function(t){return t.fold(w,w,w,w)},original:Ol}),_l=function(t,n,e,o){return Rt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Tl=function(r,t){var n={};return nt(t,function(t){wl(t).each(function(e){var o=El(r,e.pname);n[e.name]=function(t){var n=Cn("Part: "+e.name+" in "+r,an(e.schema),t);return Z(Z({},o),{config:t,validated:n})}})}),n},El=function(t,n){return{uiType:xl(),owner:t,name:n}},Dl=function(t,n,e){return{uiType:xl(),owner:t,name:n,config:e,validated:{}}},Bl=function(t){return N(t,function(t){return t.fold(tt.none,tt.some,tt.none,tt.none).map(function(t){return jn(t.name,t.schema.concat([fa(Ol())]))}).toArray()})},Al=function(t){return F(t,Sl)},Ml=function(t,n,e){return o=n,i={},r={},nt(e,function(t){t.fold(function(o){i[o.pname]=bl(!0,function(t,n,e){return o.factory.sketch(_l(t,o,n,e))})},function(t){var n=o.parts[t.name];r[t.name]=W(t.factory.sketch(_l(o,t,n[Ol()]),n))},function(o){i[o.pname]=bl(!1,function(t,n,e){return o.factory.sketch(_l(t,o,n,e))})},function(r){i[r.pname]=yl(!0,function(n,t,e){var o=n[r.name];return F(o,function(t){return r.factory.sketch(Rt(r.defaults(n,t,e),t,r.overrides(n,t)))})})})}),{internals:W(i),externals:W(r)};var o,i,r},Fl=function(t,n,e){return vl(tt.some(t),n,n.components,e)},Il=function(t,n,e){e=n.partUids[e];return t.getSystem().getByUid(e).toOptional()},Rl=function(t,n,e){return Il(t,n,e).getOrDie("Could not find part: "+e)},Vl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return nt(e,function(t){o[t]=W(i.getByUid(r[t]))}),o},Pl=function(t,n){var e=t.getSystem();return kt(n.partUids,function(t,n){return W(e.getByUid(t))})},Hl=function(t){return xt(t.partUids)},zl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return nt(e,function(t){o[t]=W(i.getByUid(r[t]).getOrDie())}),o},Nl=function(n,t){t=Al(t);return Yt(F(t,function(t){return{key:t,value:n+"-"+t}}))},Ll=function(n){return gn("partUids","partUids",Ut(function(t){return Nl(t.uid,n)}),En())},oa=Object.freeze({__proto__:null,generate:Tl,generateOne:Dl,schemas:Bl,names:Al,substitutes:Ml,components:Fl,defaultUids:Nl,defaultUidsSchema:Ll,getAllParts:Pl,getAllPartNames:Hl,getPart:Il,getPartOrDie:Rl,getParts:Vl,getPartsOrDie:zl}),jl=function(t,n,e,o,r){r=r,r=(0<(o=o).length?[jn("parts",o)]:[]).concat([Pn("uid"),$n("dom",{}),$n("components",[]),fa("originalSpec"),$n("debug.sketcher",{})]).concat(r);return Cn(t+" [SpecSchema]",un(r.concat(n)),e)},Ul=function(t,n,e,o,r){var i=Wl(r),u=Bl(e),r=Ll(e),r=jl(t,n,i,u,[r]),e=Ml(0,r,e);return o(r,Fl(t,r,e.internals()),i,e.externals())},Wl=function(t){return Bt(t,"uid")?t:Z(Z({},t),{uid:ii("uid")})},Gl=un([Pn("name"),Pn("factory"),Pn("configFields"),$n("apis",{}),$n("extraApis",{})]),Xl=un([Pn("name"),Pn("factory"),Pn("configFields"),Pn("partFields"),$n("apis",{}),$n("extraApis",{})]),Yl=function(t){var n=Cn("Sketcher for "+t.name,Gl,t),e=kt(n.apis,mi),t=kt(n.extraApis,li);return Z(Z({name:n.name,configFields:n.configFields,sketch:function(t){return function(t,n,e,o){o=Wl(o);return e(jl(t,n,o,[],[]),o)}(n.name,n.configFields,n.factory,t)}},e),t)},il=function(t){var n=Cn("Sketcher for "+t.name,Xl,t),e=Tl(n.name,n.partFields),o=kt(n.apis,mi),t=kt(n.extraApis,li);return Z(Z({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Ul(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),t)},ql=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},Kl=function(t,n){return t?tt.some(n):tt.none()},Jl=function(t){return"input"===cr(t)&&"radio"!==Ur(t,"type")||"textarea"===cr(t)},ja=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),sr=[Pn("find")],$l=$a({fields:sr,name:"composing",apis:ja}),Ql=function(e,o,t,r){var n=as(e.element,"."+o.highlightClass);nt(n,function(n){B(r,function(t){return t.element===n})||(Fi(n,o.highlightClass),e.getSystem().getByDom(n).each(function(t){o.onDehighlight(e,t),jo(t,Lo())}))})},Zl=function(t,n,e,o){Ql(t,n,0,[o]),tf(t,n,e,o)||(Ai(o.element,n.highlightClass),n.onHighlight(t,o),jo(o,No()))},tf=function(t,n,e,o){return Ii(o.element,n.highlightClass)},nf=function(t,n,e,o){n=as(t.element,"."+n.itemClass);return tt.from(n[o]).fold(function(){return it.error(new Error("No element found with index "+o))},t.getSystem().getByDom)},ef=function(n,t,e){return Uu(n.element,"."+t.itemClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},of=function(n,t,e){t=as(n.element,"."+t.itemClass);return(0<t.length?tt.some(t[t.length-1]):tt.none()).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},rf=function(n,e,t,o){var r=as(n.element,"."+e.itemClass);return z(r,function(t){return Ii(t,e.highlightClass)}).bind(function(t){t=mc(t,o,0,r.length-1);return n.getSystem().getByDom(r[t]).toOptional()})},uf=function(n,t,e){t=as(n.element,"."+t.itemClass);return ql(F(t,function(t){return n.getSystem().getByDom(t).toOptional()}))},we=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return Ql(t,n,0,[])},dehighlight:function(t,n,e,o){tf(t,n,e,o)&&(Fi(o.element,n.highlightClass),n.onDehighlight(t,o),jo(o,Lo()))},highlight:Zl,highlightFirst:function(n,e,o){ef(n,e).each(function(t){Zl(n,e,o,t)})},highlightLast:function(n,e,o){of(n,e).each(function(t){Zl(n,e,o,t)})},highlightAt:function(n,e,o,t){nf(n,e,o,t).fold(function(t){throw t},function(t){Zl(n,e,o,t)})},highlightBy:function(n,e,o,t){var r=uf(n,e);H(r,t).each(function(t){Zl(n,e,o,t)})},isHighlighted:tf,getHighlighted:function(n,t,e){return Uu(n.element,"."+t.highlightClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},getFirst:ef,getLast:of,getPrevious:function(t,n,e){return rf(t,n,0,-1)},getNext:function(t,n,e){return rf(t,n,0,1)},getCandidates:uf}),nc=[Pn("highlightClass"),Pn("itemClass"),aa("onHighlight"),aa("onDehighlight")],af=$a({fields:nc,name:"highlighting",apis:we}),cf=[8],sf=[9],lf=[13],ff=[27],df=[32],mf=[37],gf=[38],pf=[39],hf=[40],vf=function(t,n,e){var o=j(t.slice(0,n)),n=j(t.slice(n+1));return H(o.concat(n),e)},bf=function(t,n,e){n=j(t.slice(0,n));return H(n,e)},yf=function(t,n,e){var o=t.slice(0,n),n=t.slice(n+1);return H(n.concat(o),e)},xf=function(t,n,e){n=t.slice(n+1);return H(n,e)},wf=function(n){return function(t){t=t.raw;return D(n,t.which)}},Sf=function(t){return function(n){return L(t,function(t){return t(n)})}},kf=function(t){return!0===t.raw.shiftKey},Cf=function(t){return!0===t.raw.ctrlKey},Of=x(kf),_f=function(t,n){return{matches:t,classification:n}},Tf=function(t,n,e){n.exists(function(n){return e.exists(function(t){return Ne(t,n)})})||Uo(t,Vo(),{prevFocus:n,newFocus:e})},Ef=function(){var o=function(t){return rc(t.element)};return{get:o,set:function(t,n){var e=o(t);t.getSystem().triggerFocus(n,t.element);n=o(t);Tf(t,e,n)}}},Df=function(){var o=function(t){return af.getHighlighted(t).map(function(t){return t.element})};return{get:o,set:function(n,t){var e=o(n);n.getSystem().getByDom(t).fold(Q,function(t){af.highlight(n,t)});t=o(n);Tf(n,e,t)}}};(Se=Fc=Fc||{}).OnFocusMode="onFocus",Se.OnEnterOrSpaceMode="onEnterOrSpace",Se.OnApiMode="onApi";var Bf,Af=function(t,n,e,o,a){var c=function(n,e,t,o,r){var i,t=t(n,e,o,r);return i=e.event,H(t,function(t){return t.matches(i)}).map(function(t){return t.classification}).bind(function(t){return t(n,e,o,r)})},r={schema:function(){return t.concat([$n("focusManager",Ef()),Qn("focusInside","onFocus",xn(function(t){return D(["onFocus","onEnterOrSpace","onApi"],t)?it.value(t):it.error("Invalid value for focusInside")})),la("handler",r),la("state",n),la("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var t=i.focusInside!==Fc.OnFocusMode?tt.none():a(i).map(function(e){return $o(vo(),function(t,n){e(t,i,u),n.stop()})}),n=[$o(ao(),function(o,r){c(o,r,e,i,u).fold(function(){var n,e,t;n=o,e=r,t=wf(df.concat(lf))(e.event),i.focusInside===Fc.OnEnterOrSpaceMode&&t&&Xe(n,e)&&a(i).each(function(t){t(n,i,u),e.stop()})},function(t){r.stop()})}),$o(co(),function(t,n){c(t,n,o,i,u).each(function(t){n.stop()})})];return qo(t.toArray().concat(n))}};return r},Kr=function(t){var n=[Gn("onEscape"),Gn("onEnter"),$n("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),$n("firstTabstop",0),$n("useTabstopAt",S),Gn("visibilitySelector")].concat([t]),i=function(t,n){t=t.visibilitySelector.bind(function(t){return Wu(n,t)}).getOr(n);return 0<mu(t)},e=function(n,e,t){!function(t,n){t=as(t.element,n.selector),t=R(t,function(t){return i(n,t)});return tt.from(t[n.firstTabstop])}(n,e).each(function(t){e.focusManager.set(n,t)})},u=function(n,t,e,o,r){return r(t,e,function(t){return i(n=o,t=t)&&n.useTabstopAt(t);var n}).fold(function(){return o.cyclic?tt.some(!0):tt.none()},function(t){return o.focusManager.set(n,t),tt.some(!0)})},r=function(n,t,e,o){var r,i=as(n.element,e.selector);return(r=e).focusManager.get(n).bind(function(t){return Wu(t,r.selector)}).bind(function(t){return z(i,m(Ne,t)).bind(function(t){return u(n,i,t,e,o)})})},o=W([_f(Sf([kf,wf(sf)]),function(t,n,e){var o=e.cyclic?vf:bf;return r(t,0,e,o)}),_f(wf(sf),function(t,n,e){var o=e.cyclic?yf:xf;return r(t,0,e,o)}),_f(wf(ff),function(n,e,t){return t.onEscape.bind(function(t){return t(n,e)})}),_f(Sf([Of,wf(lf)]),function(n,e,t){return t.onEnter.bind(function(t){return t(n,e)})})]),t=W([]);return Af(n,gi.init,o,t,function(){return tt.some(e)})},Cr=Kr(ue("cyclic",l)),fu=Kr(ue("cyclic",S)),ti=function(t,n,e){return Jl(e)&&wf(df)(n.event)?tt.none():(Go(t,e,wo()),tt.some(!0))},Mf=function(t,n){return tt.some(!0)},Zr=[$n("execute",ti),$n("useSpace",!1),$n("useEnter",!0),$n("useControlEnter",!1),$n("useDown",!1)],Ff=function(t,n,e){return e.execute(t,n,t.element)},Ua=Af(Zr,gi.init,function(t,n,e,o){var r=e.useSpace&&!Jl(t.element)?df:[],i=e.useEnter?lf:[],t=e.useDown?hf:[],t=r.concat(i).concat(t);return[_f(wf(t),Ff)].concat(e.useControlEnter?[_f(Sf([Cf,wf(lf)]),Ff)]:[])},function(t,n,e,o){return e.useSpace&&!Jl(t.element)?[_f(wf(df),Mf)]:[]},function(){return tt.none()}),ke=function(){var e=ae(tt.none());return pi({readState:function(){return e.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(tt.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map(function(t){return t.numRows})},getNumColumns:function(){return e.get().map(function(t){return t.numColumns})}})},Ke=Object.freeze({__proto__:null,flatgrid:ke,init:function(t){return t.state(t)}}),If=function(i){return function(t,n,e,o){var r=i(t.element);return Pf(r,t,n,e,o)}},Rf=function(t,n){n=Ec(t,n);return If(n)},Vf=function(t,n){t=Ec(n,t);return If(t)},ma=function(r){return function(t,n,e,o){return Pf(r,t,n,e,o)}},Pf=function(n,e,t,o,r){return o.focusManager.get(e).bind(function(t){return n(e.element,t,o,r)}).map(function(t){return o.focusManager.set(e,t),!0})},sr=ma,ja=ma,Hf=ma,zf=function(t){return!((t=t.dom).offsetWidth<=0&&t.offsetHeight<=0)},Nf=function(t,n,e){var o,e=as(t,e),e=R(e,zf);return z(o=e,function(t){return Ne(t,n)}).map(function(t){return{index:t,candidates:o}})},Lf=function(t,n){return z(t,function(t){return Ne(n,t)})},jf=function(n,t,e,o){return o(Math.floor(t/e),t%e).bind(function(t){t=t.row*e+t.column;return 0<=t&&t<n.length?tt.some(n[t]):tt.none()})},Uf=function(o,t,r,i,u){return jf(o,t,i,function(t,n){var e=t===r-1?o.length-t*i:i,e=mc(n,u,0,e-1);return tt.some({row:t,column:e})})},Wf=function(o,t,r,i,u){return jf(o,t,i,function(t,n){var e=mc(t,u,0,r-1),t=e===r-1?o.length-e*i:i,t=gc(n,0,t-1);return tt.some({row:e,column:t})})},nc=[Pn("selector"),$n("execute",ti),ca("onEscape"),$n("captureTab",!1),e()],Gf=function(n,e,t){Uu(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},we=function(r){return function(t,n,e,o){return Nf(t,n,e.selector).bind(function(t){return r(t.candidates,t.index,o.getNumRows().getOr(e.initSize.numRows),o.getNumColumns().getOr(e.initSize.numColumns))})}},Se=function(t,n,e){return e.captureTab?tt.some(!0):tt.none()},Kr=we(function(t,n,e,o){return Uf(t,n,e,o,-1)}),Zr=we(function(t,n,e,o){return Uf(t,n,e,o,1)}),ma=we(function(t,n,e,o){return Wf(t,n,e,o,-1)}),we=we(function(t,n,e,o){return Wf(t,n,e,o,1)}),Kr=W([_f(wf(mf),Rf(Kr,Zr)),_f(wf(pf),Vf(Kr,Zr)),_f(wf(gf),sr(ma)),_f(wf(hf),ja(we)),_f(Sf([kf,wf(sf)]),Se),_f(Sf([Of,wf(sf)]),Se),_f(wf(ff),function(t,n,e){return e.onEscape(t,n)}),_f(wf(df.concat(lf)),function(n,e,o,t){return(r=o).focusManager.get(n).bind(function(t){return Wu(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var r})]),Zr=W([_f(wf(df),Mf)]),ma=Af(nc,ke,Kr,Zr,function(){return tt.some(Gf)}),Xf=function(t,n,e,r){var i=function(t,n,e){var o=mc(n,r,0,e.length-1);return o===t?tt.none():(n=e[o],"button"===cr(n)&&"disabled"===Ur(n,"disabled")?i(t,o,e):tt.from(e[o]))};return Nf(t,e,n).bind(function(t){var n=t.index,t=t.candidates;return i(n,n,t)})},we=[Pn("selector"),$n("getInitial",tt.none),$n("execute",ti),ca("onEscape"),$n("executeOnMove",!1),$n("allowVertical",!0)],Yf=function(n,e,o){return(r=o).focusManager.get(n).bind(function(t){return Wu(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var r},qf=function(n,e,t){e.getInitial(n).orThunk(function(){return Uu(n.element,e.selector)}).each(function(t){e.focusManager.set(n,t)})},Kf=function(t,n,e){return Xf(t,e.selector,n,-1)},Jf=function(t,n,e){return Xf(t,e.selector,n,1)},$f=function(r){return function(t,n,e,o){return r(t,n,e,o).bind(function(){return e.executeOnMove?Yf(t,n,e):tt.some(!0)})}},Qf=function(t,n,e){return e.onEscape(t,n)},Se=W([_f(wf(df),Mf)]),nc=Af(we,gi.init,function(t,n,e,o){var r=mf.concat(e.allowVertical?gf:[]),e=pf.concat(e.allowVertical?hf:[]);return[_f(wf(r),$f(Rf(Kf,Jf))),_f(wf(e),$f(Vf(Kf,Jf))),_f(wf(lf),Yf),_f(wf(df),Yf),_f(wf(ff),Qf)]},Se,function(){return tt.some(qf)}),Zf=function(t,n,e){return tt.from(t[n]).bind(function(t){return tt.from(t[e]).map(function(t){return{rowIndex:n,columnIndex:e,cell:t}})})},td=function(t,n,e,o){var r=t[n].length,r=mc(e,o,0,r-1);return Zf(t,n,r)},nd=function(t,n,e,o){e=mc(e,o,0,t.length-1),o=t[e].length,o=gc(n,0,o-1);return Zf(t,e,o)},ed=function(t,n,e,o){var r=t[n].length,r=gc(e+o,0,r-1);return Zf(t,n,r)},od=function(t,n,e,o){e=gc(e+o,0,t.length-1),o=t[e].length,o=gc(n,0,o-1);return Zf(t,e,o)},ke=[jn("selectors",[Pn("row"),Pn("cell")]),$n("cycles",!0),$n("previousSelector",tt.none),$n("execute",ti)],rd=function(n,e,t){e.previousSelector(n).orThunk(function(){var t=e.selectors;return Uu(n.element,t.cell)}).each(function(t){e.focusManager.set(n,t)})},Kr=function(t,n){return function(e,o,i){var u=i.cycles?t:n;return Wu(o,i.selectors.row).bind(function(t){var n=as(t,i.selectors.cell);return Lf(n,o).bind(function(o){var r=as(e,i.selectors.row);return Lf(r,t).bind(function(t){var n,e=(n=i,F(r,function(t){return as(t,n.selectors.cell)}));return u(e,t,o).map(function(t){return t.cell})})})})}},Zr=Kr(function(t,n,e){return td(t,n,e,-1)},function(t,n,e){return ed(t,n,e,-1)}),we=Kr(function(t,n,e){return td(t,n,e,1)},function(t,n,e){return ed(t,n,e,1)}),Se=Kr(function(t,n,e){return nd(t,e,n,-1)},function(t,n,e){return od(t,e,n,-1)}),Kr=Kr(function(t,n,e){return nd(t,e,n,1)},function(t,n,e){return od(t,e,n,1)}),ja=W([_f(wf(mf),Rf(Zr,we)),_f(wf(pf),Vf(Zr,we)),_f(wf(gf),sr(Se)),_f(wf(hf),ja(Kr)),_f(wf(df.concat(lf)),function(n,e,o){return rc(n.element).bind(function(t){return o.execute(n,e,t)})})]),Kr=W([_f(wf(df),Mf)]),ke=Af(ke,gi.init,ja,Kr,function(){return tt.some(rd)}),ja=[Pn("selector"),$n("execute",ti),$n("moveOnTab",!1)],Kr=function(n,e,o){return o.focusManager.get(n).bind(function(t){return o.execute(n,e,t)})},id=function(n,e,t){Uu(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},ud=function(t,n,e){return Xf(t,e.selector,n,-1)},ad=function(t,n,e){return Xf(t,e.selector,n,1)},ti=W([_f(wf(gf),Hf(ud)),_f(wf(hf),Hf(ad)),_f(Sf([kf,wf(sf)]),function(t,n,e,o){return e.moveOnTab?Hf(ud)(t,n,e,o):tt.none()}),_f(Sf([Of,wf(sf)]),function(t,n,e,o){return e.moveOnTab?Hf(ad)(t,n,e,o):tt.none()}),_f(wf(lf),Kr),_f(wf(df),Kr)]),Kr=W([_f(wf(df),Mf)]),ja=Af(ja,gi.init,ti,Kr,function(){return tt.some(id)}),ti=[ca("onSpace"),ca("onEnter"),ca("onShiftEnter"),ca("onLeft"),ca("onRight"),ca("onTab"),ca("onShiftTab"),ca("onUp"),ca("onDown"),ca("onEscape"),$n("stopSpaceKeyup",!1),Gn("focusIn")],Kr=Af(ti,gi.init,function(t,n,e){return[_f(wf(df),e.onSpace),_f(Sf([Of,wf(lf)]),e.onEnter),_f(Sf([kf,wf(lf)]),e.onShiftEnter),_f(Sf([kf,wf(sf)]),e.onShiftTab),_f(Sf([Of,wf(sf)]),e.onTab),_f(wf(gf),e.onUp),_f(wf(hf),e.onDown),_f(wf(mf),e.onLeft),_f(wf(pf),e.onRight),_f(wf(df),e.onSpace),_f(wf(ff),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[_f(wf(df),Mf)]:[]},function(t){return t.focusIn}),ti=Cr.schema(),Cr=fu.schema(),fu=nc.schema(),nc=ma.schema(),ma=ke.schema(),ke=Ua.schema(),Ua=ja.schema(),ja=Kr.schema(),cd=h({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ti,cyclic:Cr,flow:fu,flatgrid:nc,matrix:ma,execution:ke,menu:Ua,special:ja}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(n,e,o){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(t){t(n,e,o)})},setGridSize:function(t,n,e,o,r){At(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Ke}),sd=function(t,n,e,o){o=t.getSystem().build(o);Vs(t,o,e)},ld=function(t,n,e,o){t=fd(t);H(t,function(t){return Ne(o.element,t.element)}).each(Hs)},fd=function(t,n){return t.components()},dd=function(n,t,e,r,o){var i=fd(n);return tt.from(i[r]).map(function(t){return ld(n,0,0,t),o.each(function(t){sd(n,0,function(t,n){var e,o;o=n,Sr(e=t,r).fold(function(){Ir(e,o)},function(t){Ar(t,o)})},t)}),t})},md=$a({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){sd(t,0,Ir,o)},prepend:function(t,n,e,o){sd(t,0,Fr,o)},remove:ld,replaceAt:dd,replaceBy:function(n,t,e,o,r){var i=fd(n);return z(i,o).bind(function(t){return dd(n,0,0,t,r)})},set:function(n,t,e,o){ic(function(){var t=F(o,n.getSystem().build);Is(n,t)},n.element)},contents:fd})}),gd=function(t,n){return{key:t,value:{config:{},me:function(t,n){n=qo(n);return $a({fields:[Pn("enabled")],name:t,active:{events:W(n)}})}(t,n),configAsRaw:W({}),initialConfig:{},state:gi}}},pd=function(t,n){n.ignore||(ec(t.element),n.onFocus(t))},Kr=Object.freeze({__proto__:null,focus:pd,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return n=t.element,t=_r(n).dom,n.dom===t.activeElement;var n}}),ti=Object.freeze({__proto__:null,exhibit:function(t,n){n=n.ignore?{}:{attributes:{tabindex:"-1"}};return vi(n)},events:function(e){return qo([$o(vo(),function(t,n){pd(t,e),n.stop()})].concat(e.stopMousedown?[$o(to(),function(t,n){n.event.prevent()})]:[]))}}),Cr=[aa("onFocus"),$n("stopMousedown",!1),$n("ignore",!1)],hd=$a({fields:Cr,name:"focusing",active:ti,apis:Kr}),vd=function(t,n,e){n=n.aria;n.update(t,n,e.get())},bd=function(n,t,e){t.toggleClass.each(function(t){(e.get()?Ai:Fi)(n.element,t)})},yd=function(t,n,e){Sd(t,n,e,!e.get())},xd=function(t,n,e){e.set(!0),bd(t,n,e),vd(t,n,e)},wd=function(t,n,e){e.set(!1),bd(t,n,e),vd(t,n,e)},Sd=function(t,n,e,o){(o?xd:wd)(t,n,e)},kd=function(t,n,e){Sd(t,n,e,n.selected)},fu=Object.freeze({__proto__:null,onLoad:kd,toggle:yd,isOn:function(t,n,e){return e.get()},on:xd,off:wd,set:Sd}),nc=Object.freeze({__proto__:null,exhibit:function(){return vi({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=yd,ar(function(t){r(t,e,o)})),n=Wa(t,n,kd);return qo(et([t.toggleOnExecute?[i]:[],[n]]))}}),Cd=function(t,n,e){jr(t.element,"aria-expanded",e)},ma=[$n("selected",!1),Gn("toggleClass"),$n("toggleOnExecute",!0),Qn("aria",{mode:"none"},Tn("mode",{pressed:[$n("syncWithExpanded",!1),la("update",function(t,n,e){jr(t.element,"aria-pressed",e),n.syncWithExpanded&&Cd(t,n,e)})],checked:[la("update",function(t,n,e){jr(t.element,"aria-checked",e)})],expanded:[la("update",Cd)],selected:[la("update",function(t,n,e){jr(t.element,"aria-selected",e)})],none:[la("update",Q)]}))],Od=$a({fields:ma,name:"toggling",active:nc,apis:fu,state:(Bf=!1,{init:function(){var n=ae(Bf);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(Bf)},readState:function(){return n.get()}}}})}),_d=function(){var t=function(t,n){n.stop(),Wo(t)};return[$o(fo(),t),$o(ko(),t),er(Je()),er(to())]},Td=function(t){return qo(et([t.map(function(e){return ar(function(t,n){e(t),n.stop()})}).toArray(),_d()]))},Ed="alloy.item-hover",Dd="alloy.item-focus",Bd=function(t){(rc(t.element).isNone()||hd.isFocused(t))&&(hd.isFocused(t)||hd.focus(t),Uo(t,Ed,{item:t}))},Ad=function(t){Uo(t,Dd,{item:t})},Md=W(Ed),Fd=W(Dd),ke=[Pn("data"),Pn("components"),Pn("dom"),$n("hasSubmenu",!1),Gn("toggling"),ll("itemBehaviours",[Od,hd,cd,al]),$n("ignoreFocus",!1),$n("domModification",{}),la("builder",function(t){return{dom:t.dom,domModification:Z(Z({},t.domModification),{attributes:Z(Z(Z({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:fl(t.itemBehaviours,[t.toggling.fold(Od.revoke,function(t){return Od.config(Z({aria:{mode:"checked"}},t))}),hd.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Ad(t)}}),cd.config({mode:"execution"}),al.config({store:{mode:"memory",initialValue:t.data}}),gd("item-type-events",p(_d(),[$o(ro(),Bd),$o(So(),hd.focus)]))]),components:t.components,eventOrder:t.eventOrder}}),$n("eventOrder",{})],Ua=[Pn("dom"),Pn("components"),la("builder",function(t){return{dom:t.dom,components:t.components,events:qo([(t=So(),$o(t,function(t,n){n.stop()}))])}})],Id=W("item-widget"),Rd=W([kl({name:"widget",overrides:function(n){return{behaviours:Ka([al.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:Q}})])}}})]),ja=[Pn("uid"),Pn("data"),Pn("components"),Pn("dom"),$n("autofocus",!1),$n("ignoreFocus",!1),ll("widgetBehaviours",[al,hd,cd]),$n("domModification",{}),Ll(Rd()),la("builder",function(e){var t=Ml(Id(),e,Rd()),n=Fl(Id(),e,t.internals()),o=function(t){return Il(t,e,"widget").map(function(t){return cd.focusIn(t),t})},t=function(t,n){return Jl(n.event.target)||e.autofocus&&n.setSource(t.element),tt.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:qo([ar(function(t,n){o(t).each(function(t){n.stop()})}),$o(ro(),Bd),$o(So(),function(t,n){e.autofocus?o(t):hd.focus(t)})]),behaviours:fl(e.widgetBehaviours,[al.config({store:{mode:"memory",initialValue:e.data}}),hd.config({ignore:e.ignoreFocus,onFocus:function(t){Ad(t)}}),cd.config({mode:"special",focusIn:e.autofocus?function(t){o(t)}:Za(),onLeft:t,onRight:t,onEscape:function(t,n){return hd.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element),tt.none()):(hd.focus(t),tt.some(!0))}})])}})],Vd=Tn("type",{widget:ja,item:ke,separator:Ua}),Ke=W([It({factory:{sketch:function(t){t=Cn("menu.spec item",Vd,t);return t.builder(t)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:Z(Z({},n),{uid:ii("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Cr=W([Pn("value"),Pn("items"),Pn("dom"),Pn("components"),$n("eventOrder",{}),po("menuBehaviours",[af,al,$l,cd]),Qn("movement",{mode:"menu",moveOnTab:!0},Tn("mode",{grid:[e(),la("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[la("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),Pn("rowSelector")],menu:[$n("moveOnTab",!0),la("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),Hn("markers",ea()),$n("fakeFocus",!1),$n("focusManager",Ef()),aa("onHighlight")]),Pd=W("alloy.menu-focus"),Hd=il({name:"Menu",configFields:Cr(),partFields:Ke(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:sl(t.menuBehaviours,[af.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),al.config({store:{mode:"memory",initialValue:t.value}}),$l.config({find:tt.some}),cd.config(t.movement.config(t,t.movement))]),events:qo([$o(Fd(),function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each(function(t){af.highlight(n,t),e.stop(),Uo(n,Pd(),{menu:n,item:t})})}),$o(Md(),function(t,n){n=n.event.item;af.highlight(t,n)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),zd=function(e,o,r,t){return Dt(r,t).bind(function(t){return Dt(e,t).bind(function(t){var n=zd(e,o,r,t);return tt.some([t].concat(n))})}).getOr([])},Nd=function(t,n){var e={};St(t,function(t,n){nt(t,function(t){e[t]=n})});var o=n,r=Ct(n,function(t,n){return{k:t,v:n}}),i=kt(r,function(t,n){return[n].concat(zd(e,o,r,n))});return kt(e,function(t){return Dt(i,t).getOr([t])})},Ld=function(t){return"prepared"===t.type?tt.some(t.menu):tt.none()},jd={init:function(){var i=ae({}),r=ae({}),u=ae({}),a=ae(tt.none()),c=ae({}),s=function(t,o,r){return e(t).bind(function(n){return e=t,Tt(i.get(),function(t,n){return t===e}).bind(function(t){return o(t).map(function(t){return{triggeredMenu:n,triggeringItem:t,triggeringPath:r}})});var e})},e=function(t){return n(t).bind(Ld)},n=function(t){return Dt(r.get(),t)},l=function(t){return Dt(i.get(),t)};return{setMenuBuilt:function(t,n){var e;r.set(Z(Z({},r.get()),((e={})[t]={type:"prepared",menu:n},e)))},setContents:function(t,n,e,o){a.set(tt.some(t)),i.set(e),r.set(n),c.set(o);e=Nd(o,e);u.set(e)},expand:function(e){return Dt(i.get(),e).map(function(t){var n=Dt(u.get(),e).getOr([]);return[t].concat(n)})},refresh:function(t){return Dt(u.get(),t)},collapse:function(t){return Dt(u.get(),t).bind(function(t){return 1<t.length?tt.some(t.slice(1)):tt.none()})},lookupMenu:n,lookupItem:l,otherMenus:function(t){var n=c.get();return U(xt(n),t)},getPrimary:function(){return a.get().bind(e)},getMenus:function(){return r.get()},clear:function(){i.set({}),r.set({}),u.set({}),a.set(tt.none())},isClear:function(){return a.get().isNone()},getTriggeringPath:function(t,o){var n=R(l(t).toArray(),function(t){return e(t).isSome()});return Dt(u.get(),t).bind(function(t){var e=j(n.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return tt.none();n.push(o.getOrDie())}return tt.some(n)}(N(e,function(t,n){return s(t,o,e.slice(0,n+1)).fold(function(){return a.get().is(t)?[]:[tt.none()]},function(t){return[tt.some(t)]})}))})}}},extractPreparedMenu:Ld},Ud=W("collapse-item"),Wd=Yl({name:"TieredMenu",configFields:[t("onExecute"),t("onEscape"),sa("onOpenMenu"),sa("onOpenSubmenu"),aa("onRepositionMenu"),aa("onCollapseMenu"),$n("highlightImmediately",!0),jn("data",[Pn("primary"),Pn("menus"),Pn("expansions")]),$n("fakeFocus",!1),aa("onHighlight"),aa("onHover"),ra(),Pn("dom"),$n("navigateOnHover",!0),$n("stayInDom",!1),po("tmenuBehaviours",[cd,af,$l,md]),$n("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(u,t){var a,o=ae(tt.none()),c=jd.init(),e=function(t){var o,r,t=(o=t,r=u.data.primary,n=u.data.menus,kt(n,function(t,n){var e=function(){return Hd.sketch(Z(Z({},t),{value:n,markers:u.markers,fakeFocus:u.fakeFocus,onHighlight:u.onHighlight,focusManager:(u.fakeFocus?Df:Ef)()}))};return n===r?{type:"prepared",menu:o.getSystem().build(e())}:{type:"notbuilt",nbMenu:e}})),n=i();return c.setContents(u.data.primary,t,u.data.expansions,n),c.getPrimary()},s=function(t){return al.getValue(t).value},i=function(t){return kt(u.data.menus,function(t,n){return N(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},l=function(n,t){af.highlight(n,t),af.getHighlighted(t).orThunk(function(){return af.getFirst(t)}).each(function(t){Go(n,t.element,So())})},f=function(n,t){return ql(F(t,function(t){return n.lookupMenu(t).bind(function(t){return"prepared"===t.type?tt.some(t.menu):tt.none()})}))},d=function(n,t,e){e=f(t,t.otherMenus(e));nt(e,function(t){Vi(t.element,[u.markers.backgroundMenu]),u.stayInDom||md.remove(n,t)})},m=function(t,e){var n,t=(n=t,o.get().getOrThunk(function(){var e={},t=as(n.element,"."+u.markers.item),t=R(t,function(t){return"true"===Ur(t,"aria-haspopup")});return nt(t,function(t){n.getSystem().getByDom(t).each(function(t){var n=s(t);e[n]=t})}),o.set(tt.some(e)),e}));St(t,function(t,n){n=D(e,n);jr(t.element,"aria-expanded",n)})},g=function(e,o,r){return tt.from(r[0]).bind(function(t){return o.lookupMenu(t).bind(function(t){if("notbuilt"===t.type)return tt.none();var n=t.menu,t=f(o,r.slice(1));return nt(t,function(t){Ai(t.element,u.markers.backgroundMenu)}),Hi(n.element)||md.append(e,lu(n)),Vi(n.element,[u.markers.backgroundMenu]),l(e,n),d(e,o,r),tt.some(n)})})};(b=a=a||{})[b.HighlightSubmenu=0]="HighlightSubmenu",b[b.HighlightParent=1]="HighlightParent";var r=function(o,r,i){void 0===i&&(i=a.HighlightSubmenu);var t=s(r);return c.expand(t).bind(function(e){return m(o,e),tt.from(e[0]).bind(function(n){return c.lookupMenu(n).bind(function(t){t=function(t,n,e){if("notbuilt"!==e.type)return e.menu;e=t.getSystem().build(e.nbMenu());return c.setMenuBuilt(n,e),e}(o,n,t);return Hi(t.element)||md.append(o,lu(t)),u.onOpenSubmenu(o,r,t,j(e)),i===a.HighlightSubmenu?(af.highlightFirst(t),g(o,c,e)):(af.dehighlightAll(t),tt.some(r))})})})},p=function(n,e){var t=s(e);return c.collapse(t).bind(function(t){return m(n,t),g(n,c,t).map(function(t){return u.onCollapseMenu(n,e,t),t})})},n=function(e){return function(n,t){return Wu(t.getSource(),"."+u.markers.item).bind(function(t){return n.getSystem().getByDom(t).toOptional().bind(function(t){return e(n,t).map(S)})})}},h=qo([$o(Pd(),function(n,e){var t=e.event.item;c.lookupItem(s(t)).each(function(){var t=e.event.menu;af.highlight(n,t);t=s(e.event.item);c.refresh(t).each(function(t){return d(n,c,t)})})}),ar(function(n,t){t=t.event.target;n.getSystem().getByDom(t).each(function(t){0===s(t).indexOf("collapse-item")&&p(n,t),r(n,t,a.HighlightSubmenu).fold(function(){u.onExecute(n,t)},Q)})}),rr(function(n,t){e(n).each(function(t){md.append(n,lu(t)),u.onOpenMenu(n,t),u.highlightImmediately&&l(n,t)})})].concat(u.navigateOnHover?[$o(Md(),function(t,n){n=n.event.item;!function(n,t){t=s(t);c.refresh(t).bind(function(t){return m(n,t),g(n,c,t)})}(t,n),r(t,n,a.HighlightParent),u.onHover(t,n)})]:[])),v=function(t){return af.getHighlighted(t).bind(af.getHighlighted)},b={collapseMenu:function(n){v(n).each(function(t){p(n,t)})},highlightPrimary:function(n){c.getPrimary().each(function(t){l(n,t)})},repositionMenus:function(e){c.getPrimary().bind(function(n){return v(e).bind(function(t){var n=s(t),t=Et(c.getMenus()),e=ql(F(t,jd.extractPreparedMenu));return c.getTriggeringPath(n,function(t){return n=t,J(e,function(t){if(!t.getSystem().isConnected())return tt.none();t=af.getCandidates(t);return H(t,function(t){return s(t)===n})});var n})}).map(function(t){return{primary:n,triggeringPath:t}})}).fold(function(){tt.from(e.components()[0]).filter(function(t){return"menu"===Ur(t.element,"role")}).each(function(t){u.onRepositionMenu(e,t,[])})},function(t){var n=t.primary,t=t.triggeringPath;u.onRepositionMenu(e,n,t)})}};return{uid:u.uid,dom:u.dom,markers:u.markers,behaviours:sl(u.tmenuBehaviours,[cd.config({mode:"special",onRight:n(function(t,n){return Jl(n.element)?tt.none():r(t,n,a.HighlightSubmenu)}),onLeft:n(function(t,n){return Jl(n.element)?tt.none():p(t,n)}),onEscape:n(function(t,n){return p(t,n).orThunk(function(){return u.onEscape(t,n).map(function(){return t})})}),focusIn:function(n,t){c.getPrimary().each(function(t){Go(n,t.element,So())})}}),af.config({highlightClass:u.markers.selectedMenu,itemClass:u.markers.menu}),$l.config({find:function(t){return af.getHighlighted(t)}}),md.config({})]),eventOrder:u.eventOrder,apis:b,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Xt(t,n),expansions:{}}},collapseItem:function(t){return{value:Qr(Ud()),meta:{text:t}}}}}),Gd=Yl({name:"InlineView",configFields:[Pn("lazySink"),aa("onShow"),aa("onHide"),Kn("onEscape"),po("inlineBehaviours",[Ks,al,tc]),Jn("fireDismissalEventInstead",[$n("event",Io())]),Jn("fireRepositionEventInstead",[$n("event",Ro())]),$n("getRelated",tt.none),$n("isExtraPart",l),$n("eventOrder",tt.none)],factory:function(f,t){var o=function(t,n,e,o){r(t,n,e,function(){return o.map(Iu)})},r=function(t,n,e,o){var r=f.lazySink(t).getOrDie();Ks.openWhileCloaked(t,e,function(){return Bs.positionWithinBounds(r,n,t,o())}),al.setValue(t,tt.some({mode:"position",anchor:n,getBounds:o}))},i=function(t,n,e,o){var r,i,u,a,c,s,l,e=(r=f,i=t,u=n,a=o,c=function(){return r.lazySink(i)},s="horizontal"===e.type?{layouts:{onLtr:Na,onRtl:La}}:{},l=function(t){return 2===t.length?s:{}},Wd.sketch({dom:{tag:"div"},data:e.data,markers:e.menu.markers,highlightImmediately:e.menu.highlightImmediately,onEscape:function(){return Ks.close(i),r.onEscape.map(function(t){return t(i)}),tt.some(!0)},onExecute:function(){return tt.some(!0)},onOpenMenu:function(t,n){Bs.positionWithinBounds(c().getOrDie(),u,n,a())},onOpenSubmenu:function(t,n,e,o){var r=c().getOrDie();Bs.position(r,Z({anchor:"submenu",item:n},l(o)),e)},onRepositionMenu:function(t,n,e){var o=c().getOrDie();Bs.positionWithinBounds(o,u,n,a()),nt(e,function(t){var n=l(t.triggeringPath);Bs.position(o,Z({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)})}}));Ks.open(t,e),al.setValue(t,tt.some({mode:"menu",menu:e}))},n=function(e){Ks.isOpen(e)&&al.getValue(e).each(function(t){switch(t.mode){case"menu":Ks.getState(e).each(function(t){Wd.repositionMenus(t)});break;case"position":var n=f.lazySink(e).getOrDie();Bs.positionWithinBounds(n,t.anchor,e,t.getBounds())}})},e={setContent:function(t,n){Ks.setContent(t,n)},showAt:function(t,n,e){o(t,n,e,tt.none())},showWithin:o,showWithinBounds:r,showMenuAt:function(t,n,e){i(t,n,e,function(){return tt.none()})},showMenuWithinBounds:i,hide:function(t){Ks.isOpen(t)&&(al.setValue(t,tt.none()),Ks.close(t))},getContent:function(t){return Ks.getState(t)},reposition:n,isOpen:Ks.isOpen};return{uid:f.uid,dom:f.dom,behaviours:sl(f.inlineBehaviours,[Ks.config({isPartOf:function(t,n,e){return Yu(n,e)||(o=e,f.getRelated(t).exists(function(t){return Yu(t,o)}));var o},getAttachPoint:function(t){return f.lazySink(t).getOrDie()},onOpen:function(t){f.onShow(t)},onClose:function(t){f.onHide(t)}}),al.config({store:{mode:"memory",initialValue:tt.none()}}),tc.config({channels:Z(Z({},tl(Z({isExtraPart:t.isExtraPart},f.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),el(Z(Z({},f.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:n})))})]),eventOrder:f.eventOrder,apis:e}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),Xd=function(t,n){return t.x+t.width/2-n.width/2},Yd=function(t,n){return t.x+t.width-n.width},qd=function(t,n){return t.y+t.height-n.height},Kd=function(t,n,e){return da(Yd(t,n),qd(t,n),e.innerSoutheast(),va(),Sa(t,{right:0,bottom:3}),"layout-inner-se")},Jd=function(t,n,e){return da(t.x,qd(t,n),e.innerSouthwest(),ha(),Sa(t,{left:1,bottom:3}),"layout-inner-sw")},$d=function(t,n,e){return da(Yd(t,n),t.y,e.innerNortheast(),pa(),Sa(t,{right:0,top:2}),"layout-inner-ne")},Qd=function(t,n,e){return da(t.x,t.y,e.innerNorthwest(),ga(),Sa(t,{left:1,top:2}),"layout-inner-nw")},Zd=function(t,n,e){return da(Xd(t,n),t.y,e.innerNorth(),ba(),Sa(t,{top:2}),"layout-inner-n")},tm=function(t,n,e){return da(Xd(t,n),qd(t,n),e.innerSouth(),ya(),Sa(t,{bottom:3}),"layout-inner-s")},nm=tinymce.util.Tools.resolve("tinymce.util.Delay"),em=Yl({name:"Button",factory:function(t){var n=Td(t.action),e=t.dom.tag,o=function(n){return Dt(t.dom,"attributes").bind(function(t){return Dt(t,n)})};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:fl(t.buttonBehaviours,[hd.config({}),cd.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map(function(t){return{role:t}}).getOr({});return Z({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[$n("uid",undefined),Pn("dom"),$n("components",[]),ll("buttonBehaviours",[hd,cd]),Gn("action"),Gn("role"),$n("eventOrder",{})]}),om=function(t){var n=t.uid!==undefined&&At(t,"uid")?t.uid:ii("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return Z(Z({},t),{uid:n})}}},rm=function(t){return tt.from(t()["temporary-placeholder"]).getOr("!not found!")},im=function(t,n){return tt.from(n()[t.toLowerCase()]).getOrThunk(function(){return rm(n)})},um={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},am=Yl({name:"Notification",factory:function(n){var e,o=om({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:Ka([md.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=om({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:Ka([md.config({})])}),t={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){md.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])})},updateText:function(t,n){t.getSystem().isConnected()&&(t=o.get(t),md.set(t,[uu(n)]))}},a=et([n.icon.toArray(),n.level.toArray(),n.level.bind(function(t){return tt.from(um[t])}).toArray()]),c=om(em.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:im("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),a=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(e=n.iconProvider,J(a,function(t){return tt.from(e()[t.toLowerCase()])}).getOrThunk(function(){return rm(e)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:Ka([md.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:Ka([hd.config({}),gd("notification-events",[$o(io(),function(t){c.getOpt(t).each(hd.focus)})])]),components:a.concat(n.progress?[u.asSpec()]:[]).concat(n.closeButton?[c.asSpec()]:[]),apis:t}},configFields:[Gn("level"),Pn("progress"),Pn("icon"),Pn("onAction"),Pn("text"),Pn("iconProvider"),Pn("translationProvider"),ee("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function cm(t,u,a){var c=u.backstage;return{open:function(t,n){var e=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),o=function(){n(),Gd.hide(i)},r=su(am.sketch({text:t.text,level:D(["success","error","warning","warn","info"],t.type)?t.type:undefined,progress:!0===t.progressBar,icon:tt.from(t.icon),closeButton:!e,onAction:o,iconProvider:c.shared.providers.icons,translationProvider:c.shared.providers.translate})),i=su(Gd.sketch(Z({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:u.backstage.shared.getSink,fireDismissalEventInstead:{}},c.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return a.add(i),0<t.timeout&&nm.setTimeout(function(){o()},t.timeout),{close:o,moveTo:function(t,n){Gd.showAt(i,{anchor:"makeshift",x:t,y:n},lu(r))},moveRel:function(t,n){var e;"banner"!==n?(e=function(t){switch(t){case"bc-bc":return tm;case"tc-tc":return Zd;case"tc-bc":return Ma;case"bc-tc":default:return Fa}}(n),t={anchor:"node",root:zi(),node:tt.some(se.fromDom(t)),layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}},Gd.showAt(i,t,lu(r))):Gd.showAt(i,u.backstage.shared.anchors.banner(),lu(r))},text:function(t){am.updateText(r,t)},settings:t,getEl:function(){return r.element.dom},progressBar:{value:function(t){am.updateProgress(r,t)}}}},close:function(t){t.close()},reposition:function(t){var e;nt(t,function(t){return t.moveTo(0,0)}),0<(e=t).length&&(Y(e).each(function(t){return t.moveRel(null,"banner")}),nt(e,function(t,n){0<n&&t.moveRel(e[n-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}var sm=function(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null!==r&&clearTimeout(r),r=setTimeout(function(){e.apply(null,t),r=null},o)}}},lm=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),fm=function(e,t,n,o,r){var i=lm(e,function(t){return n=t,(t=e).isBlock(n)||D(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n);var n});return tt.from(i.backwards(t,n,o,r))},dm=function(e,n){return mm(se.fromDom(e.selection.getNode())).getOrThunk(function(){var t=se.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return Ir(t,se.fromDom(n.extractContents())),n.insertNode(t.dom),br(t).each(function(t){return t.dom.normalize()}),us(t,is).map(function(t){var n;e.selection.setCursorLocation(t.dom,"img"===cr(n=t)?1:os(n).fold(function(){return wr(n).length},function(t){return t.length}))}),t})},mm=function(t){return Wu(t,"[data-mce-autocompleter]")},gm=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},pm=function(t){return""!==t&&-1!==" \xa0\f\n\r\t\x0B".indexOf(t)},hm=function(t,n){return t.substring(n.length)},vm=function(t,e,o,r){if(void 0===r&&(r=0),!(n=e).collapsed||3!==n.startContainer.nodeType)return tt.none();var n=t.getParent(e.startContainer,t.isBlock)||t.getRoot();return fm(t,e.startContainer,e.startOffset,function(t,n,e){return function(t,n,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o);if(pm(r))return tt.none();if(r===e)break}return tt.some(o)}(e,n,o).getOr(n)},n).bind(function(t){var n=e.cloneRange();if(n.setStart(t.container,t.offset),n.setEnd(e.endContainer,e.endOffset),n.collapsed)return tt.none();t=gm(n);return 0!==t.lastIndexOf(o)||hm(t,o).length<r?tt.none():tt.some({text:hm(t,o),range:n,triggerChar:o})})},bm=function(e,t,o,n){return void 0===n&&(n=0),mm(se.fromDom(t.startContainer)).fold(function(){return vm(e,t,o,n)},function(t){var n=e.createRng();n.selectNode(t.dom);t=gm(n);return tt.some({range:n,text:hm(t,o),triggerChar:o})})},ym=function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var o=function(t,n){Uo(t,ao(),{raw:n})};t.on("keydown",function(n){var t=function(){return e.getView().bind(af.getHighlighted)};8===n.which&&e.onKeypress.throttle(n),e.isActive()&&(27===n.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===n.which?(t().each(Wo),n.preventDefault()):40===n.which?(t().fold(function(){e.getView().each(af.highlightFirst)},function(t){o(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||t().each(function(t){o(t,n),n.preventDefault(),n.stopImmediatePropagation()}):13!==n.which&&38!==n.which&&40!==n.which||e.cancelIfNecessary())}),t.on("NodeChange",function(t){e.isActive()&&!e.isProcessingAction()&&mm(se.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},xm=tinymce.util.Tools.resolve("tinymce.util.Promise"),wm=function(t,n){return{container:t,offset:n}},Sm=function(t){if(3===t.nodeType)return wm(t,t.data.length);var n=t.childNodes;return 0<n.length?Sm(n[n.length-1]):wm(t,n.length)},km=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?km(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?Sm(e[e.length-1]):wm(t,n)},Cm=function(n){return function(t){t=km(t.startContainer,t.startOffset);return!fm(n,t.container,t.offset,function(t,n){return 0===n?-1:n},n.getRoot()).filter(function(t){t=t.container.data.charAt(t.offset-1);return!pm(t)}).isSome()}},Om=function(n,e){var o,r,t=e(),i=n.selection.getRng();return o=n.dom,r=i,J(t.triggerChars,function(t){return bm(o,r,t)}).bind(function(t){return _m(n,e,t)})},_m=function(n,t,e,o){void 0===o&&(o={});var t=t(),r=n.selection.getRng().startContainer.nodeValue,t=R(t.lookupByChar(e.triggerChar),function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk(function(){return Cm(n.dom)})(e.range,r,e.text)});if(0===t.length)return tt.none();t=xm.all(F(t,function(n){return n.fetch(e.text,n.maxResults,o).then(function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}})}));return tt.some({lookupData:t,context:e})},Tm=an([zn("type"),qn("text")]),Em=an([$n("type","autocompleteitem"),$n("active",!1),$n("disabled",!1),$n("meta",{}),zn("value"),qn("text"),qn("icon")]),Dm=an([zn("type"),zn("ch"),Zn("minChars",1),$n("columns",1),Zn("maxResults",10),Kn("matches"),Ln("fetch"),Ln("onAction"),re("highlightOn",[],An)]),ti=[ee("disabled",!1),qn("tooltip"),qn("icon"),qn("text"),oe("onSetup",function(){return Q})],Bm=an([zn("type"),Ln("onAction")].concat(ti)),Am=function(t){return Sn("toolbarbutton",Bm,t)},Kr=[ee("active",!1)].concat(ti),Mm=an(Kr.concat([zn("type"),Ln("onAction")])),Fm=function(t){return Sn("ToggleButton",Mm,t)},ma=[oe("predicate",l),ne("scope","node",["node","editor"]),ne("position","selection",["node","selection","line"])],nc=ti.concat([$n("type","contextformbutton"),$n("primary",!1),Ln("onAction"),ue("original",w)]),fu=Kr.concat([$n("type","contextformbutton"),$n("primary",!1),Ln("onAction"),ue("original",w)]),ja=ti.concat([$n("type","contextformbutton")]),ke=Kr.concat([$n("type","contextformtogglebutton")]),Ua=Tn("type",{contextformbutton:nc,contextformtogglebutton:fu}),Im=an([$n("type","contextform"),oe("initValue",function(){return""}),qn("label"),Wn("commands",Ua),Xn("launch",Tn("type",{contextformbutton:ja,contextformtogglebutton:ke}))].concat(ma)),Rm=an([$n("type","contexttoolbar"),zn("items")].concat(ma)),Vm=function(t){var n,e=t.ui.registry.getAll().popups,t=kt(e,function(t){return Sn("Autocompleter",Dm,t).fold(function(t){throw new Error(On(t))},function(t){return t})}),e=(e=_t(t,function(t){return t.ch}),n={},nt(e,function(t){n[t]={}}),xt(n)),o=Et(t);return{dataset:t,triggerChars:e,lookupByChar:function(n){return R(o,function(t){return t.ch===n})}}};(e=Uv=Uv||{})[e.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",e[e.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var Pm,Hm=Uv,zm="tox-menu-nav__js",Nm="tox-collection__item",Lm="tox-swatch",jm={normal:zm,color:Lm},Um="tox-collection__item--enabled",Wm="tox-collection__item-label",Gm="tox-collection__item-caret",Xm="tox-collection__item--active",Ym="tox-collection__item-container",qm="tox-collection__item-container--row",Km=function(t){return Dt(jm,t).getOr(zm)},Jm=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},$m=function(t){var n=Jm(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Km(t)}},Qm=[Hd.parts.items({})],Zm=function(t,n,e){var o=Jm(e);return{dom:{tag:"div",classes:et([[o.tieredMenu]])},markers:$m(e)}},tg=function(n,e){return function(t){t=M(t,e);return F(t,function(t){return{dom:n,components:t}})}},ng=function(t,e){var o=[],r=[];return nt(t,function(t,n){e(t,n)?(0<r.length&&o.push(r),r=[],Bt(t.dom,"innerHtml")&&r.push(t)):r.push(t)}),0<r.length&&o.push(r),F(o,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})},eg=function(n,e,t){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Hd.parts.items({preprocess:function(t){return"auto"!==n&&1<n?tg({tag:"div",classes:["tox-collection__group"]},n)(t):ng(t,function(t,n){return"separator"===e[n].type})}})]}},og=function(t){return B(t,function(t){return"icon"in t&&t.icon!==undefined})},rg=function(t){return console.error(On(t)),console.log(t),tt.none()},ig=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Hd.parts.items({preprocess:function(t){return ng(t,function(t,n){return"separator"===i[n].type})}})]});return{value:t,dom:u.dom,components:u.components,items:e}},ug=function(t,n,e,o,r){var i;return"color"===r?{value:t,dom:(i=(i=o,{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Hd.parts.items({preprocess:"auto"!==i?tg({tag:"div",classes:["tox-swatches__row"]},i):w})]}]})).dom,components:i.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(i=eg(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=eg(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=eg(o,e)).dom,components:i.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:function(t,n,e){e=Jm(e);return{tag:"div",classes:et([[e.menu,"tox-menu-"+n+"-column"],t?[e.hasIcons]:[]])}}(n,o,r),components:Qm,items:e}:{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Hd.parts.items({preprocess:tg({tag:"div",classes:["tox-collection__group"]},o)})]}).dom,components:i.components,items:e}},Cr=[zn("type"),zn("src"),qn("alt"),re("classes",[],An)],ag=an(Cr),Ke=[zn("type"),zn("text"),qn("name"),re("classes",["tox-collection__item-label"],An)],cg=an(Ke),Ro=yn(function(){return _n("type",{cardimage:ag,cardtext:cg,cardcontainer:sg})}),sg=an([zn("type"),te("direction","horizontal"),te("align","left"),te("valign","middle"),Wn("items",Ro)]),Kr=[ee("disabled",!1),qn("text"),qn("shortcut"),gn("value","value",jt(function(){return Qr("menuitem-value")}),En()),$n("meta",{})],lg=an([zn("type"),qn("label"),Wn("items",Ro),oe("onSetup",function(){return Q}),oe("onAction",Q)].concat(Kr)),fg=an([zn("type"),ee("active",!1),qn("icon")].concat(Kr)),dg=an([zn("type"),Nn("fancytype",["inserttable","colorswatch"]),oe("onAction",Q)]),mg=an([zn("type"),oe("onSetup",function(){return Q}),oe("onAction",Q),qn("icon")].concat(Kr)),gg=an([zn("type"),Ln("getSubmenuItems"),oe("onSetup",function(){return Q}),qn("icon")].concat(Kr)),pg=an([zn("type"),qn("icon"),ee("active",!1),oe("onSetup",function(){return Q}),Ln("onAction")].concat(Kr)),hg=function(t,e,n){var o=as(t.element,"."+n);if(0<o.length){n=z(o,function(t){var n=t.dom.getBoundingClientRect().top,t=o[0].dom.getBoundingClientRect().top;return Math.abs(n-t)>e}).getOr(o.length);return tt.some({numColumns:n,numRows:Math.ceil(o.length/n)})}return tt.none()},vg=function(t,n){return Ka([gd(t,n)])},bg=function(t){return vg(Qr("unnamed-events"),t)},yg=Qr("tooltip.exclusive"),xg=Qr("tooltip.show"),wg=Qr("tooltip.hide"),Sg=function(t,n,e){t.getSystem().broadcastOn([yg],{})},nc=Object.freeze({__proto__:null,hideAllExclusive:Sg,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&md.set(t,o)})}}),fu=Object.freeze({__proto__:null,events:function(r,i){var e=function(n){i.getTooltip().each(function(t){Hs(t),r.onHide(n,t),i.clearTooltip()}),i.clearTimer()};return qo(et([[$o(xg,function(o){i.resetTimer(function(){var n,t,e;n=o,i.isShowing()||(Sg(n),t=r.lazySink(n).getOrDie(),e=n.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:qo("normal"===r.mode?[$o(ro(),function(t){jo(n,xg)}),$o(eo(),function(t){jo(n,wg)})]:[]),behaviours:Ka([md.config({})])}),i.setTooltip(e),Rs(t,e),r.onShow(n,e),Bs.position(t,r.anchor(n),e))},r.delay)}),$o(wg,function(t){i.resetTimer(function(){e(t)},r.delay)}),$o(xo(),function(t,n){n.universal||D(n.channels,yg)&&e(t)}),ir(function(t){e(t)})],"normal"===r.mode?[$o(io(),function(t){jo(t,xg)}),$o(bo(),function(t){jo(t,wg)}),$o(ro(),function(t){jo(t,xg)}),$o(eo(),function(t){jo(t,wg)})]:[$o(No(),function(t,n){jo(t,xg)}),$o(Lo(),function(t){jo(t,wg)})]]))}}),Ua=[Pn("lazySink"),Pn("tooltipDom"),$n("exclusive",!0),$n("tooltipComponents",[]),$n("delay",300),ne("mode","normal",["normal","follow-highlight"]),$n("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:W([Fa,Ma,Ea,Ba,Da,Aa]),onRtl:W([Fa,Ma,Ea,Ba,Da,Aa])}}}),aa("onHide"),aa("onShow")],kg=$a({fields:Ua,name:"tooltipping",active:fu,state:Object.freeze({__proto__:null,init:function(){var e=ae(tt.none()),n=ae(tt.none()),o=function(){e.get().each(function(t){clearTimeout(t)})},t=W("not-implemented");return pi({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(tt.some(t))},clearTooltip:function(){n.set(tt.none())},clearTimer:o,resetTimer:function(t,n){o(),e.set(tt.some(setTimeout(function(){t()},n)))},readState:t})}}),apis:nc}),Cg=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Og=tinymce.util.Tools.resolve("tinymce.util.I18n"),_g=["input","button","textarea","select"],Tg=function(t,n,e){(n.disabled()?Fg:Ig)(t,n)},Eg=function(t,n){return!0===n.useNative&&D(_g,cr(t.element))},Dg=function(t){jr(t.element,"disabled","disabled")},Bg=function(t){Xr(t.element,"disabled")},Ag=function(t){jr(t.element,"aria-disabled","true")},Mg=function(t){jr(t.element,"aria-disabled","false")},Fg=function(n,t,e){t.disableClass.each(function(t){Ai(n.element,t)}),(Eg(n,t)?Dg:Ag)(n),t.onDisabled(n)},Ig=function(n,t,e){t.disableClass.each(function(t){Fi(n.element,t)}),(Eg(n,t)?Bg:Mg)(n),t.onEnabled(n)},Rg=function(t,n){return Eg(t,n)?Gr(t.element,"disabled"):"true"===Ur(t.element,"aria-disabled")},ja=Object.freeze({__proto__:null,enable:Ig,disable:Fg,isDisabled:Rg,onLoad:Tg,set:function(t,n,e,o){(o?Fg:Ig)(t,n)}}),ke=Object.freeze({__proto__:null,exhibit:function(t,n){return vi({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(e,t){return qo([Ko(wo(),function(t,n){return Rg(t,e)}),Wa(e,t,Tg)])}}),ma=[oe("disabled",l),$n("useNative",!0),Gn("disableClass"),aa("onDisabled"),aa("onEnabled")],Vg=$a({fields:ma,name:"disabling",active:ke,apis:ja}),Pg=tinymce.util.Tools.resolve("tinymce.EditorManager"),Hg=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},zg=function(t){return t.getParam("width",Cg.DOM.getStyle(t.getElement(),"width"))},Ng=function(t){return tt.from(t.getParam("min_width")).filter($)},Lg=function(t){return tt.from(t.getParam("min_height")).filter($)},jg=function(t){return tt.from(t.getParam("max_width")).filter($)},Ug=function(t){return tt.from(t.getParam("max_height")).filter($)},Wg=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Gg=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=v(n),n=c(n)&&0<n.length;return!Yg(t)&&(n||o||e)},Xg=function(n){var t=A(9,function(t){return n.getParam("toolbar"+(t+1),!1,"string")}),t=R(t,function(t){return"string"==typeof t});return 0<t.length?tt.some(t):tt.none()},Yg=function(t){return Xg(t).fold(function(){return 0<t.getParam("toolbar",[],"string[]").length},S)};(e=Pm=Pm||{})["default"]="wrap",e.floating="floating",e.sliding="sliding",e.scrolling="scrolling";var qg,Kg=function(t){return t.getParam("toolbar_mode","","string")};(Uv=qg=qg||{}).auto="auto",Uv.top="top",Uv.bottom="bottom";var Jg=function(t){return t.getParam("toolbar_location",qg.auto,"string")},$g=function(t){return Jg(t)===qg.bottom},Qg=function(t){if(!t.inline)return tt.none();var n=t.getParam("fixed_toolbar_container","","string");if(0<n.length)return Uu(zi(),n);t=t.getParam("fixed_toolbar_container_target");return i(t)?tt.some(se.fromDom(t)):tt.none()},Zg=function(t){return t.inline&&Qg(t).isSome()},tp=function(t){return Qg(t).getOrThunk(function(){return Tr(_r(se.fromDom(t.getElement())))})},np=function(t){return t.inline&&!Wg(t)&&!Gg(t)&&!Yg(t)},ep=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Zg(t)&&!np(t)},op="silver.readonly",rp=an([Hn("readonly",Mn)]),ip=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([Js()],{target:e}),t.uiMothership.broadcastOn([Js()],{target:e})),t.mothership.broadcastOn([op],{readonly:n}),t.uiMothership.broadcastOn([op],{readonly:n})},up=function(t,n){t.on("init",function(){t.mode.isReadOnly()&&ip(n,!0)}),t.on("SwitchMode",function(){return ip(n,t.mode.isReadOnly())}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},ap=function(){var t;return tc.config({channels:((t={})[op]={schema:rp,onReceive:function(t,n){Vg.set(t,n.readonly)}},t)})},cp=function(t){return Vg.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},sp=function(t){return Vg.config({disabled:t})},lp=function(t){return Vg.config({disabled:t,disableClass:"tox-tbtn--disabled"})},fp=function(t){return Vg.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},dp=function(t,n){var e=t.getApi(n);return function(t){t(e)}},mp=function(n,e){return rr(function(t){dp(n,t)(function(t){t=n.onSetup(t);f(t)&&e.set(t)})})},gp=function(n,e){return ir(function(t){return dp(n,t)(e.get())})},pp=((Cr={})[wo()]=["disabling","alloy.base.behaviour","toggling","item-events"],Cr),hp=function(t){return N(t,function(t){return t.toArray()})},vp=function(t,n,e,o){var r,i,u=ae(Q);return{type:"item",dom:n.dom,components:hp(n.optComponents),data:t.data,eventOrder:pp,hasSubmenu:t.triggersSubmenu,itemBehaviours:Ka([gd("item-events",[(r=t,i=e,ar(function(t,n){dp(r,t)(r.onAction),r.triggersSubmenu||i!==Hm.CLOSE_ON_EXECUTE||(t.getSystem().isConnected()&&jo(t,Oo()),n.stop())})),mp(t,u),gp(t,u)]),cp(function(){return t.disabled||o.isDisabled()}),ap(),md.config({})].concat(t.itemBehaviours))}},bp=function(t){return{value:t.value,meta:Z({text:t.text.getOr("")},t.meta)}},yp=tinymce.util.Tools.resolve("tinymce.Env"),xp=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},wp=function(t){return{dom:{tag:"div",classes:[Wm]},components:[uu(Og.translate(t))]}},Sp=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},kp=function(t,n){return{dom:{tag:"div",classes:[Wm]},components:[{dom:{tag:t.tag,styles:t.styles},components:[uu(Og.translate(n))]}]}},Cp=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(t=t,e=yp.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},t=t.split("+"),t=F(t,function(t){var n=t.toLowerCase().trim();return Bt(e,n)?e[n]:t}),yp.mac?t.join(""):t.join("+"))}};var e},Op=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:im("checkmark",t)}}},_p=function(t,n){n=n.map(function(t){return{attributes:{title:Og.translate(t)}}}).getOr({});return Z({tag:"div",classes:[zm,Nm].concat(t?["tox-collection__item-icon-rtl"]:[])},n)},Tp=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Ep=["list-bull-circle","list-bull-default","list-bull-square"],Dp=function(t,o,n,r){void 0===r&&(r=tt.none());var e,i,u,a,c,s,l=Og.isRtl()&&t.iconContent.exists(function(t){return D(Ep,t)}),f=t.iconContent.map(function(t){return Og.isRtl()&&D(Tp,t)?t+"-rtl":t}).map(function(t){return n=t,e=o.icons,t=r,tt.from(e()[n.toLowerCase()]).or(t).getOrThunk(function(){return rm(e)});var n,e}),d=tt.from(t.meta).fold(function(){return wp},function(t){return Bt(t,"style")?m(kp,t.style):wp});return"color"===t.presets?(s=t.ariaLabel,u=t.value,a=o,{dom:(c=f.getOr(""),s={tag:"div",attributes:s.map(function(t){return{title:a.translate(t)}}).getOr({}),classes:["tox-swatch"]},Z(Z({},s),"custom"===u?{tag:"button",classes:p(s.classes,["tox-swatches__picker-btn"]),innerHtml:c}:"remove"===u?{classes:p(s.classes,["tox-swatch--remove"]),innerHtml:c}:{attributes:Z(Z({},s.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}):(e=t,f=f,i=d,d=l,n=(l=n)?f.or(tt.some("")).map(xp):tt.none(),l=e.checkMark,f=e.htmlContent.fold(function(){return e.textContent.map(i)},function(t){return tt.some(Sp(t,[Wm]))}),{dom:_p(d,e.ariaLabel),optComponents:[n,f,e.shortcutContent.map(Cp),l,e.caret]})},Bp=function(t,n){return Dt(t,"tooltipWorker").map(function(e){return[kg.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:wc}}},mode:"follow-highlight",onShow:function(n,t){e(function(t){kg.setComponents(n,[au({element:se.fromDom(t)})])})}})]}).getOr([])},Ap=function(t,n){t=Og.translate(t),t=Cg.DOM.encode(t);if(0<n.length){n=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return t.replace(n,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})}return t},Mp=function(t,u){return F(t,function(t){switch(t.type){case"cardcontainer":return o=Mp((e=t).items,u),r="vertical"===e.direction?"tox-collection__item-container--column":qm,i="left"===e.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[Ym,r,i,function(){switch(e.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:o};case"cardimage":return i=t.src,o=t.classes,n=t.alt,{dom:{tag:"img",classes:o,attributes:{src:i,alt:n.getOr("")}}};case"cardtext":n=t.name.exists(function(t){return D(u.cardText.highlightOn,t)})?tt.from(u.cardText.matchText).getOr(""):"";return Sp(Ap(t.text,n),t.classes)}var n,e,o,r,i})},Fp=Tl(Id(),Rd()),Ip=function(t){return{value:t}},Rp=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Vp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Pp=function(t){return Rp.test(t)||Vp.test(t)},Hp=function(t){t={value:t.value.replace(Rp,function(t,n,e,o){return n+n+e+e+o+o})},t=Vp.exec(t.value);return null===t?["FFFFFF","FF","FF","FF"]:t},zp=function(t){t=t.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},Np=function(t){t=zp(t.red)+zp(t.green)+zp(t.blue);return Ip(t)},Lp=Math.min,jp=Math.max,Up=Math.round,Wp=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Gp=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Xp=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Yp=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},qp=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,t=t.value/100,i=jp(0,Lp(i,1)),t=jp(0,Lp(t,1));if(0===i)return n=e=o=Up(255*t),Xp(n,e,o,1);var r=r/60,u=t*i,a=u*(1-Math.abs(r%2-1)),t=t-u;switch(Math.floor(r)){case 0:n=u,e=a,o=0;break;case 1:n=a,e=u,o=0;break;case 2:n=0,e=u,o=a;break;case 3:n=0,e=a,o=u;break;case 4:n=a,e=0,o=u;break;case 5:n=u,e=0,o=a;break;default:n=e=o=0}return n=Up(255*(n+t)),e=Up(255*(e+t)),o=Up(255*(o+t)),Xp(n,e,o,1)},Kp=function(t){var n=Hp(t),e=parseInt(n[1],16),t=parseInt(n[2],16),n=parseInt(n[3],16);return Xp(e,t,n,1)},Jp=function(t,n,e,o){t=parseInt(t,10),n=parseInt(n,10),e=parseInt(e,10),o=parseFloat(o);return Xp(t,n,e,o)},$p=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Qp=Xp(255,0,0,1),Zp=function(t,n){return t.fire("ResizeContent",n)},th=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),nh="tinymce-custom-colors";var eh,oh="choiceitem",rh=[{type:oh,text:"Light Green",value:"#BFEDD2"},{type:oh,text:"Light Yellow",value:"#FBEEB8"},{type:oh,text:"Light Red",value:"#F8CAC6"},{type:oh,text:"Light Purple",value:"#ECCAFA"},{type:oh,text:"Light Blue",value:"#C2E0F4"},{type:oh,text:"Green",value:"#2DC26B"},{type:oh,text:"Yellow",value:"#F1C40F"},{type:oh,text:"Red",value:"#E03E2D"},{type:oh,text:"Purple",value:"#B96AD9"},{type:oh,text:"Blue",value:"#3598DB"},{type:oh,text:"Dark Turquoise",value:"#169179"},{type:oh,text:"Orange",value:"#E67E23"},{type:oh,text:"Dark Red",value:"#BA372A"},{type:oh,text:"Dark Purple",value:"#843FA1"},{type:oh,text:"Dark Blue",value:"#236FA1"},{type:oh,text:"Light Gray",value:"#ECF0F1"},{type:oh,text:"Medium Gray",value:"#CED4D9"},{type:oh,text:"Gray",value:"#95A5A6"},{type:oh,text:"Dark Gray",value:"#7E8C8D"},{type:oh,text:"Navy Blue",value:"#34495E"},{type:oh,text:"Black",value:"#000000"},{type:oh,text:"White",value:"#ffffff"}],ih=function(n){void 0===n&&(n=10);var t=th.getItem(nh),t=v(t)?JSON.parse(t):[],e=n-(t=t).length<0?t.slice(0,n):t,o=function(t){e.splice(t,1)};return{add:function(t){!function(t,n){n=E(t,n);return-1===n?tt.none():tt.some(n)}(e,t).each(o),e.unshift(t),e.length>n&&e.pop(),th.setItem(nh,JSON.stringify(e))},state:function(){return e.slice(0)}}}(10),uh=function(t){var n=[],r=document.createElement("canvas");r.height=1,r.width=1;for(var i=r.getContext("2d"),u=function(t,n){n/=255;return("0"+Math.round(t*n+255*(1-n)).toString(16)).slice(-2).toUpperCase()},e=0;e<t.length;e+=2)n.push({text:t[e+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();i.clearRect(0,0,r.width,r.height),i.fillStyle="#FFFFFF",i.fillStyle=t,i.fillRect(0,0,1,1);var n=i.getImageData(0,0,1,1).data,e=n[0],o=n[1],t=n[2],n=n[3];return"#"+u(e,n)+u(o,n)+u(t,n)}(t[e]),type:"choiceitem"});return n},ah=function(t){return!1!==t.getParam("custom_colors")},ch=function(t){t=t.getParam("color_map");return t!==undefined?uh(t):rh},sh=function(t){ih.add(t)},lh=function(i){i.addCommand("mceApplyTextcolor",function(t,n){var e,o,r;o=t,r=n,(e=i).undoManager.transact(function(){e.focus(),e.formatter.apply(o,{value:r}),e.nodeChanged()})}),i.addCommand("mceRemoveTextcolor",function(t){var n,e;e=t,(n=i).undoManager.transact(function(){n.focus(),n.formatter.remove(e,{value:null},null,!0),n.nodeChanged()})})},fh=function(t){var n=ch(t),n=(n=n.length,Math.max(5,Math.ceil(Math.sqrt(n))));return t.getParam("color_cols",n,"number")},dh=function(n,e,t,o){"custom"===t?bh(n)(function(t){t.each(function(t){sh(t),n.execCommand("mceApplyTextcolor",e,t),o(t)})},"#000000"):"remove"===t?(o(""),n.execCommand("mceRemoveTextcolor",e)):(o(t),n.execCommand("mceApplyTextcolor",e,t))},mh=function(t,n){return t.concat(F(ih.state(),function(t){return{type:oh,text:t,value:t}}).concat((t={type:e="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[t,{type:e,text:"Custom color",icon:"color-picker",value:"custom"}]:[t])));var e},gh=function(n,e){return function(t){t(mh(n,e))}},ph=function(t,n,e){t.setIconFill("forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",e)},hh=function(r,e,i,t,o){r.ui.registry.addSplitButton(e,{tooltip:t,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(n){var e,o;return tt.from((e=i,r.dom.getParents(r.selection.getStart(),function(t){(t=t.style["forecolor"===e?"color":"background-color"])&&(o=o||t)}),o)).bind(function(t){return function(t){if("transparent"===t)return tt.some(Xp(0,0,0,0));var n=Wp.exec(t);if(null!==n)return tt.some(Jp(n[1],n[2],n[3],"1"));t=Gp.exec(t);return null!==t?tt.some(Jp(t[1],t[2],t[3],t[4])):tt.none()}(t).map(function(t){t=Np(t).value;return ve(n.toLowerCase(),t)})}).getOr(!1)},columns:fh(r),fetch:gh(ch(r),ah(r)),onAction:function(t){null!==o.get()&&dh(r,i,o.get(),Q)},onItemAction:function(t,n){dh(r,i,n,function(t){o.set(t),t={name:e,color:t},r.fire("TextColorChange",t)})},onSetup:function(n){null!==o.get()&&ph(n,e,o.get());var t=function(t){t.name===e&&ph(n,t.name,t.color)};return r.on("TextColorChange",t),function(){r.off("TextColorChange",t)}}})},vh=function(n,t,e,o){n.ui.registry.addNestedMenuItem(t,{text:o,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){dh(n,e,t.value,Q)}}]}})},bh=function(r){return function(e,t){var o=!1;r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:t},onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(t){var n=t.getData().colorpicker;o?(e(tt.from(n)),t.close()):r.windowManager.alert(r.translate(["Invalid hex color code: {0}",n]))},onClose:Q,onCancel:function(){e(tt.none())}})}},yh=function(t,n,e,o,r,i,u,a){var c=og(n),a=xh(n,e,o,"color"!==r?"normal":"color",i,u,a);return ug(t,c,a,o,r)},xh=function(e,o,r,i,u,a,c){return ql(F(e,function(n){return"choiceitem"===n.type?Sn("choicemenuitem",fg,n).fold(rg,function(t){return tt.some(function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);a=Dp({presets:e,textContent:t?n.text:tt.none(),htmlContent:tt.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:tt.none(),checkMark:t?tt.some(Op(u.icons)):tt.none(),caret:tt.none(),value:n.value},u,a);return Rt(vp({data:bp(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){Od.set(n,t)},isActive:function(){return Od.isOn(n)},isDisabled:function(){return Vg.isDisabled(n)},setDisabled:function(t){return Vg.set(n,t)}}},onAction:function(t){return o(n.value)},onSetup:function(t){return t.setActive(r),Q},triggersSubmenu:!1,itemBehaviours:[]},a,i,u),{toggling:{toggleClass:Um,toggleOnExecute:!1,selected:n.active}})}(t,1===r,i,o,a(n.value),u,c,og(e)))}):tt.none()}))},wh=function(t,n){var e=$m(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},Sh=Qr("cell-over"),kh=Qr("cell-execute"),Ch=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(n,e,t){var o,r=function(t){return Uo(t,kh,{row:n,col:e})},i=function(t,n){n.stop(),r(t)};return su({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=t,o)},behaviours:Ka([gd("insert-table-picker-cell",[$o(ro(),hd.focus),$o(wo(),r),$o(fo(),i),$o(ko(),i)]),Od.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),hd.config({onFocus:function(t){return Uo(t,Sh,{row:n,col:e})}})])})}(r,u,t));o.push(i)}return o},Oh={inserttable:function(o){var t=Qr("size-label"),r=Ch(t,10,10),i=om({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[uu("0x0")],behaviours:Ka([md.config({})])});return{type:"widget",data:{value:Qr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Fp.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:N(r,function(t){return F(t,lu)}).concat(i.asSpec()),behaviours:Ka([gd("insert-table-picker",[nr(Sh,function(t,n,e){var o=e.event.row,e=e.event.col;!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Od.set(t[i][u],i<=n&&u<=e)}(r,o,e,10,10),md.set(i.get(t),[uu(e+1+"x"+(o+1))])}),nr(kh,function(t,n,e){o.onAction({numRows:e.event.row+1,numColumns:e.event.col+1}),jo(t,Oo())})]),cd.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=mh(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),t=yh(Qr("menu-value"),e,function(t){n.onAction({value:t})},o,"color",Hm.CLOSE_ON_EXECUTE,l,t.shared.providers),o=Z(Z({},t),{markers:$m("color"),movement:wh(o,"color")});return{type:"widget",data:{value:Qr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Fp.widget(Hd.sketch(o))]}}},_h=function(n,e,t,o,r,i,u,a){void 0===a&&(a=!0);a=Dp({presets:o,textContent:tt.none(),htmlContent:t?n.text.map(function(t){return Ap(t,e)}):tt.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:tt.none(),checkMark:tt.none(),caret:tt.none(),value:n.value},u.providers,a,n.icon);return vp({data:bp(n),disabled:n.disabled,getApi:W({}),onAction:function(t){return r(n.value,n.meta)},onSetup:W(Q),triggersSubmenu:!1,itemBehaviours:Bp(n.meta,u)},a,i,u.providers)},Th=function(t){t=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:Z({tag:"div",classes:[Nm,"tox-collection__group-heading"]},t),components:[]}},Eh=function(t,n,e,o){void 0===o&&(o=!0);o=Dp({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:tt.none(),ariaLabel:t.text,caret:tt.none(),checkMark:tt.none(),shortcutContent:t.shortcut},e,o);return vp({data:bp(t),getApi:function(n){return{isDisabled:function(){return Vg.isDisabled(n)},setDisabled:function(t){return Vg.set(n,t)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n,e)},Dh=function(t,n,e,o,r){void 0===o&&(o=!0);var i,i=(r=void 0===r?!1:r)?(r=e.icons,{dom:{tag:"div",classes:[Gm],innerHtml:im("chevron-down",r)}}):(i=e.icons,{dom:{tag:"div",classes:[Gm],innerHtml:im("chevron-right",i)}}),o=Dp({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:tt.none(),ariaLabel:t.text,caret:tt.some(i),checkMark:tt.none(),shortcutContent:t.shortcut},e,o);return vp({data:bp(t),getApi:function(n){return{isDisabled:function(){return Vg.isDisabled(n)},setDisabled:function(t){return Vg.set(n,t)}}},disabled:t.disabled,onAction:Q,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},o,n,e)},Bh=function(t,n,e,o){void 0===o&&(o=!0);o=Dp({iconContent:t.icon,textContent:t.text,htmlContent:tt.none(),ariaLabel:t.text,checkMark:tt.some(Op(e.icons)),caret:tt.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Rt(vp({data:bp(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){Od.set(n,t)},isActive:function(){return Od.isOn(n)},isDisabled:function(){return Vg.isDisabled(n)},setDisabled:function(t){return Vg.set(n,t)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n,e),{toggling:{toggleClass:Um,toggleOnExecute:!1,selected:t.active}})},Ah=function(n,e){return t=Oh,o=n.fancytype,(Object.prototype.hasOwnProperty.call(t,o)?tt.some(t[o]):tt.none()).map(function(t){return t(n,e)});var t,o},Mh=function(t,n,e,o){var r={dom:_p(!1,t.label),optComponents:[tt.some({dom:{tag:"div",classes:[Ym,qm]},components:Mp(t.items,o)})]};return vp({data:bp(Z({text:tt.none()},t)),disabled:t.disabled,getApi:function(e){return{isDisabled:function(){return Vg.isDisabled(e)},setDisabled:function(n){Vg.set(e,n),nt(as(e.element,"*"),function(t){e.getSystem().getByDom(t).each(function(t){t.hasConfigured(Vg)&&Vg.set(t,n)})})}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:tt.from(o.itemBehaviours).getOr([])},r,n,e.providers)};(Ke=eh=eh||{})[Ke.ContentFocus=0]="ContentFocus",Ke[Ke.UiFocus=1]="UiFocus";var Fh,Ih,Rh,Vh,Ph=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?Z(Z({},t),{shortcut:tt.none(),icon:t.text.isSome()?tt.none():t.icon}):t};switch(t.type){case"menuitem":return Sn("menuitem",mg,t).fold(rg,function(t){return tt.some(Eh(u(t),n,i,o))});case"nestedmenuitem":return Sn("nestedmenuitem",gg,t).fold(rg,function(t){return tt.some(Dh(u(t),n,i,o,r))});case"togglemenuitem":return Sn("togglemenuitem",pg,t).fold(rg,function(t){return tt.some(Bh(u(t),n,i,o))});case"separator":return Sn("separatormenuitem",Tm,t).fold(rg,function(t){return tt.some(Th(t))});case"fancymenuitem":return Sn("fancymenuitem",dg,t).fold(rg,function(t){return Ah(u(t),e)});default:return console.error("Unknown item in general menu",t),tt.none()}},Hh=function(t,e,o,n,r,i,u){var a=1===n,c=!a||og(t);return ql(F(t,function(t){switch(t.type){case"separator":return Sn("Autocompleter.Separator",Tm,t).fold(rg,function(t){return tt.some(Th(t))});case"cardmenuitem":return Sn("cardmenuitem",lg,t).fold(rg,function(n){return tt.some(Mh(Z(Z({},n),{onAction:function(t){n.onAction(t),o(n.value,n.meta)}}),r,i,{itemBehaviours:Bp(n.meta,i),cardText:{matchText:e,highlightOn:u}}))});case"autocompleteitem":default:return Sn("Autocompleter.Item",Em,t).fold(rg,function(t){return tt.some(_h(t,e,a,"normal",o,r,i,c))})}}))},zh=function(t,n,e,o,r){var i=og(n),n=ql(F(n,function(t){var n=function(t){return Ph(t,e,o,(t=t,r?!t.hasOwnProperty("text"):i),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(Z(Z({},t),{disabled:!0})):n(t)}));return(r?ig:ug)(t,i,n,1,"normal")},Nh=function(t){return Wd.singleData(t.value,t)},Lh=function(a,c){var e=ae(tt.none()),s=ae(!1),l=su(Gd.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Ka([gd("dismissAutocompleter",[$o(Io(),function(){return d()})])]),lazySink:c.getSink})),o=function(){return e.get().isSome()},f=function(){o()&&Gd.hide(l)},d=function(){var t;o()&&(t=e.get().map(function(t){return t.element}),mm(t.getOr(se.fromDom(a.selection.getNode()))).each(Hr),f(),e.set(tt.none()),s.set(!1))},r=Pt(function(){return Vm(a)}),m=function(t,n,e,o){t.matchLength=n.text.length;var r,i,u=J(e,function(t){return tt.from(t.columns)}).getOr(1);Gd.showAt(l,{anchor:"node",root:se.fromDom(a.getBody()),node:tt.from(t.element)},Hd.sketch((r=ug("autocompleter-value",!0,o,u,"normal"),n=u,e=eh.ContentFocus,t="normal",o=(e===eh.ContentFocus?Df:Ef)(),u=wh(n,t),i=$m(t),{dom:r.dom,components:r.components,items:r.items,value:r.value,markers:{selectedItem:i.selectedItem,item:i.item},movement:u,fakeFocus:e===eh.ContentFocus,focusManager:o,menuBehaviours:bg("auto"!==n?[]:[rr(function(e,t){hg(e,4,i.item).each(function(t){var n=t.numColumns,t=t.numRows;cd.setGridSize(e,t,n)})})])}))),Gd.getContent(l).each(af.highlightFirst)},g=function(t){var n;n=t,e.get().map(function(t){return bm(a.dom,a.selection.getRng(),t.triggerChar).bind(function(t){return _m(a,r,t,n)})}).getOrThunk(function(){return Om(a,r)}).fold(d,function(u){var t,n;t=u.context,o()||(n=dm(a,t.range),e.set(tt.some({triggerChar:t.triggerChar,element:n,matchLength:t.text.length})),s.set(!1)),u.lookupData.then(function(i){e.get().map(function(t){var n,e,o,r=u.context;t.triggerChar===r.triggerChar&&(n=r.triggerChar,o=J(e=i,function(t){return tt.from(t.columns)}).getOr(1),0<(e=N(e,function(r){var t=r.items;return Hh(t,r.matchText,function(e,o){var t=a.selection.getRng();bm(a.dom,t,n).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var n=t.range,t={hide:function(){d()},reload:function(t){f(),g(t)}};s.set(!0),r.onAction(t,n,e,o),s.set(!1)})},o,Hm.BUBBLE_TO_SANDBOX,c,r.highlightOn)})).length?m(t,r,i,e):(10<=r.text.length-t.matchLength?d:f)())})})})},t={onKeypress:sm(function(t){27!==t.which&&g()},50),cancelIfNecessary:d,isMenuOpen:function(){return Gd.isOpen(l)},isActive:o,isProcessingAction:s.get,getView:function(){return Gd.getContent(l)}};!1===a.hasPlugin("rtc")&&ym(t,a)},jh=S,Uh=function(t,n,e){return Cu(t,n,jh,e,!1)},Wh=function(t,n,e){return Cu(t,n,jh,e,!0)},Gh=ku,Xh=function(t,n,e){return Wu(t,n,e).isSome()},Yh=function(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r=setTimeout(function(){e.apply(null,t),r=null},o)}}},qh=function(t){t=t.raw;return t.touches===undefined||1!==t.touches.length?tt.none():tt.some(t.touches[0])},Kh=function(e){var r=ae(tt.none()),o=ae(!1),i=Yh(function(t){e.triggerEvent(Co(),t),o.set(!0)},400),u=Yt([{key:Je(),value:function(n){return qh(n).each(function(t){i.cancel();t={x:t.clientX,y:t.clientY,target:n.target};i.schedule(n),o.set(!1),r.set(tt.some(t))}),tt.none()}},{key:$e(),value:function(t){return i.cancel(),qh(t).each(function(o){r.get().each(function(t){var n,e;n=o,e=t,t=Math.abs(n.clientX-e.x),e=Math.abs(n.clientY-e.y),(5<t||5<e)&&r.set(tt.none())})}),tt.none()}},{key:Qe(),value:function(n){i.cancel();return r.get().filter(function(t){return Ne(t.target,n.target)}).map(function(t){return o.get()?(n.prevent(),!1):e.triggerEvent(ko(),n)})}}]);return{fireIfReady:function(n,t){return Dt(u,t).bind(function(t){return t(n)})}}},Jh=function(){return Pe().browser.isFirefox()},$h=un([Ln("triggerEvent"),$n("stopBackspace",!0)]),Qh=function(n,t){var e,o=Cn("Getting GUI events settings",$h,t),r=Kh(o),i=F(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return Uh(n,t,function(n){r.fireIfReady(n,t).each(function(t){t&&n.kill()}),o.triggerEvent(t,n)&&n.kill()})}),u=ae(tt.none()),a=Uh(n,"paste",function(n){r.fireIfReady(n,"paste").each(function(t){t&&n.kill()}),o.triggerEvent("paste",n)&&n.kill(),u.set(tt.some(setTimeout(function(){o.triggerEvent(yo(),n)},0)))}),c=Uh(n,"keydown",function(t){var n;o.triggerEvent("keydown",t)?t.kill():!0!==o.stopBackspace||((n=t).raw.which!==cf[0]||D(["input","textarea"],cr(n.target))||Xh(n.target,'[contenteditable="true"]'))||t.prevent()}),s=(e=n,t=function(t){o.triggerEvent("focusin",t)&&t.kill()},Jh()?Wh(e,"focus",t):Uh(e,"focusin",t)),l=ae(tt.none()),f=(e=n,t=function(t){o.triggerEvent("focusout",t)&&t.kill(),l.set(tt.some(setTimeout(function(){o.triggerEvent(bo(),t)},0)))},Jh()?Wh(e,"blur",t):Uh(e,"focusout",t));return{unbind:function(){nt(i,function(t){t.unbind()}),c.unbind(),s.unbind(),f.unbind(),a.unbind(),u.get().each(clearTimeout),l.get().each(clearTimeout)}}},Zh=function(t,n){n=Dt(t,"target").getOr(n);return ae(n)},tv=Mt([{stopped:[]},{resume:["element"]},{complete:[]}]),nv=function(t,o,n,e,r,i){var u,a,t=t(o,e),c=(u=ae(!1),a=ae(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:n,setSource:r.set,getSource:r.get});return t.fold(function(){return i.logEventNoHandlers(o,e),tv.complete()},function(n){var e=n.descHandler;return yi(e)(c),c.isStopped()?(i.logEventStopped(o,n.element,e.purpose),tv.stopped()):c.isCut()?(i.logEventCut(o,n.element,e.purpose),tv.complete()):br(n.element).fold(function(){return i.logNoParent(o,n.element,e.purpose),tv.complete()},function(t){return i.logEventResponse(o,n.element,e.purpose),tv.resume(t)})})},ev=function(n,e,o,t,r,i){return nv(n,e,o,t,r,i).fold(S,function(t){return ev(n,e,o,t,r,i)},l)},ov=function(t,n,e){var o,r=(o=ae(!1),{stop:function(){o.set(!0)},cut:Q,isStopped:o.get,isCut:l,event:n,setSource:s("Cannot set source of a broadcasted event"),getSource:s("Cannot get source of a broadcasted event")});return nt(t,function(t){t=t.descHandler;yi(t)(r)}),r.isStopped()},rv=function(t,n,e,o,r){var i=Zh(e,o);return ev(t,n,e,o,i,r)},iv=function(){var i={};return{registerId:function(o,r,t){St(t,function(t,n){var e=i[n]!==undefined?i[n]:{};e[r]=(t=t,{cHandler:m.apply(undefined,[t.handler].concat(o)),purpose:t.purpose}),i[n]=e})},unregisterId:function(e){St(i,function(t,n){t.hasOwnProperty(e)&&delete t[e]})},filterByType:function(t){return Dt(i,t).map(function(t){return _t(t,function(t,n){return{id:n,descHandler:t}})}).getOr([])},find:function(t,n,e){var r=Dt(i,n);return Ge(e,function(t){return e=r,ri(o=t).fold(function(){return tt.none()},function(n){return e.bind(function(t){return Dt(t,n)}).map(function(t){return{element:o,descHandler:t}})});var e,o},t)}}},uv=function(){var o=iv(),r={},e=function(t){var n=t.element;return ri(n).fold(function(){return function(t,n){t=Qr(ni+t);return oi(n,t),t}("uid-",t.element)},function(t){return t})},i=function(t){ri(t.element).each(function(t){delete r[t],o.unregisterId(t)})};return{find:function(t,n,e){return o.find(t,n,e)},filter:function(t){return o.filterByType(t)},register:function(t){var n=e(t);At(r,n)&&function(t,n){var e=r[n];if(e!==t)throw new Error('The tagId "'+n+'" is already used by: '+qr(e.element)+"\nCannot use it for: "+qr(t.element)+"\nThe conflicting element is"+(Hi(e.element)?" ":" not ")+"already in the DOM");i(t)}(t,n),o.registerId([t],n,t.events),r[n]=t},unregister:i,getById:function(t){return Dt(r,t)}}},av=Yl({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,n=d(n,["attributes"]);return{uid:t.uid,dom:Z({tag:"div",attributes:Z({role:"presentation"},e)},n),components:t.components,behaviours:cl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[$n("components",[]),po("containerBehaviours",[]),$n("events",{}),$n("domModification",{}),$n("eventOrder",{})]}),cv=function(e){var o=function(n){return br(e.element).fold(S,function(t){return Ne(n,t)})},r=uv(),c=function(t,n){return r.find(o,t,n)},t=Qh(e.element,{triggerEvent:function(n,e){return Qu(n,e.target,function(t){return rv(c,n,e,e.target,t)})}}),i={debugInfo:W("real"),triggerEvent:function(n,e,o){Qu(n,e,function(t){return rv(c,n,o,e,t)})},triggerFocus:function(u,a){ri(u).fold(function(){ec(u)},function(t){Qu(vo(),u,function(t){var n,e,o,r,i;return n=c,e=vo(),i=t,t=Zh(o={originator:a,kill:Q,prevent:Q,target:u},r=u),nv(n,e,o,r,t,i),!1})})},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return g(t)},getByDom:function(t){return p(t)},build:su,addToGui:function(t){a(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){n(t)},removeFromWorld:function(t){u(t)},broadcast:function(t){f(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:S},n=function(t){t.connect(i),fr(t.element)||(r.register(t),nt(t.components(),n),i.triggerEvent(To(),t.element,{target:t.element}))},u=function(t){fr(t.element)||(nt(t.components(),u),r.unregister(t)),t.disconnect()},a=function(t){Rs(e,t)},s=function(t){Hs(t)},l=function(n){var t=r.filter(xo());nt(t,function(t){t=t.descHandler;yi(t)(n)})},f=function(t){l({universal:!0,data:t})},d=function(t,n){l({universal:!1,channels:t,data:n})},m=function(t,n){t=r.filter(t);return ov(t,n)},g=function(t){return r.getById(t).fold(function(){return it.error(new Error('Could not find component with uid: "'+t+'" in system.'))},it.value)},p=function(t){t=ri(t).getOr("not found");return g(t)};return n(e),{root:e,element:e.element,destroy:function(){t.unbind(),Pr(e.element)},add:a,remove:s,getByUid:g,getByDom:p,addToWorld:n,removeFromWorld:u,broadcast:f,broadcastOn:d,broadcastEvent:m}},Ro=W([$n("prefix","form-field"),po("fieldBehaviours",[$l,al])]),Ua=W([Cl({schema:[Pn("dom")],name:"label"}),Cl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Pn("text")],name:"aria-descriptor"}),kl({factory:{sketch:function(t){var n=Gt(t,["factory"]);return t.factory.sketch(n)}},schema:[Pn("factory")],name:"field"})]),sv=il({name:"FormField",configFields:Ro(),partFields:Ua(),factory:function(r,t,n,e){var o=sl(r.fieldBehaviours,[$l.config({find:function(t){return Il(t,r,"field")}}),al.config({store:{mode:"manual",getValue:function(t){return $l.getCurrent(t).bind(al.getValue)},setValue:function(t,n){$l.getCurrent(t).each(function(t){al.setValue(t,n)})}}})]),i=qo([rr(function(t,n){var o=Vl(t,r,["label","field","aria-descriptor"]);o.field().each(function(e){var n=Qr(r.prefix);o.label().each(function(t){jr(t.element,"for",n),jr(e.element,"id",n)}),o["aria-descriptor"]().each(function(t){var n=Qr(r.prefix);jr(t.element,"id",n),jr(e.element,"aria-describedby",n)})})})]);return{uid:r.uid,dom:r.dom,components:t,behaviours:o,events:i,apis:{getField:function(t){return Il(t,r,"field")},getLabel:function(t){return Il(t,r,"label")}}}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),fu=Object.freeze({__proto__:null,exhibit:function(t,n){return vi({attributes:Yt([{key:n.tabAttr,value:"true"}])})}}),nc=[$n("tabAttr","data-alloy-tabstop")],lv=$a({fields:nc,name:"tabstopping",active:fu}),fv=tinymce.util.Tools.resolve("tinymce.html.Entities"),dv=function(t,n,e,o){o=mv(t,n,e,o);return sv.sketch(o)},mv=function(t,n,e,o){return{dom:gv(e),components:t.toArray().concat([n]),fieldBehaviours:Ka(o)}},gv=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},pv=function(t,n){return sv.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},hv=Qr("form-component-change"),vv=Qr("form-close"),bv=Qr("form-cancel"),yv=Qr("form-action"),xv=Qr("form-submit"),wv=Qr("form-block"),Sv=Qr("form-unblock"),kv=Qr("form-tabchange"),Cv=Qr("form-resize"),Ov=function(i,u){var t=i.label.map(function(t){return pv(t,u)}),n=function(o){return function(n,e){Wu(e.event.target,"[data-collection-item-value]").each(function(t){o(n,e,t,Ur(t,"data-collection-item-value"))})}},e=n(function(t,n,e,o){n.stop(),u.isDisabled()||Uo(t,yv,{name:i.name,value:o})}),o=[$o(ro(),n(function(t,n,e){ec(e)})),$o(fo(),e),$o(ko(),e),$o(io(),n(function(t,n,e){Uu(t.element,"."+Xm).each(function(t){Fi(t,Xm)}),Ai(e,Xm)})),$o(uo(),n(function(t){Uu(t.element,"."+Xm).each(function(t){Fi(t,Xm)})})),ar(n(function(t,n,e,o){Uo(t,yv,{name:i.name,value:o})}))],r=function(t,n){return F(as(t.element,".tox-collection__item"),n)},o=sv.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==i.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:Ka([Vg.config({disabled:u.isDisabled,onDisabled:function(t){r(t,function(t){Ai(t,"tox-collection__item--state-disabled"),jr(t,"aria-disabled",!0)})},onEnabled:function(t){r(t,function(t){Fi(t,"tox-collection__item--state-disabled"),Xr(t,"aria-disabled")})}}),ap(),md.config({}),al.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,t){!function(t,n){n=F(n,function(t){var n=Og.translate(t.text),e=1===i.columns?'<div class="tox-collection__item-label">'+n+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",r={_:" "," - ":" ","-":" "},n=n.replace(/\_| \- |\-/g,function(t){return r[t]});return'<div class="tox-collection__item'+(u.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+fv.encodeAllRaw(t.value)+'" title="'+n+'" aria-label="'+n+'">'+o+e+"</div>"}),n="auto"!==i.columns&&1<i.columns?M(n,i.columns):[n],n=F(n,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});Nr(t.element,n.join(""))}(e,t),"auto"===i.columns&&hg(e,5,"tox-collection__item").each(function(t){var n=t.numRows,t=t.numColumns;cd.setGridSize(e,n,t)}),jo(e,Cv)}}),lv.config({}),cd.config((e=i.columns,n="normal",1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===n?".tox-swatches__row":".tox-collection__group",cell:"color"===n?"."+Lm:"."+Nm}})),gd("collection-events",o)]),eventOrder:((o={})[wo()]=["disabling","alloy.base.behaviour","collection-events"],o)});return dv(t,o,["tox-form__group--collection"],[])},ma=W([Gn("data"),$n("inputAttributes",{}),$n("inputStyles",{}),$n("tag","input"),$n("inputClasses",[]),aa("onSetValue"),$n("styles",{}),$n("eventOrder",{}),po("inputBehaviours",[al,hd]),$n("selectOnFocus",!0)]),_v=function(t){return Ka([hd.config({onFocus:t.selectOnFocus?function(t){var n=t.element,t=Qi(n);n.dom.setSelectionRange(0,t.length)}:Q})])},Tv=function(t){return{tag:t.tag,attributes:Z({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},Ev=Yl({name:"Input",configFields:ma(),factory:function(t,n){return{uid:t.uid,dom:Tv(t),components:[],behaviours:Z(Z({},_v(e=t)),sl(e.inputBehaviours,[al.config({store:Z(Z({mode:"manual"},e.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return Qi(t.element)},setValue:function(t,n){Qi(t.element)!==n&&Zi(t.element,n)}}),onSetValue:e.onSetValue})])),eventOrder:t.eventOrder};var e}}),ke={},ja={exports:ke};Fh=undefined,Ih=ke,Rh=ja,Vh=undefined,function(t){"object"==typeof Ih&&void 0!==Rh?Rh.exports=t():"function"==typeof Fh&&Fh.amd?Fh([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}(function(){return function c(o,r,i){function u(n,t){if(!r[n]){if(!o[n]){var e="function"==typeof Vh&&Vh;if(!t&&e)return e(n,!0);if(a)return a(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}e=r[n]={exports:{}},o[n][0].call(e.exports,function(t){return u(o[n][1][t]||t)},e,e.exports,c,o,r,i)}return r[n].exports}for(var a="function"==typeof Vh&&Vh,t=0;t<i.length;t++)u(i[t]);return u}({1:[function(t,n,e){var o,r,n=n.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(o===setTimeout)return setTimeout(t,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(t){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&m())}function m(){if(!l){var t=a(d);l=!0;for(var n=s.length;n;){for(c=s,s=[];++f<n;)c&&c[f].run();f=-1,n=s.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function g(t,n){this.fun=t,this.array=n}function p(){}n.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];s.push(new g(t,n)),1!==s.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(t,f,n){!function(n){function o(){}function u(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],l(t,this)}function r(o,r){for(;3===o._state;)o=o._value;0!==o._state?(o._handled=!0,u._immediateFn(function(){var t,n=1===o._state?r.onFulfilled:r.onRejected;if(null!==n){try{t=n(o._value)}catch(e){return void a(r.promise,e)}i(r.promise,t)}else(1===o._state?i:a)(r.promise,o._value)})):o._deferreds.push(r)}function i(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof u)return t._state=3,t._value=n,void c(t);if("function"==typeof e)return void l((o=e,r=n,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=n,c(t)}catch(i){a(t,i)}var o,r}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&u._immediateFn(function(){t._handled||u._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t(function(t){e||(e=!0,i(n,t))},function(t){e||(e=!0,a(n,t))})}catch(o){if(e)return;e=!0,a(n,o)}}var t,e;t=this,e=setTimeout,u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,n){var e=new this.constructor(o);return r(this,new s(t,n,e)),e},u.all=function(t){var c=Array.prototype.slice.call(t);return new u(function(r,i){if(0===c.length)return r([]);var u=c.length;function a(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){a(n,t)},i)}c[n]=t,0==--u&&r(c)}catch(o){i(o)}}for(var t=0;t<c.length;t++)a(t,c[t])})},u.resolve=function(n){return n&&"object"==typeof n&&n.constructor===u?n:new u(function(t){t(n)})},u.reject=function(e){return new u(function(t,n){n(e)})},u.race=function(r){return new u(function(t,n){for(var e=0,o=r.length;e<o;e++)r[e].then(t,n)})},u._immediateFn="function"==typeof n?function(t){n(t)}:function(t){e(t,0)},u._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},void 0!==f&&f.exports?f.exports=u:t.Promise||(t.Promise=u)}.call(this,t("timers").setImmediate)},{timers:3}],3:[function(c,t,s){!function(t,n){var o=c("process/browser.js").nextTick,e=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(t,n){this._id=t,this._clearFn=n}s.setTimeout=function(){return new a(e.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(e.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},s.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},s._unrefActive=s.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},s.setImmediate="function"==typeof t?t:function(t){var n=u++,e=!(arguments.length<2)&&r.call(arguments,1);return i[n]=!0,o(function(){i[n]&&(e?t.apply(null,e):t.call(null),s.clearImmediate(n))}),n},s.clearImmediate="function"==typeof n?n:function(t){delete i[t]}}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),t="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:t.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});var Dv,Bv=ja.exports.boltExport,Av=function(t){var e=tt.none(),n=[],o=function(t){r()?u(t):n.push(t)},r=function(){return e.isSome()},i=function(t){nt(t,u)},u=function(n){e.each(function(t){setTimeout(function(){n(t)},0)})};return t(function(t){r()||(e=tt.some(t),i(n),n=[])}),{get:o,map:function(e){return Av(function(n){o(function(t){n(e(t))})})},isReady:r}},Mv={nu:Av,pure:function(n){return Av(function(t){t(n)})}},Fv=function(t){setTimeout(function(){throw t},0)},Iv=function(e){var t=function(t){e().then(t,Fv)};return{map:function(t){return Iv(function(){return e().then(t)})},bind:function(n){return Iv(function(){return e().then(function(t){return n(t).toPromise()})})},anonBind:function(t){return Iv(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return Mv.nu(t)},toCached:function(){var t=null;return Iv(function(){return t=null===t?e():t})},toPromise:e,get:t}},Rv=function(t){return Iv(function(){return new Bv(t)})},Vv=function(t){return Iv(function(){return Bv.resolve(t)})},Pv=["input","textarea"],Hv=function(t){t=cr(t);return D(Pv,t)},zv=function(t,n){var e=n.getRoot(t).getOr(t.element);Fi(e,n.invalidClass),n.notify.each(function(n){Hv(t.element)&&jr(t.element,"aria-invalid",!1),n.getContainer(t).each(function(t){Nr(t,n.validHtml)}),n.onValid(t)})},Nv=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element);Ai(r,t.invalidClass),t.notify.each(function(t){Hv(n.element)&&jr(n.element,"aria-invalid",!0),t.getContainer(n).each(function(t){Nr(t,o)}),t.onInvalid(n,o)})},Lv=function(n,t,e){return t.validator.fold(function(){return Vv(it.value(!0))},function(t){return t.validate(n)})},jv=function(n,e,t){return e.notify.each(function(t){t.onValidate(n)}),Lv(n,e).map(function(t){return n.getSystem().isConnected()?t.fold(function(t){return Nv(n,e,0,t),it.error(t)},function(t){return zv(n,e),it.value(t)}):it.error("No longer in system")})},e=Object.freeze({__proto__:null,markValid:zv,markInvalid:Nv,query:Lv,run:jv,isInvalid:function(t,n){t=n.getRoot(t).getOr(t.element);return Ii(t,n.invalidClass)}}),Uv=Object.freeze({__proto__:null,events:function(n,t){return n.validator.map(function(t){return qo([$o(t.onEvent,function(t){jv(t,n).get(w)})].concat(t.validateOnLoad?[rr(function(t){jv(t,n).get(Q)})]:[]))}).getOr({})}}),Cr=[Pn("invalidClass"),$n("getRoot",tt.none),Jn("notify",[$n("aria","alert"),$n("getContainer",tt.none),$n("validHtml",""),aa("onValid"),aa("onInvalid"),aa("onValidate")]),Jn("validator",[Pn("validate"),$n("onEvent","input"),$n("validateOnLoad",!0)])],Wv=$a({fields:Cr,name:"invalidating",active:Uv,apis:e,extra:{validation:function(n){return function(t){t=al.getValue(t);return Vv(n(t))}}}}),Ke=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Ro=[Hn("others",wn(it.value,En()))],Gv=$a({fields:Ro,name:"coupling",apis:Ke,state:Object.freeze({__proto__:null,init:function(){var r={},t=W({});return pi({readState:t,getOrCreate:function(n,e,o){var t=xt(e.others);if(t)return Dt(r,o).getOrThunk(function(){var t=Dt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),t=n.getSystem().build(t);return r[o]=t});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(t,null,2))}})}})}),Xv=W("sink"),Ua=W(Cl({name:Xv(),overrides:W({dom:{tag:"div"},behaviours:Ka([Bs.config({useFixed:S})]),events:qo([er(ao()),er(to()),er(fo())])})}));(nc=Dv=Dv||{})[nc.HighlightFirst=0]="HighlightFirst",nc[nc.HighlightNone=1]="HighlightNone";var Yv,qv,Kv,Jv,$v,Qv,Zv=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e,overrides:o}},function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}})},tb=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m=Zv(t,e);return(a=m,c=e,s=o,l=r,f=u,n=n=n,n=(0,(t=t).fetch)(c).map(n),d=rb(c,t),n.map(function(t){return t.bind(function(t){return tt.from(Wd.sketch(Z(Z({},l.menu()),{uid:ii(""),data:t,highlightImmediately:f===Dv.HighlightFirst,onOpenMenu:function(t,n){var e=d().getOrDie();Bs.position(e,a,n),Ks.decloak(s)},onOpenSubmenu:function(t,n,e){var o=d().getOrDie();Bs.position(o,{anchor:"submenu",item:n},e),Ks.decloak(s)},onRepositionMenu:function(t,n,e){var o=d().getOrDie();Bs.position(o,a,n),nt(e,function(t){Bs.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)})},onEscape:function(){return hd.focus(c),Ks.close(s),tt.some(!0)}})))})})).map(function(t){return t.fold(function(){Ks.isOpen(o)&&Ks.close(o)},function(t){Ks.cloak(o),Ks.open(o,t),i(o)}),o})},nb=function(t,n,e,o,r,i,u){return Ks.close(o),Vv(o)},eb=function(t,n,e,o,r,i){var u=Gv.getCoupled(e,"sandbox");return(Ks.isOpen(u)?nb:tb)(t,n,e,u,o,r,i)},ob=function(t,n,e){n=$l.getCurrent(n).getOr(n),t=wu(t.element);e?Ui(n.element,"min-width",t+"px"):(n=n.element,xu.set(n,t))},rb=function(n,t){return n.getSystem().getByUid(t.uid+"-"+Xv()).map(function(t){return function(){return it.value(t)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return it.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(n)}})})},ib=function(t){Ks.getState(t).each(function(t){Wd.repositionMenus(t)})},ub=function(o,r,i){var u=Gu(),t=rb(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:u.id,role:"listbox"}},behaviours:fl(o.sandboxBehaviours,[al.config({store:{mode:"memory",initialValue:r}}),Ks.config({onOpen:function(t,n){var e=Zv(o,r);u.link(r.element),o.matchWidth&&ob(e.hotspot,n,o.useMinWidth),o.onOpen(e,t,n),i!==undefined&&i.onOpen!==undefined&&i.onOpen(t,n)},onClose:function(t,n){u.unlink(r.element),i!==undefined&&i.onClose!==undefined&&i.onClose(t,n)},isPartOf:function(t,n,e){return Yu(n,e)||Yu(r,e)},getAttachPoint:function(){return t().getOrDie()}}),$l.config({find:function(t){return Ks.getState(t).bind(function(t){return $l.getCurrent(t)})}}),tc.config({channels:Z(Z({},tl({isExtraPart:l})),el({doReposition:ib}))})])}},ab=function(t){t=Gv.getCoupled(t,"sandbox");ib(t)},fu=function(){return[$n("sandboxClasses",[]),ll("sandboxBehaviours",[$l,tc,Ks,al])]},ke=W([Pn("dom"),Pn("fetch"),aa("onOpen"),ca("onExecute"),$n("getHotspot",tt.some),$n("getAnchorOverrides",W({})),xe(),po("dropdownBehaviours",[Od,Gv,cd,hd]),Pn("toggleClass"),$n("eventOrder",{}),Gn("lazySink"),$n("matchWidth",!1),$n("useMinWidth",!1),Gn("role")].concat(fu())),ja=W([Dn({schema:[ra()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Ua()]),cb=il({name:"Dropdown",configFields:ke(),partFields:ja(),factory:function(n,t,e,o){var r,i=function(t){Ks.getState(t).each(function(t){Wd.highlightPrimary(t)})},u={expand:function(t){Od.isOn(t)||eb(n,function(t){return t},t,o,Q,Dv.HighlightNone).get(Q)},open:function(t){Od.isOn(t)||eb(n,function(t){return t},t,o,Q,Dv.HighlightFirst).get(Q)},isOpen:Od.isOn,close:function(t){Od.isOn(t)&&eb(n,function(t){return t},t,o,Q,Dv.HighlightFirst).get(Q)},repositionMenus:function(t){Od.isOn(t)&&ab(t)}},a=function(t,n){return Wo(t),tt.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:sl(n.dropdownBehaviours,[Od.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),Gv.config({others:{sandbox:function(t){return ub(n,t,{onOpen:function(){return Od.on(t)},onClose:function(){return Od.off(t)}})}}}),cd.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t,n){var e;return cb.isOpen(t)?(e=Gv.getCoupled(t,"sandbox"),i(e)):cb.open(t),tt.some(!0)},onEscape:function(t,n){return cb.isOpen(t)?(cb.close(t),tt.some(!0)):tt.none()}}),hd.config({})]),events:Td(tt.some(function(t){eb(n,function(t){return t},t,o,i,Dv.HighlightFirst).get(Q)})),eventOrder:Z(Z({},n.eventOrder),((a={})[wo()]=["disabling","toggling","alloy.base.behaviour"],a)),apis:u,domModification:{attributes:Z(Z({"aria-haspopup":"true"},n.role.fold(function(){return{}},function(t){return{role:t}})),"button"===n.dom.tag?{type:(r="type",Dt(n.dom,"attributes").bind(function(t){return Dt(t,r)}).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),sb=$a({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return qo([Ko(go(),S)])},exhibit:function(){return vi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),lb=Qr("color-input-change"),fb=Qr("color-swatch-change"),db=Qr("color-picker-cancel"),mb=function(e,n,o){var r,i,t=sv.parts.field({factory:Ev,inputClasses:["tox-textfield"],onSetValue:function(t){return Wv.run(t).get(Q)},inputBehaviours:Ka([Vg.config({disabled:n.providers.isDisabled}),ap(),lv.config({}),Wv.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return br(t.element)},notify:{onValid:function(t){var n=al.getValue(t);Uo(t,lb,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=al.getValue(t);if(0===n.length)return Vv(it.value(!0));t=se.fromTag("span");Ui(t,"background-color",n);t=qi(t,"background-color").fold(function(){return it.error("blah")},function(t){return it.value(n)});return Vv(t)}}})]),selectOnFocus:!1}),u=e.label.map(function(t){return pv(t,n.providers)}),a=function(t,n){Uo(t,fb,{value:n})},c=om((r={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Da,Ea,Fa]},onLtr:function(){return[Ea,Da,Fa]}},components:[],fetch:gh(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(t,e){c.getOpt(t).each(function(n){"custom"===e?o.colorPicker(function(t){t.fold(function(){return jo(n,db)},function(t){a(n,t),sh(t)})},"#ffffff"):a(n,"remove"===e?"":e)})}},i=n,cb.sketch({dom:r.dom,components:r.components,toggleClass:"mce-active",dropdownBehaviours:Ka([sp(i.providers.isDisabled),ap(),sb.config({}),lv.config({})]),layouts:r.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:function(n){return Rv(function(t){return r.fetch(t)}).map(function(t){return tt.from(Nh(Rt(yh(Qr("menu-value"),t,function(t){r.onItemAction(n,t)},r.columns,r.presets,Hm.CLOSE_ON_EXECUTE,l,i.providers),{movement:wh(r.columns,r.presets)})))})},parts:{menu:Zm(0,0,r.presets)}})));return sv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[t,c.asSpec()]}]),fieldBehaviours:Ka([gd("form-field-events",[$o(lb,function(t,n){c.getOpt(t).each(function(t){Ui(t.element,"background-color",n.event.color)}),Uo(t,hv,{name:e.name})}),$o(fb,function(n,e){sv.getField(n).each(function(t){al.setValue(t,e.event.value),$l.getCurrent(n).each(hd.focus)})}),$o(db,function(n,t){sv.getField(n).each(function(t){$l.getCurrent(n).each(hd.focus)})})])])})},Cr=Cl({schema:[Pn("dom")],name:"label"}),Uv=function(n){return Cl({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold(function(){return{}},function(o){return{events:qo([Qo(Je(),function(t,n,e){return o(t,e)},[t]),Qo(to(),function(t,n,e){return o(t,e)},[t]),Qo(no(),function(t,n,e){e.mouseIsDown.get()&&o(t,e)},[t])])}})}})},e=Uv("top-left"),wn=Uv("top"),Ro=Uv("top-right"),Ke=Uv("right"),nc=Uv("bottom-right"),ke=Uv("bottom"),ja=Uv("bottom-left"),Cr=[Cr,Uv("left"),Ke,wn,ke,e,Ro,ja,nc,kl({name:"thumb",defaults:W({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:qo([tr(Je(),t,"spectrum"),tr($e(),t,"spectrum"),tr(Qe(),t,"spectrum"),tr(to(),t,"spectrum"),tr(no(),t,"spectrum"),tr(oo(),t,"spectrum")])}}}),kl({schema:[mn("mouseIsDown",function(){return ae(!1)})],name:"spectrum",overrides:function(e){var o=e.model.manager,r=function(n,t){return o.getValueFromEvent(t).map(function(t){return o.setValueFrom(n,e,t)})};return{behaviours:Ka([cd.config({mode:"special",onLeft:function(t){return o.onLeft(t,e)},onRight:function(t){return o.onRight(t,e)},onUp:function(t){return o.onUp(t,e)},onDown:function(t){return o.onDown(t,e)}}),hd.config({})]),events:qo([$o(Je(),r),$o($e(),r),$o(to(),r),$o(no(),function(t,n){e.mouseIsDown.get()&&r(t,n)})])}}})],gb=W("slider.change.value"),pb=function(t){t=t.event.raw;return-1===t.type.indexOf("touch")?t.clientX!==undefined?tt.some(t).map(function(t){return hu(t.clientX,t.clientY)}):tt.none():t.touches!==undefined&&1===t.touches.length?tt.some(t.touches[0]).map(function(t){return hu(t.clientX,t.clientY)}):tt.none()},hb=function(t){return t.model.minX},vb=function(t){return t.model.minY},bb=function(t){return t.model.minX-1},yb=function(t){return t.model.minY-1},xb=function(t){return t.model.maxX},wb=function(t){return t.model.maxY},Sb=function(t){return t.model.maxX+1},kb=function(t){return t.model.maxY+1},Cb=function(t,n,e){return n(t)-e(t)},Ob=function(t){return Cb(t,xb,hb)},_b=function(t){return Cb(t,wb,vb)},Tb=function(t){return Ob(t)/2},Eb=function(t){return _b(t)/2},Db=function(t){return t.stepSize},Bb=function(t){return t.snapToGrid},Ab=function(t){return t.snapStart},Mb=function(t){return t.rounded},Fb=function(t,n){return t[n+"-edge"]!==undefined},Ib=function(t){return Fb(t,"left")},Rb=function(t){return Fb(t,"right")},Vb=function(t){return Fb(t,"top")},Pb=function(t){return Fb(t,"bottom")},Hb=function(t){return t.model.value.get()},zb=function(t,n){return{x:t,y:n}},Nb=function(t,n){Uo(t,gb(),{value:n})},Lb=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},jb=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},Ub=function(t,n,e){return Math.max(n,Math.min(e,t))},Wb=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,t=t.screenRange,s=s?n-1:n,l=l?e+1:e;if(r<f)return s;if(d<r)return l;var m,g,p,h,f=(f=f,Math.min(d,Math.max(r,f))-f),l=Ub(f/t*o+n,s,l);return u&&n<=l&&l<=e?(m=l,g=n,p=e,h=i,a.fold(function(){var t=Math.round((m-g)/h)*h;return Ub(g+t,g-1,p+1)},function(t){var n=Math.round((m-t)%h/h),e=Math.floor((m-t)/h),o=Math.floor((p-t)/h),n=Math.min(o,e+n);return Math.max(t,t+n*h)})):c?Math.round(l):l},Gb=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,t=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:t:(r-n)/o*c},Xb="left",Yb=function(t){return t.element.dom.getBoundingClientRect()},qb=function(t){return Yb(t)[Xb]},Kb=function(t){return Yb(t).right},Jb=function(t){return Yb(t).top},$b=function(t){return Yb(t).bottom},Qb=function(t){return Yb(t).width},Zb=function(t){return Yb(t).height},ty=function(t,n){t=Yb(t),n=Yb(n);return(t[Xb]+t.right)/2-n[Xb]},ny=function(t,n){t=Yb(t),n=Yb(n);return(t.top+t.bottom)/2-n.top},ey=function(t,n){Uo(t,gb(),{value:n})},oy=function(t,n,e){t={min:hb(n),max:xb(n),range:Ob(n),value:e,step:Db(n),snap:Bb(n),snapStart:Ab(n),rounded:Mb(n),hasMinEdge:Ib(n),hasMaxEdge:Rb(n),minBound:qb(t),maxBound:Kb(t),screenRange:Qb(t)};return Wb(t)},Uv=function(e){return function(t,n){return function(t,n,e){e=(0<t?jb:Lb)(Hb(e).x,hb(e),xb(e),Db(e));return ey(n,{x:e}),tt.some(e)}(e,t,n).map(S)}},ry=function(t,n,e,o,r,i){var u,a,o=(a=i,i=e,e=o,o=r,r=Qb(u=n),e=e.bind(function(t){return tt.some(ty(t,u))}).getOr(0),o=o.bind(function(t){return tt.some(ty(t,u))}).getOr(r),o={min:hb(a),max:xb(a),range:Ob(a),value:i,hasMinEdge:Ib(a),hasMaxEdge:Rb(a),minBound:qb(u),minOffset:0,maxBound:Kb(u),maxOffset:r,centerMinEdge:e,centerMaxEdge:o},Gb(o));return qb(n)-qb(t)+o},Ke=Uv(-1),wn=Uv(1),ke=tt.none,e=tt.none,Ro={"top-left":tt.none(),top:tt.none(),"top-right":tt.none(),right:tt.some(function(t,n){Nb(t,{x:Sb(n)})}),"bottom-right":tt.none(),bottom:tt.none(),"bottom-left":tt.none(),left:tt.some(function(t,n){Nb(t,{x:bb(n)})})},ja=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){e=oy(t,n,e);return ey(t,{x:e}),e},setToMin:function(t,n){n=hb(n);ey(t,{x:n})},setToMax:function(t,n){n=xb(n);ey(t,{x:n})},findValueOfOffset:oy,getValueFromEvent:function(t){return pb(t).map(function(t){return t.left})},findPositionOfValue:ry,setPositionFromValue:function(t,n,e,o){var r=Hb(e),t=ry(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),e=wu(n.element)/2;Ui(n.element,"left",t-e+"px")},onLeft:Ke,onRight:wn,onUp:ke,onDown:e,edgeActions:Ro}),iy=function(t,n){Uo(t,gb(),{value:n})},uy=function(t,n,e){t={min:vb(n),max:wb(n),range:_b(n),value:e,step:Db(n),snap:Bb(n),snapStart:Ab(n),rounded:Mb(n),hasMinEdge:Vb(n),hasMaxEdge:Pb(n),minBound:Jb(t),maxBound:$b(t),screenRange:Zb(t)};return Wb(t)},nc=function(e){return function(t,n){return function(t,n,e){e=(0<t?jb:Lb)(Hb(e).y,vb(e),wb(e),Db(e));return iy(n,{y:e}),tt.some(e)}(e,t,n).map(S)}},ay=function(t,n,e,o,r,i){var u,a,o=(a=i,i=e,e=o,o=r,r=Zb(u=n),e=e.bind(function(t){return tt.some(ny(t,u))}).getOr(0),o=o.bind(function(t){return tt.some(ny(t,u))}).getOr(r),o={min:vb(a),max:wb(a),range:_b(a),value:i,hasMinEdge:Vb(a),hasMaxEdge:Pb(a),minBound:Jb(u),minOffset:0,maxBound:$b(u),maxOffset:r,centerMinEdge:e,centerMaxEdge:o},Gb(o));return Jb(n)-Jb(t)+o},Uv=tt.none,Ke=tt.none,wn=nc(-1),ke=nc(1),e={"top-left":tt.none(),top:tt.some(function(t,n){Nb(t,{y:yb(n)})}),"top-right":tt.none(),right:tt.none(),"bottom-right":tt.none(),bottom:tt.some(function(t,n){Nb(t,{y:kb(n)})}),"bottom-left":tt.none(),left:tt.none()},Ro=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){e=uy(t,n,e);return iy(t,{y:e}),e},setToMin:function(t,n){n=vb(n);iy(t,{y:n})},setToMax:function(t,n){n=wb(n);iy(t,{y:n})},findValueOfOffset:uy,getValueFromEvent:function(t){return pb(t).map(function(t){return t.top})},findPositionOfValue:ay,setPositionFromValue:function(t,n,e,o){var r=Hb(e),t=ay(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),e=mu(n.element)/2;Ui(n.element,"top",t-e+"px")},onLeft:Uv,onRight:Ke,onUp:wn,onDown:ke,edgeActions:e}),cy=function(t,n){Uo(t,gb(),{value:n})},sy=function(t,n){return{x:t,y:n}},nc=function(i,u){return function(t,n){return o=t,r=n,t=0<(e=i)?jb:Lb,e=(n=u)?Hb(r).x:t(Hb(r).x,hb(r),xb(r),Db(r)),r=n?t(Hb(r).y,vb(r),wb(r),Db(r)):Hb(r).y,cy(o,sy(e,r)),tt.some(e).map(S);var e,o,r}},Uv=pb,Ke=nc(-1,!1),wn=nc(1,!1),ke=nc(-1,!0),e=nc(1,!0),nc={"top-left":tt.some(function(t,n){Nb(t,zb(bb(n),yb(n)))}),top:tt.some(function(t,n){Nb(t,zb(Tb(n),yb(n)))}),"top-right":tt.some(function(t,n){Nb(t,zb(Sb(n),yb(n)))}),right:tt.some(function(t,n){Nb(t,zb(Sb(n),Eb(n)))}),"bottom-right":tt.some(function(t,n){Nb(t,zb(Sb(n),kb(n)))}),bottom:tt.some(function(t,n){Nb(t,zb(Tb(n),kb(n)))}),"bottom-left":tt.some(function(t,n){Nb(t,zb(bb(n),kb(n)))}),left:tt.some(function(t,n){Nb(t,zb(bb(n),Eb(n)))})},e=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=oy(t,n,e.left),e=uy(t,n,e.top),e=sy(o,e);return cy(t,e),e},setToMin:function(t,n){var e=hb(n),n=vb(n);cy(t,sy(e,n))},setToMax:function(t,n){var e=xb(n),n=wb(n);cy(t,sy(e,n))},getValueFromEvent:Uv,setPositionFromValue:function(t,n,e,o){var r=Hb(e),i=ry(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),o=ay(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),t=wu(n.element)/2,e=mu(n.element)/2;Ui(n.element,"left",i-t+"px"),Ui(n.element,"top",o-e+"px")},onLeft:Ke,onRight:wn,onUp:ke,onDown:e,edgeActions:nc}),ly=il({name:"Slider",configFields:[$n("stepSize",1),$n("onChange",Q),$n("onChoose",Q),$n("onInit",Q),$n("onDragStart",Q),$n("onDragEnd",Q),$n("snapToGrid",!1),$n("rounded",!0),Gn("snapStart"),Hn("model",Tn("mode",{x:[$n("minX",0),$n("maxX",100),mn("value",function(t){return ae(t.mode.minX)}),Pn("getInitialValue"),la("manager",ja)],y:[$n("minY",0),$n("maxY",100),mn("value",function(t){return ae(t.mode.minY)}),Pn("getInitialValue"),la("manager",Ro)],xy:[$n("minX",0),$n("maxX",100),$n("minY",0),$n("maxY",100),mn("value",function(t){return ae({x:t.mode.minX,y:t.mode.minY})}),Pn("getInitialValue"),la("manager",e)]})),po("sliderBehaviours",[cd,al]),mn("mouseIsDown",function(){return ae(!1)})],partFields:Cr,factory:function(r,t,n,e){var i=function(t){return Rl(t,r,"thumb")},u=function(t){return Rl(t,r,"spectrum")},o=function(t){return Il(t,r,"left-edge")},a=function(t){return Il(t,r,"right-edge")},c=function(t){return Il(t,r,"top-edge")},s=function(t){return Il(t,r,"bottom-edge")},l=r.model,f=l.manager,d=function(t,n){f.setPositionFromValue(t,n,r,{getLeftEdge:o,getRightEdge:a,getTopEdge:c,getBottomEdge:s,getSpectrum:u})},m=function(t,n){l.value.set(n);n=i(t);d(t,n)},g=function(e){var t=r.mouseIsDown.get();r.mouseIsDown.set(!1),t&&Il(e,r,"thumb").each(function(t){var n=l.value.get();r.onChoose(e,t,n)})},p=function(t,n){n.stop(),r.mouseIsDown.set(!0),r.onDragStart(t,i(t))},h=function(t,n){n.stop(),r.onDragEnd(t,i(t)),g(t)};return{uid:r.uid,dom:r.dom,components:t,behaviours:sl(r.sliderBehaviours,[cd.config({mode:"special",focusIn:function(t){return Il(t,r,"spectrum").map(cd.focusIn).map(S)}}),al.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),tc.config({channels:((t={})[Qs()]={onReceive:g},t)})]),events:qo([$o(gb(),function(t,n){!function(t,n){m(t,n);var e=i(t);r.onChange(t,e,n),tt.some(!0)}(t,n.event.value)}),rr(function(t,n){var e=l.getInitialValue();l.value.set(e);var o=i(t);d(t,o);e=u(t);r.onInit(t,o,e,l.value.get())}),$o(Je(),p),$o(Qe(),h),$o(to(),p),$o(oo(),h)]),apis:{resetToMin:function(t){f.setToMin(t,r)},resetToMax:function(t){f.setToMax(t,r)},setValue:m,refresh:d},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),fy=function(t,n,e){return{hue:t,saturation:n,value:e}},dy=function(t){var n,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),t=Math.max(r,Math.max(i,u));return a===t?fy(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(t-a)),n=(t-a)/t,o=t,fy(Math.round(e),Math.round(100*n),Math.round(100*o)))},my=function(t){return Np(qp(t))},gy=Qr("rgb-hex-update"),py=Qr("slider-update"),hy=Qr("palette-update"),vy=[po("formBehaviours",[al])],by=function(t){return"<alloy.field."+t+">"},yy=function(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:sl(o.formBehaviours,[al.config({store:{mode:"manual",getValue:function(t){t=Pl(t,o);return kt(t,function(t,o){return t().bind(function(t){var n,e=$l.getCurrent(t);return e=e,n=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+qr(t.element)),e.fold(function(){return it.error(n)},it.value)}).map(al.getValue)})},setValue:function(e,t){St(t,function(n,t){Il(e,o,t).each(function(t){$l.getCurrent(t).each(function(t){al.setValue(t,n)})})})}}})]),apis:{getField:function(t,n){return Il(t,o,n).bind($l.getCurrent)}}}},xy={getField:mi(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var e,n=(e=[],{field:function(t,n){return e.push(t),Dl("form",by(t),n)},record:function(){return e}}),t=t(n),n=n.record(),n=F(n,function(t){return kl({name:t,pname:by(t)})});return Ul("form",vy,n,yy,t)}},wy=Qr("valid-input"),Sy=Qr("invalid-input"),ky=Qr("validating-input"),Cy="colorcustom.rgb.",Oy=function(d,m,g,p){var h=function(t,n,e,o,r){var i,u,a=d(Cy+"range"),t=[sv.parts.label({dom:{tag:"label",innerHtml:e,attributes:{"aria-label":o}}}),sv.parts.field({data:r,factory:Ev,inputAttributes:Z({type:"text"},"hex"===n?{"aria-live":"polite"}:{}),inputClasses:[m("textfield")],inputBehaviours:Ka([(i=n,u=t,Wv.config({invalidClass:m("invalid"),notify:{onValidate:function(t){Uo(t,ky,{type:i})},onValid:function(t){Uo(t,wy,{type:i,value:al.getValue(t)})},onInvalid:function(t){Uo(t,Sy,{type:i,value:al.getValue(t)})}},validator:{validate:function(t){t=al.getValue(t),t=u(t)?it.value(!0):it.error(d("aria.input.invalid"));return Vv(t)},validateOnLoad:!1}})),lv.config({})]),onSetValue:function(t){Wv.isInvalid(t)&&Wv.run(t).get(Q)}})],a="hex"!==n?[sv.parts["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:t.concat(a)}},v=function(t,n){var e=n.red,o=n.green,n=n.blue;al.setValue(t,{red:e,green:o,blue:n})},b=om({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),y=function(t,n){b.getOpt(t).each(function(t){Ui(t.element,"background-color","#"+n.value)})};return Yl({factory:function(){var e={red:ae(tt.some(255)),green:ae(tt.some(255)),blue:ae(tt.some(255)),hex:ae(tt.some("ffffff"))},r=function(t){return e[t].get()},i=function(t,n){e[t].set(n)},o=function(t){var n=t.red,e=t.green,t=t.blue;i("red",tt.some(n)),i("green",tt.some(e)),i("blue",tt.some(t))},n=function(t,n){n=n.event;"hex"!==n.type?i(n.type,tt.none()):p(t)},u=function(o,t,n){n=parseInt(n,10);i(t,tt.some(n)),r("red").bind(function(e){return r("green").bind(function(n){return r("blue").map(function(t){return Xp(e,n,t,1)})})}).each(function(t){var n,e,t=(n=o,e=Np(t),xy.getField(n,"hex").each(function(t){hd.isFocused(t)||al.setValue(n,{hex:e.value})}),e);Uo(o,gy,{hex:t}),y(o,t)})},a=function(t,n){n=n.event;"hex"===n.type?function(t,n){g(t);var e=Ip(n);i("hex",tt.some(n));n=Kp(e);v(t,n),o(n),Uo(t,gy,{hex:e}),y(t,e)}(t,n.value):u(t,n.type,n.value)},t=function(t){return{label:d(Cy+t+".label"),description:d(Cy+t+".description")}},c=t("red"),s=t("green"),l=t("blue"),f=t("hex");return Rt(xy.sketch(function(t){return{dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":d("aria.color.picker")}},components:[t.field("red",sv.sketch(h(Yp,"red",c.label,c.description,255))),t.field("green",sv.sketch(h(Yp,"green",s.label,s.description,255))),t.field("blue",sv.sketch(h(Yp,"blue",l.label,l.description,255))),t.field("hex",sv.sketch(h(Pp,"hex",f.label,f.description,"ffffff"))),b.asSpec()],formBehaviours:Ka([Wv.config({invalidClass:m("form-invalid")}),gd("rgb-form-events",[$o(wy,a),$o(Sy,n),$o(ky,n)])])}}),{apis:{updateHex:function(t,n){al.setValue(t,{hex:n.value}),function(t,n){n=Kp(n);v(t,n),o(n)}(t,n),y(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},_y=function(t,o){var r=ly.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[o("sv-palette-spectrum")]}}),i=ly.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette-thumb")],innerHtml:"<div class="+o("sv-palette-inner-thumb")+' role="presentation"></div>'}}),u=function(t,n){var e=t.width,o=t.height,t=t.getContext("2d");null!==t&&(t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,e,0)).addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,0,o)).addColorStop(0,"rgba(0,0,0,0)"),n.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=n,t.fillRect(0,0,e,o))};return Yl({factory:function(t){var n=W({x:0,y:0}),e=Ka([$l.config({find:tt.some}),hd.config({})]);return ly.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette")]},model:{mode:"xy",getInitialValue:n},rounded:!1,components:[r,i],onChange:function(t,n,e){Uo(t,hy,{value:e})},onInit:function(t,n,e,o){u(e.element.dom,$p(Qp))},sliderBehaviours:e})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){!function(t,n){t=t.components()[0].element.dom,n=fy(n,100,100),n=qp(n);u(t,$p(n))}(n,e)},setThumb:function(t,n,e){!function(t,n){n=dy(Kp(n));ly.setValue(t,{x:n.saturation,y:100-n.value})}(n,e)}},extraApis:{}})},Ty=function(b,y){return Yl({name:"ColourPicker",configFields:[Pn("dom"),$n("onValidHex",Q),$n("onInvalidHex",Q)],factory:function(t){var n,e,o,r,i,u,a=Oy(b,y,t.onValidHex,t.onInvalidHex),c=_y(0,y),s={paletteRgba:ae(Qp),paletteHue:ae(0)},l=om((n=y,e=ly.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=ly.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}}),ly.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:W({y:0})},components:[e,o],sliderBehaviours:Ka([hd.config({})]),onChange:function(t,n,e){Uo(t,py,{value:e})}}))),f=om(c.sketch({})),d=om(a.sketch({})),m=function(t,n,e){f.getOpt(t).each(function(t){c.setHue(t,e)})},g=function(t,n){d.getOpt(t).each(function(t){a.updateHex(t,n)})},p=function(t,n,e){l.getOpt(t).each(function(t){ly.setValue(t,{y:100-e/360*100})})},h=function(t,n){f.getOpt(t).each(function(t){c.setThumb(t,n)})},v=function(n,e,o,t){!function(t,n){t=Kp(t);s.paletteRgba.set(t),s.paletteHue.set(n)}(e,o),nt(t,function(t){t(n,e,o)})};return{uid:t.uid,dom:t.dom,components:[f.asSpec(),l.asSpec(),d.asSpec()],behaviours:Ka([gd("colour-picker-events",[$o(gy,(u=[m,p,h],function(t,n){var e=n.event.hex,n=dy(Kp(e));v(t,e,n.hue,u)})),$o(hy,(i=[g],function(t,n){var e=n.event.value,n=s.paletteHue.get(),e=fy(n,e.x,100-e.y),e=my(e);v(t,e,n,i)})),$o(py,(r=[m,g],function(t,n){var e=(100-n.event.value.y)/100*360,n=s.paletteRgba.get(),n=dy(n),n=fy(e,n.saturation,n.value),n=my(n);v(t,n,e,r)}))]),$l.config({find:function(t){return d.getOpt(t)}}),cd.config({mode:"acyclic"})])}}})},Ey=function(){return $l.config({find:tt.some})},Dy=function(t){return $l.config({find:t.getOpt})},By=function(t){return $l.config({find:function(n){return Sr(n.element,t).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}})},Ay={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},My=function(t){return Ay[t]},Fy=tinymce.util.Tools.resolve("tinymce.Resource"),Iy=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ry=an([$n("preprocess",w),$n("postprocess",w)]),Vy=function(t,n,e){return al.config(Rt({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},Py=function(t,n,e){return Vy(t,function(t){return n(t.element)},function(t,n){return e(t.element,n)})},Hy=function(e,t){var o=Cn("RepresentingConfigs.memento processors",Ry,t);return al.config({store:{mode:"manual",getValue:function(t){t=e.get(t),t=al.getValue(t);return o.postprocess(t)},setValue:function(t,n){n=o.preprocess(n),t=e.get(t);al.setValue(t,n)}}})},zy=Vy,Ny=function(t){return Py(t,zr,Nr)},Ly=function(t){return al.config({store:{mode:"memory",initialValue:t}})},jy=function(o,r){var n=function(t,n){n.stop()},e=function(t){return function(n,e){nt(t,function(t){t(n,e)})}},i=function(t,n){Vg.isDisabled(t)||(n=n.event.raw,a(t,n.dataTransfer.files))},u=function(t,n){n=n.event.raw.target;a(t,n.files)},a=function(t,n){var e;al.setValue(t,(n=n,e=Iy.explode(r.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),R(K(n),function(n){return B(e,function(t){return be(n.name.toLowerCase(),"."+t.toLowerCase())})}))),Uo(t,hv,{name:o.name})},c=om({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Ka([gd("input-file-events",[er(fo()),er(ko())])])}),t=o.label.map(function(t){return pv(t,r)}),s=sv.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Ka([Ly([]),Ey(),Vg.config({}),Od.config({toggleClass:"dragenter",toggleOnExecute:!1}),gd("dropzone-events",[$o("dragenter",e([n,Od.toggle])),$o("dragleave",e([n,Od.toggle])),$o("dragover",n),$o("drop",e([n,i])),$o(lo(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:r.translate("Drop an image here")}},em.sketch({dom:{tag:"button",innerHtml:r.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(t){c.get(t).element.dom.click()},buttonBehaviours:Ka([lv.config({}),sp(r.isDisabled),ap()])})]}]}}}});return dv(t,s,["tox-form__group--stretched"],[])},Uy=Qr("alloy-fake-before-tabstop"),Wy=Qr("alloy-fake-after-tabstop"),Gy=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Ka([hd.config({ignore:!0}),lv.config({})])}},Xy=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Gy([Uy]),t,Gy([Wy])],behaviours:Ka([By(1)])}},Yy=function(t,n){Uo(t,ao(),{raw:{which:9,shiftKey:n}})},qy=function(t,n){n=n.element;Ii(n,Uy)?Yy(t,!0):Ii(n,Wy)&&Yy(t,!1)},Ky=function(t){return Xh(t,["."+Uy,"."+Wy].join(","),l)},Jy=!(Pe().browser.isIE()||Pe().browser.isEdge()),$y=function(t,n){var e,o,r=Jy&&t.sandboxed,i=Z(Z({},t.label.map(function(t){return{title:t}}).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=ae(""),{getValue:function(t){return o.get()},setValue:function(t,n){e?jr(t.element,"srcdoc",n):(jr(t.element,"src","javascript:''"),(t=t.element.dom.contentWindow.document).open(),t.write(n),t.close()),o.set(n)}}),r=t.label.map(function(t){return pv(t,n)}),t=sv.parts.field({factory:{sketch:function(t){return Xy({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:Ka([lv.config({}),hd.config({}),zy(tt.none(),u.getValue,u.setValue)])})}}});return dv(r,t,["tox-form__group--stretched"],[])},Qy=function(t,n){return nx(document.createElement("canvas"),t,n)},Zy=function(t){var n=Qy(t.width,t.height);return tx(n).drawImage(t,0,0),n},tx=function(t){return t.getContext("2d")},nx=function(t,n,e){return t.width=n,t.height=e,t},ex=function(t){return t.naturalWidth||t.width},ox=function(t){return t.naturalHeight||t.height},rx=window.Promise||(Yv=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Qv(t,Jv(ux,this),Jv(ax,this))},qv=window,Kv=Yv.immediateFn||"function"==typeof qv.setImmediate&&qv.setImmediate||function(t){return setTimeout(t,1)},Jv=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(o,t)}},$v=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Qv=function(t,n,e){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))})}catch(r){if(o)return;o=!0,e(r)}},Yv.prototype["catch"]=function(t){return this.then(null,t)},Yv.prototype.then=function(e,o){var r=this;return new Yv(function(t,n){ix.call(r,new sx(e,o,t,n))})},Yv.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var c=Array.prototype.slice.call(1===t.length&&$v(t[0])?t[0]:t);return new Yv(function(r,i){if(0===c.length)return r([]);for(var u=c.length,a=function(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){a(n,t)},i)}c[n]=t,0==--u&&r(c)}catch(o){i(o)}},t=0;t<c.length;t++)a(t,c[t])})},Yv.resolve=function(n){return n&&"object"==typeof n&&n.constructor===Yv?n:new Yv(function(t){t(n)})},Yv.reject=function(e){return new Yv(function(t,n){n(e)})},Yv.race=function(r){return new Yv(function(t,n){for(var e=0,o=r;e<o.length;e++)o[e].then(t,n)})},Yv);function ix(o){var r=this;null!==this._state?Kv(function(){var t,n=r._state?o.onFulfilled:o.onRejected;if(null!==n){try{t=n(r._value)}catch(e){return void o.reject(e)}o.resolve(t)}else(r._state?o.resolve:o.reject)(r._value)}):this._deferreds.push(o)}function ux(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void Qv(Jv(n,t),Jv(ux,this),Jv(ax,this))}this._state=!0,this._value=t,cx.call(this)}catch(e){ax.call(this,e)}}function ax(t){this._state=!1,this._value=t,cx.call(this)}function cx(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];ix.call(this,e)}this._deferreds=[]}function sx(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}var lx,fx,dx,mx=function(e){return new rx(function(t,n){!function(t){var n=t.split(","),t=/data:([^;]+)/.exec(n[0]);if(!t)return tt.none();for(var t=t[1],n=n[1],e=atob(n),o=e.length,r=Math.ceil(o/1024),i=new Array(r),u=0;u<r;++u){for(var a=1024*u,c=Math.min(1024+a,o),s=new Array(c-a),l=a,f=0;l<c;++f,++l)s[f]=e[l].charCodeAt(0);i[u]=new Uint8Array(s)}return tt.some(new Blob(i,{type:t}))}(e).fold(function(){n("uri is not base64: "+e)},t)})},gx=function(t,o,r){return o=o||"image/png",f(HTMLCanvasElement.prototype.toBlob)?new rx(function(n,e){t.toBlob(function(t){t?n(t):e()},o,r)}):mx(t.toDataURL(o,r))},px=function(t){return a=t,new rx(function(t,n){var e=URL.createObjectURL(a),o=new Image,r=function(){o.removeEventListener("load",i),o.removeEventListener("error",u)},i=function(){r(),t(o)},u=function(){r(),n("Unable to load data of type "+a.type+": "+e)};o.addEventListener("load",i),o.addEventListener("error",u),o.src=e,o.complete&&setTimeout(i,0)}).then(function(t){hx(t);var n=Qy(ex(t),ox(t));return tx(n).drawImage(t,0,0),n});var a},hx=function(t){URL.revokeObjectURL(t.src)},vx=function(t,n,e){var o=n.type,r=W(o),o=W(e),i=function(n,e){return t.then(function(t){return t.toDataURL(n||"image/png",e)})};return{getType:r,toBlob:function(){return rx.resolve(n)},toDataURL:o,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return gx(t,n,e)})},toAdjustedDataURL:i,toAdjustedBase64:function(t,n){return i(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(Zy)}}},bx=function(n,t){return gx(n,t).then(function(t){return vx(rx.resolve(n),t,n.toDataURL())})},yx=function(n){return e=n,new rx(function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}).then(function(t){return vx(px(n),n,t)});var e},xx=function(t,n,e){t="string"==typeof t?parseFloat(t):t;return e<t?t=e:t<n&&(t=n),t},wx=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},Sx=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],kx=function(t,n){for(var e=[],o=new Array(25),r=0;r<5;r++){for(var i=0;i<5;i++)e[i]=n[i+5*r];for(i=0;i<5;i++){for(var u=0,a=0;a<5;a++)u+=t[i+5*a]*e[a];o[i+5*r]=u}}return o},Cx=function(n,e){return n.toCanvas().then(function(t){return Ox(t,n.getType(),e)})},Ox=function(t,n,e){var o=tx(t),e=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(e,0,0),bx(t,n)},_x=function(t,n,e){var o=tx(t),r=function(t,n,e){for(var o=function(t,n,e){return e<t?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),v=e[p*r+h];d+=u[b]*v,m+=u[1+b]*v,g+=u[2+b]*v}var y=4*(l*c+f);a[y]=o(d,0,255),a[1+y]=o(m,0,255),a[2+y]=o(g,0,255)}return n}(o.getImageData(0,0,t.width,t.height),r=o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),bx(t,n)},nc=function(e){return function(t,n){return Cx(t,e(wx(),n))}},Tx=(lx=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return Cx(t,lx)}),Ex=nc(function(t,n){return n=xx(255*n,-255,255),kx(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])}),Dx=nc(function(t,n){var e;return n=xx(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0===(e=n%1)?Sx[n]:Sx[Math.floor(n)]*(1-e)+Sx[Math.floor(n)+1]*e)+127,kx(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}),Bx=(fx=[0,-1,0,-1,5,-1,0,-1,0],function(t){return e=fx,(n=t).toCanvas().then(function(t){return _x(t,n.getType(),e)});var n,e}),Ax=(dx=function(t,n){return 255*Math.pow(t/255,1-n)},function(n,e){return n.toCanvas().then(function(t){return function(t,n,e){for(var o=tx(t),r=new Array(256),i=0;i<r.length;i++)r[i]=dx(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),bx(t,n)}(t,n.getType(),e)})}),Mx=function(t,n,e){var o=ex(t),r=ox(t),i=n/o,o=e/r,r=!1;(i<.5||2<i)&&(i=i<.5?.5:2,r=!0),(o<.5||2<o)&&(o=o<.5?.5:2,r=!0);o=Fx(t,i,o);return r?o.then(function(t){return Mx(t,n,e)}):o},Fx=function(u,a,c){return new rx(function(t){var n=ex(u),e=ox(u),o=Math.floor(n*a),r=Math.floor(e*c),i=Qy(o,r);tx(i).drawImage(u,0,0,n,e,0,0,o,r),t(i)})},Ix=function(t,n){void 0===n&&(n=2);n=Math.pow(10,n),t=Math.round(t*n);return Math.ceil(t/n)},Rx=function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=Ix(Math.abs(r*a)+Math.abs(i*u)),e=Ix(Math.abs(r*u)+Math.abs(i*a)),u=Qy(c,e),a=tx(u);return a.translate(c/2,e/2),a.rotate(o),a.drawImage(t,-r/2,-i/2),bx(u,n)},Vx=function(t,n,e){var o=Qy(t.width,t.height),r=tx(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),bx(o,n)},Px=function(t,n,e,o,r,i){i=Qy(r,i);return tx(i).drawImage(t,-e,-o),bx(i,n)},Hx=function(t){return Tx(t)},zx=function(t){return Bx(t)},Nx=function(t,n){return Ax(t,n)},Lx=function(t,n,e,o){return Cx(t,(r=wx(),t=n,e=e,o=o,t=xx(n,0,2),e=xx(e,0,2),o=xx(o,0,2),kx(r,[t,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])));var r},jx=function(t,n){return Ex(t,n)},Ux=function(t,n){return Dx(t,n)},Wx=function(t,n){return o=n,(e=t).toCanvas().then(function(t){return Vx(t,e.getType(),o)});var e,o},Gx=function(t,n,e,o,r){return u=n,a=e,c=o,s=r,(i=t).toCanvas().then(function(t){return Px(t,i.getType(),u,a,c,s)});var i,u,a,c,s},Xx=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then(function(t){return Mx(t,r,i).then(function(t){return bx(t,o.getType())})});var o,r,i},Yx=function(t,n){return o=n,(e=t).toCanvas().then(function(t){return Rx(t,e.getType(),o)});var e,o},qx=function(t,n){return Z({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},Kx=function(t,n){return qx(im(t,n),{})},Jx=function(t,n){return qx(im(t,n),{behaviours:Ka([md.config({})])})},$x=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Ka([md.config({})])}},Qx=Qr("toolbar.button.execute"),Zx=((ja={})[wo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],ja),t0=Qr("update-menu-text"),n0=Qr("update-menu-icon"),e0=function(n,e,o){var t=ae(Q),r=n.text.map(function(t){return om($x(t,e,o.providers))}),i=n.icon.map(function(t){return om(Jx(t,o.providers.icons))}),u=function(t,n){t=al.getValue(t);return hd.focus(t),Uo(t,"keydown",{raw:n.event.raw}),cb.close(t),tt.some(!0)},a=n.role.fold(function(){return{}},function(t){return{role:t}}),c=n.tooltip.fold(function(){return{}},function(t){t=o.providers.translate(t);return{title:t,"aria-label":t}});return om(cb.sketch(Z(Z(Z({},n.uid?{uid:n.uid}:{}),a),{dom:{tag:"button",classes:[e,e+"--select"].concat(F(n.classes,function(t){return e+"--"+t})),attributes:Z({},c)},components:hp([i.map(function(t){return t.asSpec()}),r.map(function(t){return t.asSpec()}),tt.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:im("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Ka(p(n.dropdownBehaviours,[sp(function(){return n.disabled||o.providers.isDisabled()}),ap(),sb.config({}),md.config({}),gd("dropdown-events",[mp(n,t),gp(n,t)]),gd("menubutton-update-display-text",[$o(t0,function(n,e){r.bind(function(t){return t.getOpt(n)}).each(function(t){md.set(t,[uu(o.providers.translate(e.event.text))])})}),$o(n0,function(n,e){i.bind(function(t){return t.getOpt(n)}).each(function(t){md.set(t,[Jx(e.event.icon,o.providers.icons)])})})])])),eventOrder:Rt(Zx,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Ka([cd.config({mode:"special",onLeft:u,onRight:u})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:Zm(0,n.columns,n.presets)},fetch:function(t){return Rv(m(n.fetch,t))}}))).asSpec()},o0=function(t){return"separator"===t.type},r0={type:"separator"},i0=function(t,e){t=P(t,function(t,n){return v(n)?""===n?t:"|"===n?0<t.length&&!o0(t[t.length-1])?t.concat([r0]):t:Bt(e,n.toLowerCase())?t.concat([e[n.toLowerCase()]]):t:t.concat([n])},[]);return 0<t.length&&o0(t[t.length-1])&&t.pop(),t},u0=function(t,n){return Bt(t,"getSubmenuItems")?(o=n,n=(e=t).getSubmenuItems(),o=a0(n,o),{item:e,menus:Rt(o.menus,Xt(e.value,o.items)),expansions:Rt(o.expansions,Xt(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o},a0=function(t,e){t=i0(v(t)?t.split(" "):t,e);return V(t,function(t,n){n=function(t){if(o0(t))return t;var n=Dt(t,"value").getOrThunk(function(){return Qr("generated-menu-item")});return Rt({value:n},t)}(n),n=u0(n,e);return{menus:Rt(t.menus,n.menus),items:[n.item].concat(t.items),expansions:Rt(t.expansions,n.expansions)}},{menus:{},expansions:{},items:[]})},c0=function(t,e,o,n){var r=Qr("primary-menu"),i=a0(t,o.shared.providers.menuItems());if(0===i.items.length)return tt.none();t=zh(r,i.items,e,o,n),n=kt(i.menus,function(t,n){return zh(n,t,e,o,!1)}),t=Rt(n,Xt(r,t));return tt.from(Wd.tieredData(r,t,i.expansions))},s0=function(e){return{isDisabled:function(){return Vg.isDisabled(e)},setDisabled:function(t){return Vg.set(e,t)},setActive:function(t){var n=e.element;t?(Ai(n,"tox-tbtn--enabled"),jr(n,"aria-pressed",!0)):(Fi(n,"tox-tbtn--enabled"),Xr(n,"aria-pressed"))},isActive:function(){return Ii(e.element,"tox-tbtn--enabled")}}},l0=function(e,t,o,n){return e0({text:e.text,icon:e.icon,tooltip:e.tooltip,role:n,fetch:function(t,n){e.fetch(function(t){n(c0(t,Hm.CLOSE_ON_EXECUTE,o,!1))})},onSetup:e.onSetup,getApi:s0,columns:1,presets:"normal",classes:[],dropdownBehaviours:[lv.config({})]},t,o.shared)},f0=function(n,r,i){return function(t){t(F(n,function(t){var n,e,o=t.text.fold(function(){return{}},function(t){return{text:t}});return Z(Z({type:t.type,active:!1},o),{onAction:function(t){var n=!t.isActive();t.setActive(n),e.storage.set(n),i.shared.getSink().each(function(t){r().getOpt(t).each(function(t){ec(t.element),Uo(t,yv,{name:e.name,value:e.storage.get()})})})},onSetup:(n=e=t,function(t){t.setActive(n.storage.get())})})}))}},d0=function(t,n,e,o,r,i){void 0===e&&(e=[]);n=n.fold(function(){return{}},function(t){return{action:t}}),n=Z({buttonBehaviours:Ka([sp(function(){return t.disabled||i.isDisabled()}),ap(),lv.config({}),gd("button press",[Jo("click"),Jo("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},n),o=Rt(n,{dom:o});return Rt(o,{components:r})},m0=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return Kx(t,e.icons)}),i=hp([i]);return d0(t,n,o,r,i,e)},g0=function(t,n,e,o){void 0===o&&(o=[]);o=m0(t,tt.some(n),e,o);return em.sketch(o)},p0=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map(function(t){return Kx(t,e.icons)}):tt.none(),a=u.isSome()?hp([u]):[],c=u.isSome()?{}:{innerHtml:i},r=p(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),i=Z(Z({tag:"button",classes:r},c),{attributes:{title:i}});return d0(t,n,o,i,a,e)},h0=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);r=p0(t,tt.some(n),e,o,r);return em.sketch(r)},v0=function(n,e){return function(t){"custom"===e?Uo(t,yv,{name:n,value:{}}):"submit"===e?jo(t,xv):"cancel"===e?jo(t,bv):console.error("Unknown button type: ",e)}},b0=function(n,t,e){if("menu"===t){var o=n,r=Z(Z({},n),{onSetup:function(t){return t.setDisabled(n.disabled),Q},fetch:f0(o.items,function(){return i},e)}),i=om(l0(r,"tox-tbtn",e,tt.none()));return i.asSpec()}if("custom"===(o=t)||"cancel"===o||"submit"===o){r=v0(n.name,t),o=Z(Z({},n),{borderless:!1});return h0(o,r,e.shared.providers,[])}console.error("Unknown footer button type: ",t)},y0=function(t,n){var e,o=v0(t.name,"custom");return e=tt.none(),n=sv.parts.field(Z({factory:em},p0(t,tt.some(o),n,[Ly(""),Ey()]))),dv(e,n,[],[])},Ro=W([$n("field1Name","field1"),$n("field2Name","field2"),sa("onLockedChange"),ia(["lockClass"]),$n("locked",!1),ll("coupledFieldBehaviours",[$l,al])]),e=function(t,n){return kl({factory:sv,name:t,overrides:function(o){return{fieldBehaviours:Ka([gd("coupled-input-behaviour",[$o(so(),function(e){Il(e,o,n).bind($l.getCurrent).each(function(n){Il(e,o,"lock").each(function(t){Od.isOn(t)&&o.onLockedChange(e,n,t)})})})])])}}})},Cr=W([e("field1","field2"),e("field2","field1"),kl({factory:em,schema:[Pn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Ka([Od.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),x0=il({name:"FormCoupledInputs",configFields:Ro(),partFields:Cr(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:fl(e.coupledFieldBehaviours,[$l.config({find:tt.some}),al.config({store:{mode:"manual",getValue:function(t){var n=zl(t,e,["field1","field2"]),t={};return t[e.field1Name]=al.getValue(n.field1()),t[e.field2Name]=al.getValue(n.field2()),t},setValue:function(t,n){t=zl(t,e,["field1","field2"]);At(n,e.field1Name)&&al.setValue(t.field1(),n[e.field1Name]),At(n,e.field2Name)&&al.setValue(t.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return Il(t,e,"field1")},getField2:function(t){return Il(t,e,"field2")},getLock:function(t){return Il(t,e,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),w0=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return it.error(t);t=parseFloat(n[1]),n=n[2];return it.value({value:t,unit:n})},S0=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,"in":1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?tt.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?tt.some(t.value):tt.some(t.value/e[t.unit]*e[n]):tt.none()},k0=function(t){return tt.none()},C0=function(t,n){var e=w0(t).toOptional(),t=w0(n).toOptional();return n=t,t=function(t,o){return S0(t,o.unit).map(function(t){return o.value/t}).map(function(t){return n=t,e=o.unit,function(t){return S0(t,e).map(function(t){return{value:t*n,unit:e}})};var n,e}).getOr(k0)},((e=e).isSome()&&n.isSome()?tt.some(t(e.getOrDie(),n.getOrDie())):tt.none()).getOr(k0)},O0=function(o,n){var r=k0,i=Qr("ratio-event"),t=x0.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(o.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:im("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:im("unlock",n.icons)}}],buttonBehaviours:Ka([Vg.config({disabled:function(){return o.disabled||n.isDisabled()}}),ap(),lv.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return sv.parts.field({factory:Ev,inputClasses:["tox-textfield"],inputBehaviours:Ka([Vg.config({disabled:function(){return o.disabled||n.isDisabled()}}),ap(),lv.config({}),gd("size-input-events",[$o(io(),function(t,n){Uo(t,i,{isField1:e})}),$o(lo(),function(t,n){Uo(t,hv,{name:o.name})})])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=x0.parts.field1(e([sv.parts.label(a("Width")),u(!0)])),u=x0.parts.field2(e([sv.parts.label(a("Height")),u(!1)]));return x0.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,u,e([a("&nbsp;"),t])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,o,n){w0(al.getValue(t)).each(function(t){r(t).each(function(t){var n,e;al.setValue(o,(e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,"in":4,"%":4},(t=-1!==(t=(n=t).value.toFixed((t=n.unit)in e?e[t]:1)).indexOf(".")?t.replace(/\.?0*$/,""):t)+n.unit))})})},coupledFieldBehaviours:Ka([Vg.config({disabled:function(){return o.disabled||n.isDisabled()},onDisabled:function(t){x0.getField1(t).bind(sv.getField).each(Vg.disable),x0.getField2(t).bind(sv.getField).each(Vg.disable),x0.getLock(t).each(Vg.disable)},onEnabled:function(t){x0.getField1(t).bind(sv.getField).each(Vg.enable),x0.getField2(t).bind(sv.getField).each(Vg.enable),x0.getLock(t).each(Vg.enable)}}),ap(),gd("size-input-events2",[$o(i,function(t,n){var e=n.event.isField1,n=e?x0.getField1(t):x0.getField2(t),t=e?x0.getField2(t):x0.getField1(t),n=n.map(al.getValue).getOr(""),t=t.map(al.getValue).getOr("");r=C0(n,t)})])])})},_0={undo:W(Qr("undo")),redo:W(Qr("redo")),zoom:W(Qr("zoom")),back:W(Qr("back")),apply:W(Qr("apply")),swap:W(Qr("swap")),transform:W(Qr("transform")),tempTransform:W(Qr("temp-transform")),transformApply:W(Qr("transform-apply"))},nc=W("save-state"),ja=W("disable"),e=W("enable"),T0={formActionEvent:yv,saveState:nc,disable:ja,enable:e},E0=function(o,a){var t=function(t,n,e,o){return om(h0({name:t,text:t,disabled:e,primary:o,icon:tt.none(),borderless:!1},n,a))},n=function(t,n,e,o){return om(g0({name:t,icon:tt.some(t),tooltip:tt.some(n),disabled:o,primary:!1,borderless:!1},e,a))},u=function(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(Vg)&&Vg.disable(t)})},c=function(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(Vg)&&Vg.enable(t)})},s={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},e=Q,r=function(t,n,e){Uo(t,n,e)},i=function(t){return jo(t,T0.disable())},l=function(t){return jo(t,T0.enable())},f=function(t,n){i(t),r(t,_0.transform(),{transform:n}),l(t)},d=function(t){return function(){U.getOpt(t).each(function(t){md.set(t,[j])})}},m=function(t,n){i(t),r(t,_0.transformApply(),{transform:n,swap:d(t)}),l(t)},g=function(){return t("Back",function(t){return r(t,_0.back(),{swap:d(t)})},!1,!1)},p=function(){return om({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Ka([Vg.config({})])})},h=function(){return t("Apply",function(t){return r(t,_0.apply(),{swap:d(t)})},!0,!0)},v=[g(),p(),t("Apply",function(t){m(t,function(t){var n=o.getRect();return Gx(t,n.x,n.y,n.w,n.h)}),o.hideCrop()},!1,!0)],b=av.sketch({dom:s,components:v.map(function(t){return t.asSpec()}),containerBehaviours:Ka([gd("image-tools-crop-buttons-events",[$o(T0.disable(),function(t,n){u(v,t)}),$o(T0.enable(),function(t,n){c(v,t)})])])}),y=om(O0({name:"size",label:tt.none(),constrain:!0,disabled:!1},a)),x=[g(),p(),y,p(),t("Apply",function(r){y.getOpt(r).each(function(t){var n,e,o=al.getValue(t),t=parseInt(o.width,10),o=parseInt(o.height,10),o=(n=t,e=o,function(t){return Xx(t,n,e)});m(r,o)})},!1,!0)],w=av.sketch({dom:s,components:x.map(function(t){return t.asSpec()}),containerBehaviours:Ka([gd("image-tools-resize-buttons-events",[$o(T0.disable(),function(t,n){u(x,t)}),$o(T0.enable(),function(t,n){c(x,t)})])])}),S=function(n,e){return function(t){return n(t,e)}},k=S(Wx,"h"),C=S(Wx,"v"),O=S(Yx,-90),_=S(Yx,90),T=function(t,n){n=n,i(t=t),r(t,_0.tempTransform(),{transform:n}),l(t)},E=[g(),p(),n("flip-horizontally","Flip horizontally",function(t){T(t,k)},!1),n("flip-vertically","Flip vertically",function(t){T(t,C)},!1),n("rotate-left","Rotate counterclockwise",function(t){T(t,O)},!1),n("rotate-right","Rotate clockwise",function(t){T(t,_)},!1),p(),h()],D=av.sketch({dom:s,components:E.map(function(t){return t.asSpec()}),containerBehaviours:Ka([gd("image-tools-fliprotate-buttons-events",[$o(T0.disable(),function(t,n){u(E,t)}),$o(T0.enable(),function(t,n){c(E,t)})])])}),B=function(t,n,e,o,r){var i=ly.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:a.translate(t)}}),u=ly.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),t=ly.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return om(ly.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e,maxX:r,getInitialValue:W({x:o})},components:[i,u,t],sliderBehaviours:Ka([hd.config({})]),onChoose:n}))},A=function(t,n,e,o,r){return[g(),(i=n,B(t,function(t,n,e){e=S(i,e.x/100);f(t,e)},e,o,r)),h()];var i},M=function(t,n,e,o,r){var i=A(t,n,e,o,r);return av.sketch({dom:s,components:i.map(function(t){return t.asSpec()}),containerBehaviours:Ka([gd("image-tools-filter-panel-buttons-events",[$o(T0.disable(),function(t,n){u(i,t)}),$o(T0.enable(),function(t,n){c(i,t)})])])})},F=[g(),p(),h()],I=av.sketch({dom:s,components:F.map(function(t){return t.asSpec()})}),R=M("Brightness",jx,-100,0,100),V=M("Contrast",Ux,-100,0,100),P=M("Gamma",Nx,-100,0,100),H=function(t){return B(t,function(c,t,n){var e=z.getOpt(c),o=L.getOpt(c),r=N.getOpt(c);e.each(function(a){o.each(function(u){r.each(function(t){var n,e,o,r=al.getValue(a).x/100,i=al.getValue(t).x/100,t=al.getValue(u).x/100,t=(n=r,e=i,o=t,function(t){return Lx(t,n,e,o)});f(c,t)})})})},0,100,200)},z=H("R"),N=H("G"),L=H("B"),p=[g(),z,N,L,h()],F=av.sketch({dom:s,components:p.map(function(t){return t.asSpec()})}),M=function(n,e,o){return function(t){r(t,_0.swap(),{transform:e,swap:function(){U.getOpt(t).each(function(t){md.set(t,[n]),o(t)})}})}},H=tt.some(zx),p=tt.some(Hx),e=[n("crop","Crop",M(b,tt.none(),function(t){o.showCrop()}),!1),n("resize","Resize",M(w,tt.none(),function(t){y.getOpt(t).each(function(t){var n=o.getMeasurements(),e=n.width,n=n.height;al.setValue(t,{width:e,height:n})})}),!1),n("orientation","Orientation",M(D,tt.none(),e),!1),n("brightness","Brightness",M(R,tt.none(),e),!1),n("sharpen","Sharpen",M(I,H,e),!1),n("contrast","Contrast",M(V,tt.none(),e),!1),n("color-levels","Color levels",M(F,tt.none(),e),!1),n("gamma","Gamma",M(P,tt.none(),e),!1),n("invert","Invert",M(I,p,e),!1)],j=av.sketch({dom:s,components:e.map(function(t){return t.asSpec()})}),e=av.sketch({dom:{tag:"div"},components:[j],containerBehaviours:Ka([md.config({})])}),U=om(e);return{memContainer:U,getApplyButton:function(t){return U.getOpt(t).map(function(t){t=t.components()[0];return t.components()[t.components().length-1]})}}},D0=tinymce.util.Tools.resolve("tinymce.geom.Rect"),B0=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),A0=tinymce.util.Tools.resolve("tinymce.util.Observable"),M0=tinymce.util.Tools.resolve("tinymce.util.VK"),F0=function(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};function I0(t,s){var l,f,d,m,g=s.document||document,p=g.getElementById(s.handle||t),h=function(t){if(F0(t),t.button!==f)return v(t);t.deltaX=t.screenX-d,t.deltaY=t.screenY-m,t.preventDefault(),s.drag(t)},v=function(t){F0(t),B0(g).off("mousemove touchmove",h).off("mouseup touchend",v),l.remove(),s.stop&&s.stop(t)};return B0(p).on("mousedown touchstart",function(t){var n,e,o,r,i,u,a,n=(n=g,e=Math.max,o=n.documentElement,r=n.body,i=e(o.scrollWidth,r.scrollWidth),u=e(o.clientWidth,r.clientWidth),a=e(o.offsetWidth,r.offsetWidth),c=e(o.scrollHeight,r.scrollHeight),n=e(o.clientHeight,r.clientHeight),{width:i<a?u:i,height:c<e(o.offsetHeight,r.offsetHeight)?n:c});F0(t),t.preventDefault(),f=t.button;var c=p;d=t.screenX,m=t.screenY,c=window.getComputedStyle?window.getComputedStyle(c,null).getPropertyValue("cursor"):c.runtimeStyle.cursor,l=B0("<div></div>").css({position:"absolute",top:0,left:0,width:n.width,height:n.height,zIndex:2147483647,opacity:1e-4,cursor:c}).appendTo(g.body),B0(g).on("mousemove touchmove",h).on("mouseup touchend",v),s.start(t)}),{destroy:function(){B0(p).off()}}}var R0=0,V0=function(a,e,c,o,r){var t,n="tox-",u="tox-crid-"+R0++,s=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],i=["top","right","bottom","left"],l=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},f=function(t,n,e,o){var r=n.x,i=n.y,u=n.w,n=n.h;r+=e*t.deltaX,i+=o*t.deltaY,u+=e*t.deltaW,n+=o*t.deltaH,t=a=D0.clamp({x:r,y:i,w:u=u<20?20:u,h:n=n<20?20:n},c,"move"===t.name),t=l(c,t=a),p.fire("updateRect",{rect:t}),g(t)},d=function(n){var t=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),B0("#"+u+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})};Iy.each(s,function(t){B0("#"+u+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})}),t("top",{x:e.x,y:e.y,w:e.w,h:n.y-e.y}),t("right",{x:n.x+n.w,y:n.y,w:e.w-n.x-n.w+e.x,h:n.h}),t("bottom",{x:e.x,y:n.y+n.h,w:e.w,h:e.h-n.y-n.h+e.y}),t("left",{x:e.x,y:n.y,w:n.x-e.x,h:n.h}),t("move",n)},m=function(t){d(a=t)},g=function(t){m({x:t.x+c.x,y:t.y+c.y,w:t.w,h:t.h})};B0('<div id="'+u+'" class="'+n+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),Iy.each(i,function(t){B0("#"+u,o).append('<div id="'+u+"-"+t+'"class="'+n+'croprect-block" style="display: none" data-mce-bogus="all">')}),Iy.each(s,function(t){B0("#"+u,o).append('<div id="'+u+"-"+t.name+'" class="'+n+"croprect-handle "+n+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),t=Iy.map(s,function(n){var e;return I0(u,{document:o.ownerDocument,handle:u+"-"+n.name,start:function(){e=a},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})}),d(a),B0(o).on("focusin focusout",function(t){B0(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),B0(o).on("keydown",function(n){var i;Iy.each(s,function(t){if(n.target.id===u+"-"+t.name)return i=t,!1});var t=function(t,n,e,o,r){t.stopPropagation(),t.preventDefault(),f(i,e,o,r)};switch(n.keyCode){case M0.LEFT:t(n,0,a,-10,0);break;case M0.RIGHT:t(n,0,a,10,0);break;case M0.UP:t(n,0,a,0,-10);break;case M0.DOWN:t(n,0,a,0,10);break;case M0.ENTER:case M0.SPACEBAR:n.preventDefault(),r()}});var p=Iy.extend({toggleVisibility:function(t){var n=Iy.map(s,function(t){return"#"+u+"-"+t.name}).concat(Iy.map(i,function(t){return"#"+u+"-"+t})).join(",");t?B0(n,o).show():B0(n,o).hide()},setClampRect:function(t){c=t,d(a)},setRect:m,getInnerRect:function(){return l(c,a)},setInnerRect:g,setViewPortRect:function(t){e=t,d(a)},destroy:function(){Iy.each(t,function(t){t.destroy()}),t=[]}},A0);return p},P0=function(n){var l=om({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),f=ae(1),d=ae(tt.none()),m=ae({x:0,y:0,w:1,h:1}),u=ae({x:0,y:0,w:1,h:1}),a=function(t,s){c.getOpt(t).each(function(t){var e=f.get(),o=wu(t.element),r=mu(t.element),i=s.dom.naturalWidth*e,u=s.dom.naturalHeight*e,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),n={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};Wi(s,n),l.getOpt(t).each(function(t){Wi(t.element,n)}),d.get().each(function(t){var n=m.get();t.setRect({x:n.x*e+a,y:n.y*e+c,w:n.w*e,h:n.h*e}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})})})},e=function(t,n){var e,i=se.fromTag("img");return jr(i,"src",n),e=i.dom,new xm(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)}).then(function(){return c.getOpt(t).map(function(t){var n=au({element:i});md.replaceAt(t,1,tt.some(n));var e=u.get(),o={x:0,y:0,w:i.dom.naturalWidth,h:i.dom.naturalHeight};u.set(o);var r,n=D0.inflate(o,-20,-20);return m.set(n),e.w===o.w&&e.h===o.h||(r=i,c.getOpt(t).each(function(t){var n=wu(t.element),e=mu(t.element),o=r.dom.naturalWidth,t=r.dom.naturalHeight,t=Math.min(n/o,e/t);1<=t?f.set(1):f.set(t)})),a(t,i),i})})},t=av.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[l.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:Ka([gd("image-panel-crop-events",[rr(function(t){c.getOpt(t).each(function(t){t=t.element.dom,t=V0({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,Q);t.toggleVisibility(!1),t.on("updateRect",function(t){var n=t.rect,t=f.get(),t={x:Math.round(n.x/t),y:Math.round(n.y/t),w:Math.round(n.w/t),h:Math.round(n.h/t)};m.set(t)}),d.set(tt.some(t))})})])])}],containerBehaviours:Ka([md.config({}),gd("image-panel-events",[rr(function(t){e(t,n)})])])}),c=om(t);return{memContainer:c,updateSrc:e,zoom:function(t,n){var e=f.get(),e=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);f.set(e),c.getOpt(t).each(function(t){var n=t.components()[1].element;a(t,n)})},showCrop:function(){d.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){d.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return m.get()},getMeasurements:function(){var t=u.get();return{width:t.w,height:t.h}}}},H0=function(t,n,e,o,r){return g0({name:t,icon:tt.some(n),disabled:e,tooltip:tt.some(t),primary:!1,borderless:!1},o,r)},z0=function(t,n){n?Vg.enable(t):Vg.disable(t)};var N0,L0,j0=function(t){var e,o,n,r,i=ae(t),u=ae(tt.none()),a=(o=-1,{data:e=[],add:function(t){var n=e.splice(++o);return e.push(t),{state:t,removed:n}},undo:function(){if(n())return e[--o]},redo:function(){if(r())return e[++o]},canUndo:n=function(){return 0<o},canRedo:r=function(){return-1!==o&&o<e.length-1}});a.add(t);var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},l=function(t){URL.revokeObjectURL(t.url)},f=function(){u.get().each(l),u.set(tt.none())},d=function(t){var n=s(t);c(n);t=a.add(n).removed;return Iy.each(t,l),n.url};return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:d,getTempState:function(){return u.get().fold(function(){return i.get()},function(t){return t})},updateTempState:function(t){t=s(t);return f(),u.set(tt.some(t)),t.url},addTempState:function(t){t=s(t);return u.set(tt.some(t)),t.url},applyTempState:function(n){return u.get().fold(Q,function(t){d(t.blob),n()})},destroyTempState:f,undo:function(){var t=a.undo();return c(t),t.url},redo:function(){var t=a.redo();return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}},U0=function(t,n){var o,r,i=j0(t.currentState),u=function(t){var n=i.getHistoryStates();p.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Uo(t,T0.formActionEvent,{name:T0.saveState(),value:n.undoEnabled})},a=function(t){return t.toBlob()},c=function(t){Uo(t,T0.formActionEvent,{name:T0.disable(),value:{}})},s=function(t){e.getApplyButton(t).each(function(t){Vg.enable(t)}),Uo(t,T0.formActionEvent,{name:T0.enable(),value:{}})},l=function(t,n){return c(t),g.updateSrc(t,n)},f=function(n,t,e,o,r){return c(n),yx(t).then(e).then(a).then(o).then(function(t){return l(n,t).then(function(t){return u(n),r(),s(n),t})})["catch"](function(t){return console.log(t),s(n),t})},d=function(t,n,e){var o=i.getBlobState().blob;f(t,o,n,function(t){return i.updateTempState(t)},e)},m=function(t){var n=i.getBlobState().url;return i.destroyTempState(),u(t),n},g=P0(t.currentState.url),p=(o=om(H0("Undo","undo",!0,function(t){Uo(t,_0.undo(),{direction:1})},t=n)),r=om(H0("Redo","redo",!0,function(t){Uo(t,_0.redo(),{direction:1})},t)),{container:av.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),r.asSpec(),H0("Zoom in","zoom-in",!1,function(t){Uo(t,_0.zoom(),{direction:1})},t),H0("Zoom out","zoom-out",!1,function(t){Uo(t,_0.zoom(),{direction:-1})},t)]}),updateButtonUndoStates:function(t,n,e){o.getOpt(t).each(function(t){z0(t,n)}),r.getOpt(t).each(function(t){z0(t,e)})}}),e=E0(g,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[e.memContainer.asSpec(),g.memContainer.asSpec(),p.container],behaviours:Ka([al.config({store:{mode:"manual",getValue:function(){return i.getBlobState()}}}),gd("image-tools-events",[$o(_0.undo(),function(n,t){var e=i.undo();l(n,e).then(function(t){s(n),u(n)})}),$o(_0.redo(),function(n,t){var e=i.redo();l(n,e).then(function(t){s(n),u(n)})}),$o(_0.zoom(),function(t,n){n=n.event.direction;g.zoom(t,n)}),$o(_0.back(),function(t,n){var e;t=m(e=t),l(e,t).then(function(t){s(e)}),(0,n.event.swap)(),g.hideCrop()}),$o(_0.apply(),function(t,n){i.applyTempState(function(){m(t),(0,n.event.swap)()})}),$o(_0.transform(),function(t,n){return d(t,n.event.transform,Q)}),$o(_0.tempTransform(),function(t,n){var e;e=t,t=n.event.transform,n=i.getTempState().blob,f(e,n,t,function(t){return i.addTempState(t)},Q)}),$o(_0.transformApply(),function(t,n){var e,o;e=t,o=n.event.transform,t=n.event.swap,n=i.getBlobState().blob,f(e,n,o,function(t){t=i.addBlobState(t);return m(e),t},t)}),$o(_0.swap(),function(n,t){p.updateButtonUndoStates(n,!1,!1);var e=t.event.transform,o=t.event.swap;e.fold(function(){o()},function(t){d(n,t,o)})})]),Ey()])}},W0=function(t){return!Bt(t,"items")},G0="data-value",X0=function(n,e,t,o){return F(t,function(t){return W0(t)?{type:"togglemenuitem",text:t.text,value:t.value,active:t.value===o,onAction:function(){al.setValue(n,t.value),Uo(n,hv,{name:e}),hd.focus(n)}}:{type:"nestedmenuitem",text:t.text,getSubmenuItems:function(){return X0(n,e,t.items,o)}}})},Y0=function(t,n){return J(t,function(t){return W0(t)?Kl(t.value===n,t):Y0(t.items,n)})},q0=Yl({name:"HtmlSelect",configFields:[Pn("options"),po("selectBehaviours",[hd,al]),$n("selectClasses",[]),$n("selectAttributes",{}),Gn("data")],factory:function(e,t){var n=F(e.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),o=e.data.map(function(t){return Xt("initialValue",t)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:sl(e.selectBehaviours,[hd.config({}),al.config({store:Z({mode:"manual",getValue:function(t){return Qi(t.element)},setValue:function(t,n){H(e.options,function(t){return t.value===n}).isSome()&&Zi(t.element,n)}},o)})])}}}),K0=function(e,n){var t=e.label.map(function(t){return pv(t,n)}),o=[Vg.config({disabled:function(){return e.disabled||n.isDisabled()}}),ap(),cd.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(t){return jo(t,xv),tt.some(!0)}}),gd("textfield-change",[$o(so(),function(t,n){Uo(t,hv,{name:e.name})}),$o(yo(),function(t,n){Uo(t,hv,{name:e.name})})]),lv.config({})],r=e.validation.map(function(e){return Wv.config({getRoot:function(t){return br(t.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var n=al.getValue(t),t=e.validator(n);return Vv(!0===t?it.value(n):it.error(t))},validateOnLoad:e.validateOnLoad}})}).toArray(),i=e.placeholder.fold(W({}),function(t){return{placeholder:n.translate(t)}}),u=e.inputMode.fold(W({}),function(t){return{inputmode:t}}),u=Z(Z({},i),u),u=sv.parts.field({tag:!0===e.multiline?"textarea":"input",inputAttributes:u,inputClasses:[e.classname],inputBehaviours:Ka(et([o,r])),selectOnFocus:!1,factory:Ev}),o=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),r=[Vg.config({disabled:function(){return e.disabled||n.isDisabled()},onDisabled:function(t){sv.getField(t).each(Vg.disable)},onEnabled:function(t){sv.getField(t).each(Vg.enable)}}),ap()];return dv(t,u,o,r)},Ro=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return qo([$o(t.event,e),ir(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[$o(t,function(){return n.cancel()})]}).getOr([])))}}),Cr=function(t){var n=ae(null);return pi({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},nc=Object.freeze({__proto__:null,throttle:Cr,init:function(t){return t.stream.streams.state(t)}}),ja=[Hn("stream",Tn("mode",{throttle:[Pn("delay"),$n("stopEvent",!0),la("streams",{setup:function(t,n){var e=t.stream,o=sm(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:Cr})]})),$n("event","input"),Gn("cancelEvent"),sa("onStream")],J0=$a({fields:ja,name:"streaming",active:Ro,state:nc}),$0=function(t,n,e){e=al.getValue(e);al.setValue(n,e),Z0(n)},Q0=function(t,n){var e=t.element,o=Qi(e),t=e.dom;"number"!==Ur(e,"type")&&n(t,o)},Z0=function(t){Q0(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},tw=function(t,n,o){if(t.selectsOver){var e=al.getValue(n),r=t.getDisplayText(e),e=al.getValue(o);return 0===t.getDisplayText(e).indexOf(r)?tt.some(function(){var e;$0(0,n,o),e=r.length,Q0(n,function(t,n){return t.setSelectionRange(e,n.length)})}):tt.none()}return tt.none()},nw=W("alloy.typeahead.itemexecute"),e=W([Gn("lazySink"),Pn("fetch"),$n("minChars",5),$n("responseTime",1e3),aa("onOpen"),$n("getHotspot",tt.some),$n("getAnchorOverrides",W({})),$n("layouts",tt.none()),$n("eventOrder",{}),ie("model",{},[$n("getDisplayText",function(t){return t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.value}),$n("selectsOver",!0),$n("populateFromBrowse",!0)]),aa("onSetValue"),ca("onExecute"),aa("onItemExecute"),$n("inputClasses",[]),$n("inputAttributes",{}),$n("inputStyles",{}),$n("matchWidth",!0),$n("useMinWidth",!1),$n("dismissOnBlur",!0),ia(["openClass"]),Gn("initialData"),po("typeaheadBehaviours",[hd,al,J0,cd,Od,Gv]),mn("previewing",function(){return ae(!0)})].concat(ma()).concat(fu())),Cr=W([Dn({schema:[ra()],name:"menu",overrides:function(o){return{fakeFocus:!0,onHighlight:function(n,e){o.previewing.get()?n.getSystem().getByUid(o.uid).each(function(t){tw(o.model,t,e).fold(function(){return af.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&$0(o.model,t,e)}),o.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(o.uid).toOptional().map(function(t){return Uo(t,nw(),{item:n}),!0})},onHover:function(t,n){o.previewing.set(!1),t.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&$0(o.model,t,n)})}}}})]),ew=il({name:"Typeahead",configFields:e(),partFields:Cr(),factory:function(r,t,n,i){var e=function(t,n,e){r.previewing.set(!1);var o=Gv.getCoupled(t,"sandbox");Ks.isOpen(o)?$l.getCurrent(o).each(function(t){af.getHighlighted(t).fold(function(){e(t)},function(){Yo(o,t.element,"keydown",n)})}):tb(r,u(t),t,o,i,function(t){$l.getCurrent(t).each(e)},Dv.HighlightFirst).get(Q)},o=_v(r),u=function(e){return function(t){return t.map(function(t){var n=Et(t.menus),n=N(n,function(t){return R(t.items,function(t){return"item"===t.type})});return al.getState(e).update(F(n,function(t){return t.data})),t})}},a=[hd.config({}),al.config({onSetValue:r.onSetValue,store:Z({mode:"dataset",getDataKey:function(t){return Qi(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,n){Zi(t.element,r.model.getDisplayText(n))}},r.initialData.map(function(t){return Xt("initialValue",t)}).getOr({}))}),J0.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(t,n){var e,o=Gv.getCoupled(t,"sandbox");hd.isFocused(t)&&Qi(t.element).length>=r.minChars&&(e=$l.getCurrent(o).bind(function(t){return af.getHighlighted(t).map(al.getValue)}),r.previewing.set(!0),tb(r,u(t),t,o,i,function(t){$l.getCurrent(o).each(function(t){e.fold(function(){r.model.selectsOver&&af.highlightFirst(t)},function(n){af.highlightBy(t,function(t){return al.getValue(t).value===n.value}),af.getHighlighted(t).orThunk(function(){return af.highlightFirst(t),tt.none()})})})},Dv.HighlightFirst).get(Q))},cancelEvent:_o()}),cd.config({mode:"special",onDown:function(t,n){return e(t,n,af.highlightFirst),tt.some(!0)},onEscape:function(t){t=Gv.getCoupled(t,"sandbox");return Ks.isOpen(t)?(Ks.close(t),tt.some(!0)):tt.none()},onUp:function(t,n){return e(t,n,af.highlightLast),tt.some(!0)},onEnter:function(n){var t=Gv.getCoupled(n,"sandbox"),e=Ks.isOpen(t);if(e&&!r.previewing.get())return $l.getCurrent(t).bind(function(t){return af.getHighlighted(t)}).map(function(t){return Uo(n,nw(),{item:t}),!0});var o=al.getValue(n);return jo(n,_o()),r.onExecute(t,n,o),e&&Ks.close(t),tt.some(!0)}}),Od.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),Gv.config({others:{sandbox:function(t){return ub(r,t,{onOpen:function(){return Od.on(t)},onClose:function(){return Od.off(t)}})}}}),gd("typeaheadevents",[ar(function(t){var n=Q;eb(r,u(t),t,i,n,Dv.HighlightFirst).get(Q)}),$o(nw(),function(t,n){var e=Gv.getCoupled(t,"sandbox");$0(r.model,t,n.event.item),jo(t,_o()),r.onItemExecute(t,e,n.event.item,al.getValue(t)),Ks.close(e),Z0(t)})].concat(r.dismissOnBlur?[$o(bo(),function(t){t=Gv.getCoupled(t,"sandbox");rc(t.element).isNone()&&Ks.close(t)})]:[]))];return{uid:r.uid,dom:Tv(Rt(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:Z(Z({},o),sl(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),ow=function(i){return Z(Z({},i),{toCached:function(){return ow(i.toCached())},bindFuture:function(n){return ow(i.bind(function(t){return t.fold(function(t){return Vv(it.error(t))},function(t){return n(t)})}))},bindResult:function(n){return ow(i.map(function(t){return t.bind(n)}))},mapResult:function(n){return ow(i.map(function(t){return t.map(n)}))},mapError:function(n){return ow(i.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return i.map(function(t){return t.fold(n,e)})},withTimeout:function(t,r){return ow(Rv(function(n){var e=!1,o=setTimeout(function(){e=!0,n(it.error(r()))},t);i.get(function(t){e||(clearTimeout(o),n(t))})}))}})},rw=function(t){return ow(Rv(t))},ja=function(t){return ow(Vv(it.value(t)))},iw=rw,uw={type:"separator"},aw=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:Q}},cw=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:undefined},onAction:Q}},sw=function(t,n){return e=t,n=R(n,function(t){return t.type===e}),F(n,aw);var e},lw=function(t,n){var e=t.toLowerCase();return R(n,function(t){var n=(t.meta!==undefined&&t.meta.text!==undefined?t.meta:t).text;return ve(n.toLowerCase(),e)||ve(t.value.toLowerCase(),e)})},fw=function(e,t,o){var t=al.getValue(t),r=t.meta.text!==undefined?t.meta.text:t.value;return o.getLinkInformation().fold(function(){return[]},function(t){var n,n=lw(r,(n=o.getHistory(e),F(n,function(t){return cw(t,t)})));return"file"===e?(t=[n,lw(r,sw("header",t.targets)),lw(r,et([tt.from(t.anchorTop).map(function(t){return cw("<top>",t)}).toArray(),sw("anchor",t.targets),tt.from(t.anchorBottom).map(function(t){return cw("<bottom>",t)}).toArray()]))],P(t,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(uw,n)},[])):n})},dw=Qr("aria-invalid"),mw=function(r,n,e){var t,o,i,u,a=n.shared.providers,c=function(t){t=al.getValue(t);e.addToHistory(t.value,r.filetype)},s=sv.parts.field({factory:ew,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":dw,type:"url"},minChars:0,responseTime:0,fetch:function(t){t=fw(r.filetype,t,e),t=c0(t,Hm.BUBBLE_TO_SANDBOX,n,!1);return Vv(t)},getHotspot:function(t){return p.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(Wv)&&Wv.run(t).get(Q)},typeaheadBehaviours:Ka(et([e.getValidationHandler().map(function(o){return Wv.config({getRoot:function(t){return br(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){f.getOpt(t).each(function(t){jr(t.element,"title",a.translate(n))})}},validator:{validate:function(t){var n=al.getValue(t);return iw(function(e){o({type:r.filetype,url:n.value},function(t){var n;"invalid"===t.status?(n=it.error(t.message),e(n)):(t=it.value(t.message),e(t))})})},validateOnLoad:!1}})}).toArray(),[Vg.config({disabled:function(){return r.disabled||a.isDisabled()}}),lv.config({}),gd("urlinput-events",et(["file"===r.filetype?[$o(so(),function(t){Uo(t,hv,{name:r.name})})]:[],[$o(lo(),function(t){Uo(t,hv,{name:r.name}),c(t)}),$o(yo(),function(t){Uo(t,hv,{name:r.name}),c(t)})]]))]])),eventOrder:((d={})[so()]=["streaming","urlinput-events","invalidating"],d),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Zm(0,0,"normal")},onExecute:function(t,n,e){Uo(n,xv,{})},onItemExecute:function(t,n,e,o){c(t),Uo(t,hv,{name:r.name})}}),l=r.label.map(function(t){return pv(t,a)}),f=om((t="invalid",o=tt.some(dw),void 0===u&&(u=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:im(i=void 0===(i="warning")?t:i,a.icons),attributes:Z({title:a.translate(u),"aria-live":"polite"},o.fold(function(){return{}},function(t){return{id:t}}))}})),d=om({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),m=e.getUrlPicker(r.filetype),g=Qr("browser.url.event"),p=om({dom:{tag:"div",classes:["tox-control-wrap"]},components:[s,d.asSpec()],behaviours:Ka([Vg.config({disabled:function(){return r.disabled||a.isDisabled()}})])}),h=om(h0({name:r.name,icon:tt.some("browse"),text:r.label.getOr(""),disabled:r.disabled,primary:!1,borderless:!0},function(t){return jo(t,g)},a,[],["tox-browse-url"]));return sv.sketch({dom:gv([]),components:l.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:et([[p.asSpec()],m.map(function(){return h.asSpec()}).toArray()])}]),fieldBehaviours:Ka([Vg.config({disabled:function(){return r.disabled||a.isDisabled()},onDisabled:function(t){sv.getField(t).each(Vg.disable),h.getOpt(t).each(Vg.disable)},onEnabled:function(t){sv.getField(t).each(Vg.enable),h.getOpt(t).each(Vg.enable)}}),ap(),gd("url-input-events",[$o(g,function(o){$l.getCurrent(o).each(function(n){var t=al.getValue(n),e=Z({fieldname:r.name},t);m.each(function(t){t(e).get(function(t){al.setValue(n,t),Uo(o,hv,{name:r.name})})})})})])])})},gw=function(r){return function(n,e,o){return Dt(e,"name").fold(function(){return r(e,o)},function(t){return n.field(t,r(e,o))})}},pw={bar:gw(function(t,n){return n=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:F(t.items,n.interpreter)}}),collection:gw(function(t,n){return Ov(t,n.shared.providers)}),alertbanner:gw(function(t,n){return e=t,n=n.shared.providers,av.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[em.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:im(e.icon,n.icons),attributes:{title:n.translate(e.iconTooltip)}},action:function(t){Uo(t,yv,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(e.text)}}]});var e}),input:gw(function(t,n){return t=t,n=n.shared.providers,K0({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:tt.none(),maximized:t.maximized},n)}),textarea:gw(function(t,n){return t=t,n=n.shared.providers,K0({name:t.name,multiline:!0,label:t.label,inputMode:tt.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:tt.none(),maximized:t.maximized},n)}),label:gw(function(t,n){return e=t,t=n.shared,n={dom:{tag:"label",innerHtml:t.providers.translate(e.label),classes:["tox-label"]}},t=F(e.items,t.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[n].concat(t),behaviours:Ka([Ey(),md.config({}),Ny(tt.none()),cd.config({mode:"acyclic"})])};var e}),iframe:(N0=function(t,n){return $y(t,n.shared.providers)},function(t,n,e){n=Rt(n,{source:"dynamic"});return gw(N0)(t,n,e)}),button:gw(function(t,n){return y0(t,n.shared.providers)}),checkbox:gw(function(t,n){return e=t,o=n.shared.providers,r=al.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),t=function(t){return t.element.dom.click(),tt.some(!0)},n=sv.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Ka([Ey(),Vg.config({disabled:function(){return e.disabled||o.isDisabled()}}),lv.config({}),hd.config({}),r,cd.config({mode:"special",onEnter:t,onSpace:t,stopSpaceKeyup:!0}),gd("checkbox-events",[$o(lo(),function(t,n){Uo(t,hv,{name:e.name})})])])}),r=sv.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:Ka([sb.config({})])}),t=om({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(t=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:im("checked"===t?"selected":"unselected",o.icons)}}})("checked"),t("unchecked")]}),sv.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[n,t.asSpec(),r],fieldBehaviours:Ka([Vg.config({disabled:function(){return e.disabled||o.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){sv.getField(t).each(Vg.disable)},onEnabled:function(t){sv.getField(t).each(Vg.enable)}}),ap()])});var e,o,r}),colorinput:gw(function(t,n){return mb(t,n.shared,n.colorinput)}),colorpicker:gw(function(t){var n=function(t){return"tox-"+t},n=Ty(My,n),o=om(n.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Uo(t,yv,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Uo(t,yv,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:Ka([al.config({store:{mode:"manual",getValue:function(t){t=o.get(t);return $l.getCurrent(t).bind(function(t){return al.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),t=o.get(t);$l.getCurrent(t).fold(function(){console.log("Can not find form")},function(t){al.setValue(t,{hex:tt.from(e[1]).getOr("")}),xy.getField(t,"hex").each(function(t){jo(t,so())})})}}}),Ey()])}}),dropzone:gw(function(t,n){return jy(t,n.shared.providers)}),grid:gw(function(t,n){return n=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:F(t.items,n.interpreter)}}),listbox:gw(function(t,n){return e=t,r=(o=n).shared.providers,i=Y(e.items).filter(W0),t=e.label.map(function(t){return pv(t,r)}),n={dom:{tag:"div",classes:["tox-listboxfield"]},components:[sv.parts.field({dom:{},factory:{sketch:function(t){return e0({uid:t.uid,text:i.map(function(t){return t.text}),icon:tt.none(),tooltip:e.label,role:tt.none(),fetch:function(t,n){t=X0(t,e.name,e.items,al.getValue(t));n(c0(t,Hm.CLOSE_ON_EXECUTE,o,!1))},onSetup:W(Q),getApi:W({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[lv.config({}),al.config({store:{mode:"manual",initialValue:i.map(function(t){return t.value}).getOr(""),getValue:function(t){return Ur(t.element,G0)},setValue:function(n,t){Y0(e.items,t).each(function(t){jr(n.element,G0,t.value),Uo(n,t0,{text:t.text})})}}})]},"tox-listbox",o.shared)}}})]},sv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:et([t.toArray(),[n]]),fieldBehaviours:Ka([Vg.config({disabled:W(e.disabled),onDisabled:function(t){sv.getField(t).each(Vg.disable)},onEnabled:function(t){sv.getField(t).each(Vg.enable)}})])});var e,o,r,i}),selectbox:gw(function(t,n){return e=t,o=n.shared.providers,r=F(e.items,function(t){return{text:o.translate(t.text),value:t.value}}),t=e.label.map(function(t){return pv(t,o)}),n=sv.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:q0,selectBehaviours:Ka([Vg.config({disabled:function(){return e.disabled||o.isDisabled()}}),lv.config({}),gd("selectbox-change",[$o(lo(),function(t,n){Uo(t,hv,{name:e.name})})])])}),r=1<e.size?tt.none():tt.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:im("chevron-down",o.icons)}}),r={dom:{tag:"div",classes:["tox-selectfield"]},components:et([[n],r.toArray()])},sv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:et([t.toArray(),[r]]),fieldBehaviours:Ka([Vg.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){sv.getField(t).each(Vg.disable)},onEnabled:function(t){sv.getField(t).each(Vg.enable)}}),ap()])});var e,o,r}),sizeinput:gw(function(t,n){return O0(t,n.shared.providers)}),urlinput:gw(function(t,n){return mw(t,n,n.urlinput)}),customeditor:gw(function(e){var o=ae(tt.none()),n=om({dom:{tag:e.tag}}),r=ae(tt.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Ka([gd("custom-editor-events",[rr(function(t){n.getOpt(t).each(function(n){(Object.prototype.hasOwnProperty.call(e,"init")?e.init(n.element.dom):Fy.load(e.scriptId,e.scriptUrl).then(function(t){return t(n.element.dom,e.settings)})).then(function(n){r.get().each(function(t){n.setValue(t)}),r.set(tt.none()),o.set(tt.some(n))})})})]),al.config({store:{mode:"manual",getValue:function(){return o.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,n){o.get().fold(function(){r.set(tt.some(n))},function(t){return t.setValue(n)})}}}),Ey()]),components:[n.asSpec()]}}),htmlpanel:gw(function(t){return"presentation"===t.presets?av.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):av.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Ka([lv.config({}),hd.config({})])})}),imagetools:gw(function(t,n){return U0(t,n.shared.providers)}),table:gw(function(t,n){return o=t,e=n.shared.providers,r=function(t){return{dom:{tag:"td",innerHtml:e.translate(t)}}},t=function(t){return{dom:{tag:"tr"},components:F(t,r)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(n=o.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:F(n,function(t){return{dom:{tag:"th",innerHtml:e.translate(t)}}})}]}),(o=o.cells,{dom:{tag:"tbody"},components:F(o,t)})],behaviours:Ka([lv.config({}),hd.config({})])};var e,o,r}),panel:gw(function(t,n){return{dom:{tag:"div",classes:t.classes},components:F(t.items,n.shared.interpreter)}})},hw={field:function(t,n){return n}},vw=function(n,t,e){var o=Rt(e,{shared:{interpreter:function(t){return bw(n,t,o)}}});return bw(n,t,o)},bw=function(n,e,o){return Dt(pw,e.type).fold(function(){return console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e},function(t){return t(n,e,o)})},yw={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},xw=function(t,n,e){var o=_c(-12,12,yw),r={maxHeightFunction:wc()};return function(){return e()?{anchor:"node",root:Tr(t()),node:tt.from(t()),bubble:o,layouts:{onRtl:function(){return[Qd]},onLtr:function(){return[$d]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[Ea]},onLtr:function(){return[Da]}},overrides:r}}},ww=function(t,n,e){return function(){return e()?{anchor:"node",root:Tr(t()),node:tt.from(t()),layouts:{onRtl:function(){return[Zd]},onLtr:function(){return[Zd]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Fa]},onLtr:function(){return[Fa]}}}}},Sw=function(t,n,e){var o,r,i,u=Zg(t),a=function(){return se.fromDom(t.getBody())},c=function(){return se.fromDom(t.getContentAreaContainer())},s=function(){return u||!e()};return{inlineDialog:xw(c,n,s),banner:ww(c,n,s),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return tt.some(Kc.range(se.fromDom(t.startContainer),t.startOffset,se.fromDom(t.endContainer),t.endOffset))}}}),node:(o=i=a,function(t){return{anchor:"node",root:o(),node:t}})}},kw=function(t){return{colorPicker:function(t,n){bh(r)(t,n)},hasCustomColors:function(){return ah(o)},getColors:function(){return ch(e)},getColorCols:(n=e=o=r=t,function(){return fh(n)})};var n,e,o,r},Cw=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],Ow=function(t){return P(t,function(t,n){if(Bt(n,"items")){var e=Ow(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(Bt(n,"inline")||Bt(n,"block")||Bt(n,"selector")){e="custom-"+(v(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:e,format:n}]),formats:t.formats.concat([{title:n.title,format:e,icon:n.icon}])}}return Z(Z({},t),{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},_w=function(r){return tt.from(r.getParam("style_formats")).filter(c).map(function(t){var n,e,o,t=(n=r,e=Ow(t),o=function(t){nt(t,function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)})},n.formatter?o(e.customFormats):n.on("init",function(){o(e.customFormats)}),e.formats);return r.getParam("style_formats_merge",!1,"boolean")?Cw.concat(t):t}).getOr(Cw)},Tw=function(t,n,e){e={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Rt(t,e)},Ew=function(r,t,i,u){var a=function(t){return F(t,function(t){var n,e=xt(t);if(At(t,"items")){var o=a(t.items);return Rt(Rt(t,{type:"submenu"}),{getStyleItems:function(){return o}})}return At(t,"format")?Tw(t,i,u):1===e.length&&D(e,"title")?Rt(t,{type:"separator"}):(e=v((n=t).name)?n.name:Qr(n.title),t={type:"formatter",format:t="custom-"+e,isSelected:i(t),getStylePreview:u(t)},t=Rt(n,t),r.formatter.register(e,t),t)})};return a(t)},Dw=Iy.trim,Ro=function(e){return function(t){if(i(n=t)&&1===n.nodeType){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}var n;return!1}},Bw=Ro("true"),Aw=Ro("false"),Mw=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},Fw=function(t){return t.innerText||t.textContent},Iw=function(t){return(n=t)&&"A"===n.nodeName&&(n.id||n.name)!==undefined&&Vw(t);var n},Rw=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},Vw=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return Bw(t)}return!1}(t)&&!Aw(t)},Pw=function(t){return Rw(t)&&Vw(t)},Hw=function(t){var n,e=t.id||Qr("h");return Mw("header",Fw(t),"#"+e,Rw(n=t)?parseInt(n.nodeName.substr(1),10):0,function(){t.id=e})},zw=function(t){var n=t.id||t.name,t=Fw(t);return Mw("anchor",t||"#"+n,"#"+n,0,Q)},Nw=function(t){var n;return n="h1,h2,h3,h4,h5,h6,a:not([href])",F(as(se.fromDom(t),n),function(t){return t.dom})},Lw=function(t){return 0<Dw(t.title).length},jw=function(t){t=Nw(t);return R(F(R(t,Pw),Hw).concat(F(R(t,Iw),zw)),Lw)},Uw="tinymce-url-history",Ww=function(t){return v(t)&&/^https?/.test(t)},Gw=function(t){return b(t)&&Tt(t,function(t){return!(c(t=t)&&t.length<=5&&L(t,Ww))}).isNone()},Xw=function(){var t,n=th.getItem(Uw);if(null===n)return{};try{t=JSON.parse(n)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+Uw+" was not valid JSON",e),{};throw e}return Gw(t)?t:(console.log("Local storage "+Uw+" was not valid format",t),{})},Yw=function(t){var n=Xw();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},qw=function(n,t){var e,o;Ww(n)&&(e=Xw(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],o=R(o,function(t){return t!==n}),e[t]=[n].concat(o).slice(0,5),function(t){if(!Gw(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));th.setItem(Uw,JSON.stringify(t))}(e))},Kw=function(t){return!!t},Jw=function(t){return kt(Iy.makeMap(t,/[, ]/),Kw)},$w=function(t){return tt.from(t.getParam("file_picker_callback")).filter(f)},Qw=function(t,n){var e,o,r,i,e=(e=t,o=tt.some(e.getParam("file_picker_types")).filter(Kw),r=tt.some(e.getParam("file_browser_callback_types")).filter(Kw),i=o.or(r).map(Jw),$w(e).fold(l,function(t){return i.fold(S,function(t){return 0<xt(t).length&&t})}));return y(e)?e?$w(t):tt.none():e[n]?$w(t):tt.none()},Zw=function(t){return tt.from(t).filter(v).getOrUndefined()},tS=function(t){return tt.from((t=(n=t).getParam("file_picker_validator_handler",undefined,"function"))===undefined?n.getParam("filepicker_validator_handler",undefined,"function"):t);var n},nS=function(n){return{getHistory:Yw,addToHistory:qw,getLinkInformation:function(){return!1===(t=n).getParam("typeahead_urls")?tt.none():tt.some({targets:jw(t.getBody()),anchorTop:Zw(t.getParam("anchor_top","#top")),anchorBottom:Zw(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return tS(n)},getUrlPicker:function(t){return Qw(r=n,i=t).map(function(o){return function(n){return Rv(function(e){var t=Z({filetype:i,fieldname:n.fieldname},tt.from(n.meta).getOr({}));o.call(r,function(t,n){if(!v(t))throw new Error("Expected value to be string");if(n!==undefined&&!b(n))throw new Error("Expected meta to be a object");e({value:t,meta:n})},n.value,t)})}});var r,i}}},eS=function(t,n,e){var o,r,i=ae(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=ae($g(n)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Og.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return bw(hw,t,a)},anchors:Sw(n,e,u.isPositionedAtTop),header:u,getSink:function(){return it.value(t)}},urlinput:nS(n),styleselect:function(e){var o=function(t){return function(){return e.formatter.match(t)}},r=function(n){return function(){var t=e.formatter.get(n);return t!==undefined?tt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))}):tt.none()}},i=function(t){var n=t.items;return n!==undefined&&0<n.length?N(n,i):[t.format]},u=ae([]),a=ae([]),c=ae([]),s=ae([]),l=ae(!1);e.on("PreInit",function(t){var n=_w(e),n=Ew(e,n,o,r);u.set(n),a.set(N(n,i))}),e.on("addStyleModifications",function(t){var n=Ew(e,t.items,o,r);c.set(n),l.set(t.replace),s.set(N(n,i))});return{getData:function(){var t=l.get()?[]:u.get(),n=c.get();return t.concat(n)},getFlattenedKeys:function(){var t=l.get()?[]:a.get(),n=s.get();return t.concat(n)}}}(n),colorinput:kw(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return a},oS=W(function(t,n){!function(t,n){n=xu.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Ui(t,"max-width",n+"px")}(t,Math.floor(n))}),rS="contexttoolbar-hide",nc=W([Pn("dom"),$n("shell",!0),po("toolbarBehaviours",[md])]),ma=W([Cl({name:"groups",overrides:function(){return{behaviours:Ka([md.config({})])}}})]),iS=il({name:"Toolbar",configFields:nc(),partFields:ma(),factory:function(n,t,e,o){var r=function(t){return n.shell?tt.some(t):Il(t,n,"groups")},t=n.shell?{behaviours:[md.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:t.components,behaviours:sl(n.toolbarBehaviours,t.behaviours),apis:{setGroups:function(t,n){r(t).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){md.set(t,n)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),uS=function(t,n,e){return{within:t,extra:n,withinWidth:e}},aS=function(t,n,o){var e,r=(e=function(t,n){var e=o(t);return tt.some({element:t,start:n,finish:n+e,width:e})},P(t,function(n,t){return e(t,n.len).fold(W(n),function(t){return{len:t.finish,list:n.list.concat([t])}})},{len:0,list:[]}).list),i=R(r,function(t){return t.finish<=n}),t=V(i,function(t,n){return t+n.width},0);return{within:i,extra:r.slice(i.length),withinWidth:t}},cS=function(t){return F(t,function(t){return t.element})},sS=function(t,n,e,o){var r=function(t,n,e){e=aS(n,t,e);return 0===e.extra.length?tt.some(e):tt.none()}(t,n,e).getOrThunk(function(){return aS(n,t-e(o),e)}),i=r.within,u=r.extra,r=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?function(t,n,e){n=cS(t.concat(n));return uS(n,[],e)}(i,u,r):1<=u.length?function(t,n,e,o){e=cS(t).concat([e]);return uS(e,cS(n),o)}(i,u,o,r):(r=r,uS(cS(i),[],r))},lS=function(t,n){n=F(n,function(t){return lu(t)});iS.setGroups(t,n)},fS=function(t,n,e){var o=Rl(t,n,"primary"),r=Gv.getCoupled(t,"overflowGroup");Ui(o.element,"visibility","hidden");var i=n.builtGroups.get().concat([r]),t=J(i,function(n){return rc(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()})});e([]),lS(o,i);i=wu(o.element),n=sS(i,n.builtGroups.get(),function(t){return wu(t.element)},r);0===n.extra.length?(md.remove(o,r),e([])):(lS(o,n.within),e(n.extra)),Ji(o.element,"visibility"),$i(o.element),t.each(hd.focus)},e=W([po("splitToolbarBehaviours",[Gv]),mn("builtGroups",function(){return ae([])})]),Cr=W([ia(["overflowToggledClass"]),Kn("getOverflowBounds"),Pn("lazySink"),mn("overflowGroups",function(){return ae([])})].concat(e())),ja=W([kl({factory:iS,schema:nc(),name:"primary"}),Dn({schema:nc(),name:"overflow"}),Dn({name:"overflow-button"}),Dn({name:"overflow-group"})]),Ro=W([ia(["toggledClass"]),Pn("lazySink"),Ln("fetch"),Kn("getBounds"),Jn("fireDismissalEventInstead",[$n("event",Io())]),xe()]),ma=W([Dn({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Ka([Od.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Dn({factory:iS,schema:nc(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:Ka([cd.config({mode:"cyclic",onEscape:function(t){return Il(t,n,"button").each(hd.focus),tt.none()}})])}}})]),dS=function(t,n){t=Gv.getCoupled(t,"toolbarSandbox");Ks.isOpen(t)?Ks.close(t):Ks.open(t,n.toolbar())},mS=function(t,n,e,o){var r=e.getBounds.map(function(t){return t()}),e=e.lazySink(t).getOrDie();Bs.positionWithinBounds(e,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:oS()}},n,r)},gS=function(t,n,e,o,r){iS.setGroups(n,r),mS(t,n,e,o),Od.on(t)},pS=il({name:"FloatingToolbarButton",factory:function(u,t,a,n){return Z(Z({},em.sketch(Z(Z({},n.button()),{action:function(t){dS(t,n)},buttonBehaviours:fl({dump:n.button().buttonBehaviours},[Gv.config({others:{toolbarSandbox:function(t){return o=t,e=a,r=u,{dom:{tag:"div",attributes:{id:(i=Gu()).id}},behaviours:Ka([cd.config({mode:"special",onEscape:function(t){return Ks.close(t),tt.some(!0)}}),Ks.config({onOpen:function(t,n){r.fetch().get(function(t){gS(o,n,r,e.layouts,t),i.link(o.element),cd.focusIn(n)})},onClose:function(){Od.off(o),hd.focus(o),i.unlink(o.element)},isPartOf:function(t,n,e){return Yu(n,e)||Yu(o,e)},getAttachPoint:function(){return r.lazySink(o).getOrDie()}}),tc.config({channels:Z(Z({},tl(Z({isExtraPart:l},r.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),el({doReposition:function(){Ks.getState(Gv.getCoupled(o,"toolbarSandbox")).each(function(t){mS(o,t,r,e.layouts)})}}))})])};var o,e,r,i}}})])}))),{apis:{setGroups:function(n,e){Ks.getState(Gv.getCoupled(n,"toolbarSandbox")).each(function(t){gS(n,t,u,a.layouts,e)})},reposition:function(n){Ks.getState(Gv.getCoupled(n,"toolbarSandbox")).each(function(t){mS(n,t,u,a.layouts)})},toggle:function(t){dS(t,n)},getToolbar:function(t){return Ks.getState(Gv.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return Ks.isOpen(Gv.getCoupled(t,"toolbarSandbox"))}}})},configFields:Ro(),partFields:ma(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),Ro=W([Pn("items"),ia(["itemSelector"]),po("tgroupBehaviours",[cd])]),ma=W([It({name:"items",unit:"item"})]),hS=il({name:"ToolbarGroup",configFields:Ro(),partFields:ma(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:sl(t.tgroupBehaviours,[cd.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),vS=function(t){return F(t,function(t){return lu(t)})},bS=function(t,e,o){fS(t,o,function(n){o.overflowGroups.set(n),e.getOpt(t).each(function(t){pS.setGroups(t,vS(n))})})},yS=il({name:"SplitFloatingToolbar",configFields:Cr(),partFields:ja(),factory:function(e,t,n,o){var r=om(pS.sketch({fetch:function(){return Rv(function(t){t(vS(e.overflowGroups.get()))})},layouts:{onLtr:function(){return[Da,Ea]},onRtl:function(){return[Ea,Da]},onBottomLtr:function(){return[Aa,Ba]},onBottomRtl:function(){return[Ba,Aa]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:sl(e.splitToolbarBehaviours,[Gv.config({others:{overflowGroup:function(){return hS.sketch(Z(Z({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(F(n,t.getSystem().build)),bS(t,r,e)},refresh:function(t){return bS(t,r,e)},toggle:function(t){r.getOpt(t).each(function(t){pS.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(pS.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){pS.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(pS.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),xS=function(n,t){return t.getAnimationRoot.fold(function(){return n.element},function(t){return t(n)})},wS=function(t){return t.dimension.property},SS=function(t,n){return t.dimension.getDimension(n)},kS=function(t,n){t=xS(t,n);Vi(t,[n.shrinkingClass,n.growingClass])},CS=function(t,n){Fi(t.element,n.openClass),Ai(t.element,n.closedClass),Ui(t.element,wS(n),"0px"),$i(t.element)},OS=function(t,n){Fi(t.element,n.closedClass),Ai(t.element,n.openClass),Ji(t.element,wS(n))},_S=function(t,n,e,o){e.setCollapsed(),Ui(t.element,wS(n),SS(n,t.element)),$i(t.element),kS(t,n),CS(t,n),n.onStartShrink(t),n.onShrunk(t)},TS=function(t,n,e,o){o=o.getOrThunk(function(){return SS(n,t.element)});e.setCollapsed(),Ui(t.element,wS(n),o),$i(t.element);o=xS(t,n);Fi(o,n.growingClass),Ai(o,n.shrinkingClass),CS(t,n),n.onStartShrink(t)},ES=function(t,n,e){var o=SS(n,t.element);("0px"===o?_S:TS)(t,n,e,tt.some(o))},DS=function(t,n,e){var o=xS(t,n),r=Ii(o,n.shrinkingClass),i=SS(n,t.element);OS(t,n);var u=SS(n,t.element);(r?function(){Ui(t.element,wS(n),i),$i(t.element)}:function(){CS(t,n)})(),Fi(o,n.shrinkingClass),Ai(o,n.growingClass),OS(t,n),Ui(t.element,wS(n),u),e.setExpanded(),n.onStartGrow(t)},BS=function(t,n,e){t=xS(t,n);return!0===Ii(t,n.growingClass)},AS=function(t,n,e){t=xS(t,n);return!0===Ii(t,n.shrinkingClass)},ma=Object.freeze({__proto__:null,refresh:function(t,n,e){e.isExpanded()&&(Ji(t.element,wS(n)),e=SS(n,t.element),Ui(t.element,wS(n),e))},grow:function(t,n,e){e.isExpanded()||DS(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&ES(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&_S(t,n,e,tt.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:BS,isShrinking:AS,isTransitioning:function(t,n,e){return BS(t,n)||AS(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?ES:DS)(t,n,e)},disableTransitions:kS}),Cr=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return vi(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Xt(n.dimension.property,"0px")})},events:function(e,o){return qo([or(mo(),function(t,n){n.event.raw.propertyName===e.dimension.property&&(kS(t,e),o.isExpanded()&&Ji(t.element,e.dimension.property),(o.isExpanded()?e.onGrown:e.onShrunk)(t))})])}}),ja=[Pn("closedClass"),Pn("openClass"),Pn("shrinkingClass"),Pn("growingClass"),Gn("getAnimationRoot"),aa("onShrunk"),aa("onStartShrink"),aa("onGrown"),aa("onStartGrow"),$n("expanded",!1),Hn("dimension",Tn("property",{width:[la("property","width"),la("getDimension",function(t){return wu(t)+"px"})],height:[la("property","height"),la("getDimension",function(t){return mu(t)+"px"})]}))],MS=$a({fields:ja,name:"sliding",active:Cr,apis:ma,state:Object.freeze({__proto__:null,init:function(t){var n=ae(t.expanded);return pi({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:m(n.set,!1),setExpanded:m(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),e=W([ia(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),aa("onOpened"),aa("onClosed")].concat(e())),nc=W([kl({factory:iS,schema:nc(),name:"primary"}),kl({factory:iS,schema:nc(),name:"overflow",overrides:function(n){return{toolbarBehaviours:Ka([MS.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Il(t,n,"overflow-button").each(function(t){Od.off(t),hd.focus(t)}),n.onClosed(t)},onGrown:function(t){cd.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Il(t,n,"overflow-button").each(Od.on)}}),cd.config({mode:"acyclic",onEscape:function(t){return Il(t,n,"overflow-button").each(hd.focus),tt.some(!0)}})])}}}),Dn({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Ka([Od.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Dn({name:"overflow-group"})]),FS=function(n,e){Il(n,e,"overflow-button").bind(function(){return Il(n,e,"overflow")}).each(function(t){IS(n,e),MS.toggleGrow(t)})},IS=function(t,e){Il(t,e,"overflow").each(function(n){fS(t,e,function(t){t=F(t,function(t){return lu(t)});iS.setGroups(n,t)}),Il(t,e,"overflow-button").each(function(t){MS.hasGrown(n)&&Od.on(t)}),MS.refresh(n)})},RS=il({name:"SplitSlidingToolbar",configFields:e(),partFields:nc(),factory:function(e,t,n,o){var r="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:sl(e.splitToolbarBehaviours,[Gv.config({others:{overflowGroup:function(n){return hS.sketch(Z(Z({},o["overflow-group"]()),{items:[em.sketch(Z(Z({},o["overflow-button"]()),{action:function(t){jo(n,r)}}))]}))}}}),gd("toolbar-toggle-events",[$o(r,function(t){FS(t,e)})])]),apis:{setGroups:function(t,n){!function(t,n){t=F(n,t.getSystem().build);e.builtGroups.set(t)}(t,n),IS(t,e)},refresh:function(t){return IS(t,e)},toggle:function(t){return FS(t,e)},isOpen:function(t){return Il(t,e,"overflow").map(MS.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),VS=W(Qr("toolbar-height-change")),PS=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:Z({tag:"div",classes:["tox-toolbar__group"]},n),components:[hS.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Ka([lv.config({}),hd.config({})])}},HS=function(t){return hS.sketch(PS(t))},zS=function(e,t){var n=rr(function(t){var n=F(e.initGroups,HS);iS.setGroups(t,n)});return Ka([fp(e.providers.isDisabled),ap(),cd.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),gd("toolbar-events",[n])])},NS=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":PS({title:tt.none(),items:[]}),"overflow-button":m0({name:"more",icon:tt.some("more-drawer"),disabled:!1,tooltip:tt.some("More..."),primary:!1,borderless:!1},tt.none(),t.providers)},splitToolbarBehaviours:zS(t,n)}},LS=function(o){var t=NS(o),n=yS.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return yS.sketch(Z(Z({},t),{lazySink:o.getSink,getOverflowBounds:function(){var t=o.moreDrawerData.lazyHeader().element,n=Ru(t),e=hr(t),t=Ru(e),e=Math.max(e.dom.scrollHeight,t.height);return Fu(n.x+4,t.y,n.width-8,e)},parts:Z(Z({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o.attributes}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},jS=function(t){var n=RS.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=RS.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),t=NS(t);return RS.sketch(Z(Z({},t),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([VS()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([VS()],{type:"closed"})}}))},US=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return iS.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===Pm.scrolling?["tox-toolbar--scrolling"]:[])},components:[iS.parts.groups({})],toolbarBehaviours:zS(t,n)})},WS=an([zn("type"),Hn("items",sn([bn([zn("name"),Wn("items",An)]),An]))].concat(ti)),nc=[qn("text"),qn("tooltip"),qn("icon"),Ln("fetch"),oe("onSetup",function(){return Q})],GS=an(p([zn("type")],nc)),XS=function(t){return Sn("menubutton",GS,t)},YS=an([zn("type"),qn("tooltip"),qn("icon"),qn("text"),Kn("select"),Ln("fetch"),oe("onSetup",function(){return Q}),ne("presets","normal",["normal","color","listpreview"]),$n("columns",1),Ln("onAction"),Ln("onItemAction")]),ti=Object.freeze({__proto__:null,events:function(o,r){var i=function(n,e){o.updateState.each(function(t){t=t(n,e);r.set(t)}),o.renderComponents.each(function(t){t=t(e,r.get()),t=F(t,n.getSystem().build);Is(n,t)})};return qo([$o(xo(),function(t,n){var e=n;e.universal||(n=o.channel,D(e.channels,n)&&i(t,e.data))}),rr(function(n,t){o.initialData.each(function(t){i(n,t)})})])}}),nc=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),Kn=[Pn("channel"),Gn("renderComponents"),Gn("updateState"),Gn("initialData")],qS=$a({fields:Kn,name:"reflecting",active:ti,apis:nc,state:Object.freeze({__proto__:null,init:function(){var n=ae(tt.none());return{readState:function(){return n.get().fold(function(){return"none"},function(t){return t})},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(tt.none())}}}})}),xe=W([Pn("toggleClass"),Pn("fetch"),sa("onExecute"),$n("getHotspot",tt.some),$n("getAnchorOverrides",W({})),xe(),sa("onItemExecute"),Gn("lazySink"),Pn("dom"),aa("onOpen"),po("splitDropdownBehaviours",[Gv,cd,hd]),$n("matchWidth",!1),$n("useMinWidth",!1),$n("eventOrder",{}),Gn("role")].concat(fu())),sa=kl({factory:em,schema:[Pn("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Ka([hd.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(Wo)},buttonBehaviours:Ka([Od.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),fu=kl({factory:em,schema:[Pn("dom")],name:"button",defaults:function(){return{buttonBehaviours:Ka([hd.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(e.uid).each(function(t){e.onExecute(t,n)})}}}}),fu=W([sa,fu,Cl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Pn("text")],name:"aria-descriptor"}),Dn({schema:[ra()],name:"menu",defaults:function(o){return{onExecute:function(n,e){n.getSystem().getByUid(o.uid).each(function(t){o.onItemExecute(t,n,e)})}}}}),Ua()]),KS=il({name:"SplitDropdown",configFields:xe(),partFields:fu(),factory:function(o,t,n,e){var r=function(t){$l.getCurrent(t).each(function(t){af.highlightFirst(t),cd.focusIn(t)})},i=function(t){eb(o,function(t){return t},t,e,r,Dv.HighlightFirst).get(Q)},u=function(t){t=Rl(t,o,"button");return Wo(t),tt.some(!0)},a=Z(Z({},qo([rr(function(e,t){Il(e,o,"aria-descriptor").each(function(t){var n=Qr("aria");jr(t.element,"id",n),jr(e.element,"aria-describedby",n)})})])),Td(tt.some(i)));return{uid:o.uid,dom:o.dom,components:t,apis:{repositionMenus:function(t){Od.isOn(t)&&ab(t)}},eventOrder:Z(Z({},o.eventOrder),((t={})[wo()]=["disabling","toggling","alloy.base.behaviour"],t)),events:a,behaviours:sl(o.splitDropdownBehaviours,[Gv.config({others:{sandbox:function(t){var n=Rl(t,o,"arrow");return ub(o,t,{onOpen:function(){Od.on(n),Od.on(t)},onClose:function(){Od.off(n),Od.off(t)}})}}}),cd.config({mode:"special",onSpace:u,onEnter:u,onDown:function(t){return i(t),tt.some(!0)}}),hd.config({}),Od.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),JS=function(n){return{isDisabled:function(){return Vg.isDisabled(n)},setDisabled:function(t){return Vg.set(n,t)}}},$S=function(n){return{setActive:function(t){Od.set(n,t)},isActive:function(){return Od.isOn(n)},isDisabled:function(){return Vg.isDisabled(n)},setDisabled:function(t){return Vg.set(n,t)}}},QS=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},ZS=Qr("focus-button"),tk=["checklist","ordered-list"],nk=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],ek=function(n,e,t,o,r,i){var u=function(t){return Og.isRtl()&&D(tk,t)?t+"-rtl":t},a=Og.isRtl()&&n.exists(function(t){return D(nk,t)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(e.isSome()?["tox-tbtn--select"]:[]).concat(a?["tox-tbtn__icon-rtl"]:[]),attributes:QS(t,i)},components:hp([n.map(function(t){return Kx(u(t),i.icons)}),e.map(function(t){return $x(t,"tox-tbtn",i)})]),eventOrder:((t={})[to()]=["focusing","alloy.base.behaviour","common-button-display-events"],t),buttonBehaviours:Ka([fp(i.isDisabled),ap(),gd("common-button-display-events",[$o(to(),function(t,n){n.event.prevent(),jo(t,ZS)})])].concat(o.map(function(t){return qS.config({channel:t,initialData:{icon:n,text:e},renderComponents:function(t,n){return hp([t.icon.map(function(t){return Kx(u(t),i.icons)}),t.text.map(function(t){return $x(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},ok=function(t,n,e){var o,r=ae(Q),i=ek(t.icon,t.text,t.tooltip,tt.none(),tt.none(),e);return em.sketch({dom:i.dom,components:i.components,eventOrder:Zx,buttonBehaviours:Ka([gd("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},ar(function(n,t){dp(o,n)(function(t){Uo(n,Qx,{buttonApi:t}),o.onAction(t)})})),mp(n,r),gp(n,r)]),fp(function(){return t.disabled||e.isDisabled()}),ap()].concat(n.toolbarButtonBehaviours))})},rk=function(t,n,e){return ok(t,{toolbarButtonBehaviours:[].concat(0<e.length?[gd("toolbarButtonWith",e)]:[]),getApi:JS,onSetup:t.onSetup},n)},ik=function(t,n,e){return Rt(ok(t,{toolbarButtonBehaviours:[md.config({}),Od.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[gd("toolbarToggleButtonWith",e)]:[]),getApi:$S,onSetup:t.onSetup},n))},uk=function(n,t){var e,o,r,i=Qr("channel-update-split-dropdown-display"),u=function(e){return{isDisabled:function(){return Vg.isDisabled(e)},setDisabled:function(t){return Vg.set(e,t)},setIconFill:function(t,n){Uu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){jr(t,"fill",n)})},setIconStroke:function(t,n){Uu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){jr(t,"stroke",n)})},setActive:function(n){e.getSystem().isConnected()&&(jr(e.element,"aria-pressed",n),Uu(e.element,"span").each(function(t){e.getSystem().getByDom(t).each(function(t){return Od.set(t,n)})}))},isActive:function(){return Uu(e.element,"span").exists(function(t){return!!e.getSystem().isConnected()&&e.getSystem().getByDom(t).exists(Od.isOn)})}}},a=ae(Q),c={getApi:u,onSetup:n.onSetup};return KS.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:Z({"aria-pressed":!1},QS(n.tooltip,t.providers))},onExecute:function(t){n.onAction(u(t))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:Ka([lp(t.providers.isDisabled),ap(),gd("split-dropdown-events",[$o(ZS,hd.focus),mp(c,a),gp(c,a)]),sb.config({})]),eventOrder:((a={})[Mo()]=["alloy.base.behaviour","split-dropdown-events"],a),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:(e=u,o=n,r=t.providers,function(n){return Rv(function(t){return o.fetch(t)}).map(function(t){return tt.from(Nh(Rt(yh(Qr("menu-value"),t,function(t){o.onItemAction(e(n),t)},o.columns,o.presets,Hm.CLOSE_ON_EXECUTE,o.select.getOr(l),r),{movement:wh(o.columns,o.presets),menuBehaviours:bg("auto"!==o.columns?[]:[rr(function(e,t){hg(e,4,Km(o.presets)).each(function(t){var n=t.numRows,t=t.numColumns;cd.setGridSize(e,n,t)})})])})))})}),parts:{menu:Zm(0,n.columns,n.presets)},components:[KS.parts.button(ek(n.icon,n.text,tt.none(),tt.some(i),tt.some([Od.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),KS.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:im("chevron-down",t.providers.icons)},buttonBehaviours:Ka([lp(t.providers.isDisabled),ap()])}),KS.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},ak=function(o,r){return $o(Qx,function(t,n){var e,t=o.get(t),t=(e=t,{hide:function(){return jo(e,Oo())},getValue:function(){return al.getValue(e)}});r.onAction(t,n.event.buttonApi)})},ck=function(t,n,e){var o,r,i,u={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?(o=t,i=u,(e=(r=n).original).primary,e=d(e,["primary"]),e=kn(Fm(Z(Z({},e),{type:"togglebutton",onAction:Q}))),ik(e,i.backstage.shared.providers,[ak(o,r)])):(r=t,t=u,(n=(u=n).original).primary,n=d(n,["primary"]),n=kn(Am(Z(Z({},n),{type:"button",onAction:Q}))),rk(n,t.backstage.shared.providers,[ak(r,u)]))},sk=function(t,n){var e,o,r,i,u=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),u=om(Ev.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:Ka([cd.config({mode:"special",onEnter:function(t){return a.findPrimary(t).map(function(t){return Wo(t),!0})},onLeft:function(t,n){return n.cut(),tt.none()},onRight:function(t,n){return n.cut(),tt.none()}})])})),a=(e=u,o=t.commands,r=n,i=F(o,function(t){return om(ck(e,t,r))}),{asSpecs:function(){return F(i,function(t){return t.asSpec()})},findPrimary:function(e){return J(o,function(t,n){return t.primary?tt.from(i[n]).bind(function(t){return t.getOpt(e)}).filter(x(Vg.isDisabled)):tt.none()})}});return[{title:tt.none(),items:[u.asSpec()]},{title:tt.none(),items:a.asSpecs()}]},lk=sk,fk=function(t,n){var e,o,r,i=Du(window),u=Iu(se.fromDom(t.getContentAreaContainer())),a=Wg(t)||Gg(t)||Yg(t),e=(e=u,o=i,r=Math.max(o.x,e.x),e=e.right-r,o=o.width-(r-o.x),{x:r,width:Math.min(e,o)}),o=e.x,e=e.width;if(t.inline&&!a)return Fu(o,i.y,e,i.height);i=function(t,n,e,o){var r=se.fromDom(t.getContainer()),i=Uu(r,".tox-editor-header").getOr(r),i=Iu(i),n=i.y>=n.bottom,n=o&&!n;if(t.inline&&n)return{y:Math.max(i.bottom,e.y),bottom:e.bottom};if(t.inline&&!n)return{y:e.y,bottom:Math.min(i.y,e.bottom)};r=Iu(r);return n?{y:Math.max(i.bottom,e.y),bottom:Math.min(r.bottom,e.bottom)}:{y:Math.max(r.y,e.y),bottom:Math.min(i.y,e.bottom)}}(t,u,i,n.header.isPositionedAtTop()),n=i.y,i=i.bottom;return Fu(o,n,e,i-n)},dk=function(n,t){t=R(t,function(t){return t.predicate(n.dom)}),t=I(t,function(t){return"contexttoolbar"===t.type});return{contextToolbars:t.pass,contextForms:t.fail}},mk=function(t,n,e){n=dk(t,n);if(0<n.contextForms.length)return tt.some({elem:t,toolbars:[n.contextForms[0]]});e=dk(t,e);if(0<e.contextForms.length)return tt.some({elem:t,toolbars:[e.contextForms[0]]});if(0<n.contextToolbars.length||0<e.contextToolbars.length){e=function(t){if(t.length<=1)return t;var n=function(n){return B(t,function(t){return t.position===n})},e=function(n){return R(t,function(t){return t.position===n})},o=n("selection"),r=n("node");if(o||r){if(r&&o){n=e("node"),r=F(e("selection"),function(t){return Z(Z({},t),{position:"node"})});return n.concat(r)}return e(o?"selection":"node")}return e("line")}(n.contextToolbars.concat(e.contextToolbars));return tt.some({elem:t,toolbars:e})}return tt.none()},gk=function(t,n,o){return t(n)?tt.none():We(n,function(t){var n=dk(t,o.inNodeScope),e=n.contextToolbars,n=n.contextForms,e=0<n.length?n:function(t){if(t.length<=1)return t;var n=function(n){return H(t,function(t){return t.position===n})};return n("selection").orThunk(function(){return n("node")}).orThunk(function(){return n("line")}).map(function(t){return t.position}).fold(function(){return[]},function(n){return R(t,function(t){return t.position===n})})}(e);return 0<e.length?tt.some({elem:t,toolbars:e}):tt.none()},t)},pk=function(t,n){var e,o=se.fromDom(n.getBody()),r=function(t){return Ne(t,o)},i=se.fromDom(n.selection.getNode());return r(e=i)||je(o,e)?mk(i,t.inNodeScope,t.inEditorScope).orThunk(function(){return gk(r,i,t)}):tt.none()},hk=function(e,r){var t={},i=[],u=[],a={},c={},o=function(n,e){var o=kn(Sn("ContextForm",Im,e));(t[n]=o).launch.map(function(t){a["form:"+n]=Z(Z({},e.launch),{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){r(o)}})}),("editor"===o.scope?u:i).push(o),c[n]=o},s=function(n,e){Sn("ContextToolbar",Rm,e).each(function(t){("editor"===e.scope?u:i).push(t),c[n]=t})},n=xt(e);return nt(n,function(t){var n=e[t];"contextform"===n.type?o(t,n):"contexttoolbar"===n.type&&s(t,n)}),{forms:t,inNodeScope:i,inEditorScope:u,lookupTable:c,formNavigators:a}},vk=Qr("forward-slide"),bk=Qr("backward-slide"),yk=Qr("change-slide-event"),xk="tox-pop--resizing",wk=function(t,n,e){var i,u,r,a,c,o=e.dataset,s="basic"===o.type?function(){return F(o.data,function(t){return Tw(t,e.isSelectedFor,e.getPreviewFor)})}:o.getData;return{items:(i=n,u=e,r=function(t,n,e,o){var r=i.shared.providers.translate(t.title);if("separator"===t.type)return tt.some({type:"separator",text:r});if("submenu"!==t.type)return tt.some(Z({type:"togglemenuitem",text:r,icon:t.icon,active:t.isSelected(o),disabled:e,onAction:u.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})));e=N(t.getStyleItems(),function(t){return a(t,n,o)});return 0===n&&e.length<=0?tt.none():tt.some({type:"nestedmenuitem",text:r,disabled:e.length<=0,getSubmenuItems:function(){return N(t.getStyleItems(),function(t){return a(t,n,o)})}})},a=function(t,n,e){var o="formatter"===t.type&&u.isInvalid(t);return 0===n?o?[]:r(t,n,!1,e).toArray():r(t,n,o,e).toArray()},{validateItems:c=function(t){var n=u.getCurrentValue(),e=u.shouldHide?0:1;return N(t,function(t){return a(t,e,n)})},getFetch:function(o,r){return function(t,n){var e=r(),e=c(e);n(c0(e,Hm.CLOSE_ON_EXECUTE,o,!1))}}}),getStyleItems:s}},Sk=function(e,t,o){var n=wk(0,t,o),r=n.items,n=n.getStyleItems;return e0({text:o.icon.isSome()?tt.none():tt.some(""),icon:o.icon,tooltip:tt.from(o.tooltip),role:tt.none(),fetch:r.getFetch(t,n),onSetup:function(n){var t=function(){var t=n.getComponent();t.getSystem().isConnected()&&o.updateText(t)};return t(),e.on("NodeChange",t),function(){e.off("NodeChange",t)}},getApi:function(t){return{getComponent:W(t)}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)};(ra=L0=L0||{})[ra.SemiColon=0]="SemiColon",ra[ra.Space=1]="Space";var kk,Ck=function(t,n,e,o){e=t.getParam(n,e,"string");return{type:"basic",data:(e=e,e=o===L0.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),F(e,function(t){var n=t,e=t,t=t.split("=");return 1<t.length&&(n=t[0],e=t[1]),{title:n,format:e}}))}},Ok=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],_k=function(e){var t={type:"basic",data:Ok};return{tooltip:"Align",icon:tt.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:tt.none,getPreviewFor:function(t){return function(){return tt.none()}},onAction:function(n){return function(){return H(Ok,function(t){return t.format===n.format}).each(function(t){return e.execCommand(t.command)})}},updateText:function(t){var n=H(Ok,function(t){return e.formatter.match(t.format)}).fold(function(){return"left"},function(t){return t.title.toLowerCase()});Uo(t,n0,{icon:"align-"+n})},dataset:t,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},Tk=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],Ek=function(t){t=t.split(/\s*,\s*/);return F(t,function(t){return t.replace(/^['"]+|['"]+$/g,"")})},Dk=function(r){var i=function(){var n=function(t){return t?Ek(t)[0]:""},t=r.queryCommandValue("FontName"),e=u.data,o=t?t.toLowerCase():"";return{matchOpt:H(e,function(t){t=t.format;return t.toLowerCase()===o||n(t).toLowerCase()===n(o).toLowerCase()}).orThunk(function(){return 0===(t=o).indexOf("-apple-system")&&(n=Ek(t.toLowerCase()),L(Tk,function(t){return-1<n.indexOf(t.toLowerCase())}))?tt.from({title:"System Font",format:o}):tt.none();var t,n}),font:t}},u=Ck(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",L0.SemiColon);return{tooltip:"Fonts",icon:tt.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getCurrentValue:function(){return i().matchOpt},getPreviewFor:function(t){return function(){return tt.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(t){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,t.format)})}},updateText:function(t){var n=i(),e=n.matchOpt,o=n.font,e=e.fold(function(){return o},function(t){return t.title});Uo(t,t0,{text:e})},dataset:u,shouldHide:!1,isInvalid:l}},Bk={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Ak={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},Mk=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){n=Math.pow(10,n);return Math.round(t*n)/n}(72*parseInt(t,10)/96,n||0)+"pt":Dt(Ak,t).getOr(t)},Fk=function(e){var r=function(){var o=tt.none(),r=u.data,i=e.queryCommandValue("FontSize");if(i)for(var t=function(t){var n=Mk(i,t),e=Dt(Bk,n).getOr("");o=H(r,function(t){return t.format===i||t.format===n||t.format===e})},n=3;o.isNone()&&0<=n;n--)t(n);return{matchOpt:o,size:i}},t=W(tt.none),u=Ck(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",L0.Space);return{tooltip:"Font sizes",icon:tt.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getPreviewFor:t,getCurrentValue:function(){return r().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},updateText:function(t){var n=r(),e=n.matchOpt,o=n.size,e=e.fold(function(){return o},function(t){return t.title});Uo(t,t0,{text:e})},dataset:u,shouldHide:!1,isInvalid:l}},Ik=function(t,n){var e=n(),n=F(e,function(t){return t.format});return tt.from(t.formatter.closest(n)).bind(function(n){return H(e,function(t){return t.format===n})}).orThunk(function(){return Kl(t.formatter.match("p"),{title:"Paragraph",format:"p"})})},Rk=function(t){var n=ae(tt.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(tt.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(tt.some(t))}}},Vk=function(){return Rk(function(t){return t.destroy()})},Pk=function(){return Rk(function(t){return t.unbind()})},Hk=function(o,r){return function(n){var e=Pk(),t=function(){n.setActive(o.formatter.match(r));var t=o.formatter.formatChanged(r,n.setActive);e.set(t)};return o.initialized?t():o.on("init",t),e.clear}},zk=function(n){return function(t){return function(){n.undoManager.transact(function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)})}}},Nk=function(e){var o=Ck(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",L0.SemiColon);return{tooltip:"Blocks",icon:tt.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:tt.none,getPreviewFor:function(n){return function(){var t=e.formatter.get(n);return tt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))})}},onAction:zk(e),updateText:function(t){var n=Ik(e,function(){return o.data}).fold(function(){return"Paragraph"},function(t){return t.title});Uo(t,t0,{text:n})},dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},Lk=function(r,t){return{tooltip:"Formats",icon:tt.none(),isSelectedFor:function(t){return function(){return r.formatter.match(t)}},getCurrentValue:tt.none,getPreviewFor:function(n){return function(){var t=r.formatter.get(n);return t!==undefined?tt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:r.dom.parseStyle(r.formatter.getCssText(n))}):tt.none()}},onAction:zk(r),updateText:function(t){var e=function(t){var n=t.items;return n!==undefined&&0<n.length?N(n,e):[{title:t.title,format:t.format}]},n=N(_w(r),e),o=Ik(r,function(){return n}).fold(function(){return"Paragraph"},function(t){return t.title});Uo(t,t0,{text:o})},shouldHide:r.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!r.formatter.canApply(t.format)},dataset:t}},jk=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Ua=function(o,r){return function(t,n,e){t=o(t).mapError(function(t){return On(t)}).getOrDie();return r(t,n,e)}},Uk={button:Ua(Am,function(t,n){return n=n.backstage.shared.providers,rk(t,n,[])}),togglebutton:Ua(Fm,function(t,n){return n=n.backstage.shared.providers,ik(t,n,[])}),menubutton:Ua(XS,function(t,n){return l0(t,"tox-tbtn",n.backstage,tt.none())}),splitbutton:Ua(function(t){return Sn("SplitButton",YS,t)},function(t,n){return uk(t,n.backstage.shared)}),grouptoolbarbutton:Ua(function(t){return Sn("GroupToolbarButton",WS,t)},function(t,n,e){var o=e.ui.registry.getAll().buttons,r=((r={})[Ic]=n.backstage.shared.header.isPositionedAtTop()?Ku.TopToBottom:Ku.BottomToTop,r);if(Kg(e)!==Pm.floating)throw new Error("Toolbar groups are only supported when using floating toolbar mode");return function(n,t,e,o){t=t.shared;return pS.sketch({lazySink:t.getSink,fetch:function(){return Rv(function(t){t(F(e(n.items),HS))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:ek(n.icon,n.text,n.tooltip,tt.none(),tt.none(),t.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(t,n.backstage,function(t){return Yk(e,{buttons:o,toolbar:t,allowToolbarGroups:!1},n,tt.none())},r)}),styleSelectButton:function(t,n){return e=t,t=n.backstage,n=Z({type:"advanced"},t.styleselect),Sk(e,t,Lk(e,n));var e},fontsizeSelectButton:function(t,n){return n=n.backstage,Sk(t,n,Fk(t))},fontSelectButton:function(t,n){return n=n.backstage,Sk(t,n,Dk(t))},formatButton:function(t,n){return n=n.backstage,Sk(t,n,Nk(t))},alignMenuButton:function(t,n){return n=n.backstage,Sk(t,n,_k(t))}},Wk={styleselect:Uk.styleSelectButton,fontsizeselect:Uk.fontsizeSelectButton,fontselect:Uk.fontSelectButton,formatselect:Uk.formatButton,align:Uk.alignMenuButton},Gk=function(t){var e,n=t.toolbar,t=t.buttons;return!1===n?[]:n===undefined||!0===n?(e=t,t=F(jk,function(t){var n=R(t.items,function(t){return Bt(e,t)||Bt(Wk,t)});return{name:t.name,items:n}}),R(t,function(t){return 0<t.items.length})):v(n)?function(t){t=t.split("|");return F(t,function(t){return{items:t.trim().split(" ")}})}(n):u(n,function(t){return Bt(t,"name")&&Bt(t,"items")})?n:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},Xk=function(r,n,i,u,a,t){return Dt(n,i.toLowerCase()).orThunk(function(){return t.bind(function(t){return J(t,function(t){return Dt(n,t+i.toLowerCase())})})}).fold(function(){return Dt(Wk,i.toLowerCase()).map(function(t){return t(r,a)}).orThunk(function(){return tt.none()})},function(t){return"grouptoolbarbutton"!==t.type||u?(e=a,o=r,Dt(Uk,(n=t).type).fold(function(){return console.error("skipping button defined by",n),tt.none()},function(t){return tt.some(t(n,e,o))})):(console.warn("Ignoring the '"+i+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),tt.none());var n,e,o})},Yk=function(e,o,r,i){var t=Gk(o),t=F(t,function(t){var n=N(t.items,function(t){return 0===t.trim().length?[]:Xk(e,o.buttons,t,o.allowToolbarGroups,r,i).toArray()});return{title:tt.from(e.translate(t.name)),items:n}});return R(t,function(t){return 0<t.items.length})},qk={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},Kk={maxHeightFunction:wc(),maxWidthFunction:oS()},Jk={onLtr:function(){return[Ma,Fa,Ba,Ea,Aa,Da,Zd,tm,$d,Kd,Qd,Jd]},onRtl:function(){return[Ma,Fa,Aa,Da,Ba,Ea,Zd,tm,Qd,Jd,$d,Kd]}},$k={onLtr:function(){return[Fa,Ea,Da,Ba,Aa,Ma,Zd,tm,$d,Kd,Qd,Jd]},onRtl:function(){return[Fa,Da,Ea,Aa,Ba,Ma,Zd,tm,Qd,Jd,$d,Kd]}},Qk=function(r,t,e,i){var o,u,a=Pe().deviceType.isTouch,c=su((o={sink:e,onEscape:function(){return r.focus(),tt.some(!0)}},u=ae([]),Gd.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){u.set([]),Gd.getContent(t).each(function(t){Ji(t.element,"visibility")}),Fi(t.element,xk),Ji(t.element,"width")},inlineBehaviours:Ka([gd("context-toolbar-events",[or(mo(),function(t,n){Fi(t.element,xk),Ji(t.element,"width")}),$o(yk,function(t,n){var e=t.element;Ji(e,"width");var o=wu(e);Gd.setContent(t,n.event.contents),Ai(e,xk);var r=wu(e);Ui(e,"width",o+"px"),Gd.getContent(t).each(function(t){n.event.focus.bind(function(t){return ec(t),rc(e)}).orThunk(function(){return cd.focusIn(t),oc(_r(e))})}),nm.setTimeout(function(){Ui(t.element,"width",r+"px")},0)}),$o(vk,function(n,t){Gd.getContent(n).each(function(t){u.set(u.get().concat([{bar:t,focus:oc(_r(n.element))}]))}),Uo(n,yk,{contents:t.event.forwardContents,focus:tt.none()})}),$o(bk,function(n,t){q(u.get()).each(function(t){u.set(u.get().slice(0,u.get().length-1)),Uo(n,yk,{contents:lu(t.bar),focus:t.focus})})})]),cd.config({mode:"special",onEscape:function(n){return q(u.get()).fold(function(){return o.onEscape()},function(t){return jo(n,bk),tt.some(!0)})}})]),lazySink:function(){return it.value(o.sink)}}))),s=function(){return fk(r,i.backstage.shared)},l=function(){if(a()&&i.backstage.isContextMenuOpen())return!0;var t,n,e=(t=g.get().filter(function(t){return Hi(se.fromDom(t))}).map(function(t){return t.getBoundingClientRect()}).getOrThunk(function(){return r.selection.getRng().getBoundingClientRect()}),n=r.inline?_u().top:Ru(se.fromDom(r.getBody())).y,{y:t.top+n,bottom:t.bottom+n}),o=s();return t=e.y,n=e.bottom,e=o.y,o=o.bottom,!(Math.max(t,e)<=Math.min(n,o))},n=function(){m.set(tt.none()),Gd.hide(c)},f=function(){Gd.hide(c)},d=function(){m.get().each(function(t){var n=c.element;Ji(n,"display"),l()?Ui(n,"display","none"):Bs.positionWithinBounds(e,t,c,tt.some(s()))})},m=ae(tt.none()),g=ae(tt.none()),p=ae(null),h=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Ka([cd.config({mode:"acyclic"}),gd("pop-dialog-wrap-events",[rr(function(t){r.shortcuts.add("ctrl+F9","focus statusbar",function(){return cd.focusIn(t)})}),ir(function(t){r.shortcuts.remove("ctrl+F9")})])])}},v=Pt(function(){return hk(t,function(t){t=b([t]);Uo(c,vk,{forwardContents:h(t)})})}),b=function(t){var n=r.ui.registry.getAll().buttons,e=v(),o=Z(Z({},n),e.formNavigators),e=Kg(r)===Pm.scrolling?Pm.scrolling:Pm["default"],t=et(F(t,function(t){return"contexttoolbar"===t.type?Yk(r,{buttons:o,toolbar:t.items,allowToolbarGroups:!1},i,tt.some(["form:"])):(n=i.backstage.shared.providers,lk(t,n));var n}));return US({type:e,uid:Qr("context-toolbar"),initGroups:t,onEscape:tt.none,cyclicKeying:!0,providers:i.backstage.shared.providers})};r.on("contexttoolbar-show",function(n){var t=v();Dt(t.lookupTable,n.toolbarKey).each(function(t){x([t],n.target===r?tt.none():tt.some(n)),Gd.getContent(c).each(cd.focusIn)})});var y=function(t,n){n="node"===t?i.backstage.shared.anchors.node(n):i.backstage.shared.anchors.cursor();return Rt(n,(n=t,t=a(),"line"===n?{bubble:_c(12,0,qk),layouts:{onLtr:function(){return[Ia]},onRtl:function(){return[Ra]}},overrides:Kk}:{bubble:_c(0,12,qk),layouts:t?$k:Jk,overrides:Kk}))},x=function(t,n){var e,o;S(),a()&&i.backstage.isContextMenuOpen()||(e=b(t),o=n.map(se.fromDom),o=y(t[0].position,o),m.set(tt.some(o)),g.set(n),n=c.element,Ji(n,"display"),Gd.showWithinBounds(c,o,h(e),function(){return tt.some(s())}),l()&&Ui(n,"display","none"))},w=function(){var t;r.hasFocus()&&(t=v(),pk(t,r).fold(n,function(t){x(t.toolbars,tt.some(t.elem.dom))}))},S=function(){var t=p.get();null!==t&&(nm.clearTimeout(t),p.set(null))},k=function(){S(),p.set(nm.setEditorTimeout(r,w,0))};r.on("init",function(){r.on(rS,f),r.on("ScrollContent ScrollWindow longpress",d),r.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){k()}),r.on("focusout",function(t){nm.setEditorTimeout(r,function(){rc(e.element).isNone()&&rc(c.element).isNone()&&n()},0)}),r.on("SwitchMode",function(){r.mode.isReadOnly()&&n()}),r.on("AfterProgressState",function(t){t.state?n():r.hasFocus()&&k()}),r.on("NodeChange",function(t){rc(c.element).fold(k,Q)})})},Zk=oa,xe=ho,fu=W([$n("shell",!1),Pn("makeItem"),$n("setupItem",Q),ll("listBehaviours",[md])]),ra=Cl({name:"items",overrides:function(){return{behaviours:Ka([md.config({})])}}}),Ua=W([ra]),tC=il({name:W("CustomList")(),configFields:fu(),partFields:Ua(),factory:function(u,t,n,e){var t=u.shell?{behaviours:[md.config({})],components:[]}:{behaviours:[],components:t},o=function(t){return u.shell?tt.some(t):Il(t,u,"items")};return{uid:u.uid,dom:u.dom,components:t.components,behaviours:sl(u.listBehaviours,t.behaviours),apis:{setItems:function(r,i){o(r).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(n){var t=md.contents(n),e=i.length,o=e-t.length,o=0<o?A(o,function(){return u.makeItem()}):[],e=t.slice(e);nt(e,function(t){return md.remove(n,t)}),nt(o,function(t){return md.append(n,t)});o=md.contents(n);nt(o,function(t,n){u.setupItem(r,t,i[n],n)})})}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),nC=W([]),eC=Object.freeze({__proto__:null,setup:Q,isDocked:l,getBehaviours:nC}),oC=function(t){return(qi(t,"position").is("fixed")?tt.none():xr(t)).orThunk(function(){var n=se.fromTag("span");return br(t).bind(function(t){Ir(t,n);t=xr(n);return Pr(n),t})})},rC=function(t){return oC(t).map(bu).getOrThunk(function(){return hu(0,0)})},iC=Mt([{"static":[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),uC=function(t,n){var e=t.element;Ai(e,n.transitionClass),Fi(e,n.fadeOutClass),Ai(e,n.fadeInClass),n.onShow(t)},aC=function(t,n){var e=t.element;Ai(e,n.transitionClass),Fi(e,n.fadeInClass),Ai(e,n.fadeOutClass),n.onHide(t)},cC=function(t,n,e){return L(t,function(t){switch(t){case"bottom":return n.bottom<=e.bottom;case"top":return n.y>=e.y}})},sC=function(n,t){return t.getInitialPosition().map(function(t){return Fu(t.bounds.x,t.bounds.y,wu(n),mu(n))})},lC=function(t,n,e){e.setInitialPosition(tt.some({style:function(t){var n={},e=t.dom;if(Pi(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n}(t),position:Xi(t,"position")||"static",bounds:n}))},fC=function(e,o,r){return r.getInitialPosition().bind(function(t){switch(r.setInitialPosition(tt.none()),t.position){case"static":return tt.some(iC["static"]());case"absolute":var n=oC(e).map(Iu).getOrThunk(function(){return Iu(zi())});return tt.some(iC.absolute(uc("absolute",Dt(t.style,"left").map(function(t){return o.x-n.x}),Dt(t.style,"top").map(function(t){return o.y-n.y}),Dt(t.style,"right").map(function(t){return n.right-o.right}),Dt(t.style,"bottom").map(function(t){return n.bottom-o.bottom}))));default:return tt.none()}})},dC=function(t,n,e){var o,r,i,t=t.element;return qi(t,"position").is("fixed")?(r=n,sC(o=t,i=e).filter(function(t){return cC(i.getModes(),t,r)}).bind(function(t){return fC(o,t,i)})):function(t,n,e){var o=Iu(t);if(cC(e.getModes(),o,n))return tt.none();lC(t,o,e);var r=Vu(),t=o.x-r.x,e=n.y-r.y,r=r.bottom-n.bottom,n=o.y<=n.y;return tt.some(iC.fixed(uc("fixed",tt.some(t),n?tt.some(e):tt.none(),tt.none(),n?tt.none():tt.some(r))))}(t,n,e)},mC=function(n,t){nt(["left","right","top","bottom","position"],function(t){return Ji(n.element,t)}),t.onUndocked(n)},gC=function(t,n,e){ac(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},pC=function(o,t,r,i,u){void 0===u&&(u=!1),t.contextual.each(function(e){e.lazyContext(o).each(function(t){var n,n=(n=i,(t=t).y<n.bottom&&t.bottom>n.y);n!==r.isVisible()&&(r.setVisible(n),u&&!n?(Ri(o.element,[e.fadeOutClass]),e.onHide(o)):(n?uC:aC)(o,e))})})},hC=function(n,e,t){var o,r,i=n.element;t.setDocked(!1),o=t,r=n.element,sC(r,o).bind(function(t){return fC(r,t,o)}).each(function(t){t.fold(function(){return mC(n,e)},function(t){return gC(n,e,t)},Q)}),t.setVisible(!0),e.contextual.each(function(t){Vi(i,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)}),vC(n,e,t)},vC=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&pC(o,r,i,u),dC(o,u,i).each(function(t){i.setDocked(!a),t.fold(function(){return mC(o,r)},function(t){return gC(o,r,t)},function(t){pC(o,r,i,u,!0),gC(o,r,t)})}))},bC=function(t,n,e){e.isDocked()&&hC(t,n,e)},oa=Object.freeze({__proto__:null,refresh:vC,reset:bC,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),ho=Object.freeze({__proto__:null,events:function(o,r){return qo([or(mo(),function(n,e){o.contextual.each(function(t){Ii(n.element,t.transitionClass)&&(Vi(n.element,[t.transitionClass,t.fadeInClass]),(r.isVisible()?t.onShown:t.onHidden)(n)),e.stop()})}),$o(Bo(),function(t,n){vC(t,o,r)}),$o(Ao(),function(t,n){bC(t,o,r)})])}}),ra=[Jn("contextual",[zn("fadeInClass"),zn("fadeOutClass"),zn("transitionClass"),Ln("lazyContext"),aa("onShow"),aa("onShown"),aa("onHide"),aa("onHidden")]),oe("lazyViewport",Vu),re("modes",["top","bottom"],An),aa("onDocked"),aa("onUndocked")],yC=$a({fields:ra,name:"docking",active:ho,apis:oa,state:Object.freeze({__proto__:null,init:function(t){var n=ae(!1),e=ae(!0),o=ae(tt.none()),r=ae(t.modes);return pi({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),xC={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},wC="tox-tinymce--toolbar-sticky-on",SC="tox-tinymce--toolbar-sticky-off",kC=function(o){var r=o.element;br(r).each(function(t){var n,e="padding-"+yC.getModes(o)[0];yC.isDocked(o)?(n=wu(t),Ui(r,"width",n+"px"),Ui(t,e,gu(n=r)+(parseInt(Xi(n,"margin-top"),10)||0)+(parseInt(Xi(n,"margin-bottom"),10)||0)+"px")):(Ji(r,"width"),Ji(t,e))})},CC=function(t,n){n?(Fi(t,xC.fadeOutClass),Ri(t,[xC.transitionClass,xC.fadeInClass])):(Fi(t,xC.fadeInClass),Ri(t,[xC.fadeOutClass,xC.transitionClass]))},OC=function(t,n){t=se.fromDom(t.getContainer());n?(Ai(t,wC),Fi(t,SC)):(Ai(t,SC),Fi(t,wC))},_C=function(i,t){var n,u=ae(tt.none()),e=t.getSink,o=function(n){e().each(function(t){return n(t.element)})},r=function(t){i.inline||kC(t),OC(i,yC.isDocked(t)),t.getSystem().broadcastOn([$s()],{}),e().each(function(t){return t.getSystem().broadcastOn([$s()],{})})},n=i.inline?[]:[tc.config({channels:((n={})[VS()]={onReceive:kC},n)})];return p([hd.config({}),yC.config({contextual:Z({lazyContext:function(t){var n=gu(t.element),e=i.inline?i.getContentAreaContainer():i.getContainer(),o=Iu(se.fromDom(e)),r=o.height-n,n=o.y+(e="top",D(yC.getModes(t),e)?0:n);return tt.some(Fu(o.x,n,o.width,r))},onShow:function(){o(function(t){return CC(t,!0)})},onShown:function(r){o(function(t){return Vi(t,[xC.transitionClass,xC.fadeInClass])}),u.get().each(function(t){var n,e,o;n=r.element,o=gr(e=t),oc(o).filter(function(t){return!Ne(e,t)}).filter(function(t){return Ne(t,se.fromDom(o.dom.body))||je(n,t)}).each(function(){return ec(e)}),u.set(tt.none())})},onHide:function(t){var n;u.set((t=t.element,n=e,rc(t).orThunk(function(){return n().toOptional().bind(function(t){return rc(t.element)})}))),o(function(t){return CC(t,!1)})},onHidden:function(){o(function(t){return Vi(t,[xC.transitionClass])})}},xC),modes:[t.header.getDockingMode()],onDocked:r,onUndocked:r})],n)},TC=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",function(){e().each(yC.reset)}),t.on("ResizeWindow ResizeEditor",function(){e().each(kC)}),t.on("SkinLoaded",function(){e().each(function(t){yC.isDocked(t)?yC.reset(t):yC.refresh(t)})}),t.on("FullscreenStateChanged",function(){e().each(yC.reset)})),t.on("AfterScrollIntoView",function(f){e().each(function(t){yC.refresh(t);var n,e,o,r,i,u,a,c,s,l=t.element;zf(l)&&(n=f,o=gr(e=l),r=o.dom.defaultView.innerHeight,i=_u(o),u=se.fromDom(n.elm),a=Ru(u),c=mu(u),s=a.y,t=s+c,l=bu(e),n=mu(e),u=l.top,a=u+n,e=Math.abs(u-i.top)<2,l=Math.abs(a-(i.top+r))<2,e&&s<a?Tu(i.left,s-n,o):l&&u<t&&Tu(i.left,s-r+c+n,o))})}),t.on("PostRender",function(){OC(t,!1)})},isDocked:function(t){return t().map(yC.isDocked).getOr(!1)},getBehaviours:_C}),EC=Yl({factory:function(n,e){var t={focus:cd.focusIn,setMenus:function(t,n){n=F(n,function(n){var t={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},t=XS(t).mapError(function(t){return On(t)}).getOrDie();return l0(t,"tox-mbtn",e.backstage,tt.some("menuitem"))});md.set(t,n)}};return{uid:n.uid,dom:n.dom,components:[],behaviours:Ka([md.config({}),gd("menubar-events",[rr(function(t){n.onSetup(t)}),$o(ro(),function(e,t){Uu(e.element,".tox-mbtn--active").each(function(n){Wu(t.event.target,".tox-mbtn").each(function(t){Ne(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(t){cb.expand(t),cb.close(n),hd.focus(t)})})})})}),$o(Vo(),function(e,t){t.event.prevFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(n){t.event.newFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(t){cb.isOpen(n)&&(cb.expand(t),cb.close(n))})})})]),cd.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),tt.some(!0)}}),lv.config({})]),apis:t,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Pn("dom"),Pn("uid"),Pn("onEscape"),Pn("backstage"),$n("onSetup",Q)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),DC="container",BC=[po("slotBehaviours",[])],AC=function(t){return"<alloy.field."+t+">"},MC=function(r,t){var e,n=function(t){return Hl(r)},o=function(e,o){return function(t,n){return Il(t,r,n).map(function(t){return e(t,n)}).getOr(o)}},i=function(t,n){return"true"!==Ur(t.element,"aria-hidden")},u=o(i,!1),a=o(function(t,n){var e;i(t)&&(e=t.element,Ui(e,"display","none"),jr(e,"aria-hidden","true"),Uo(t,Po(),{name:n,visible:!1}))}),c=(e=a,function(n,t){nt(t,function(t){return e(n,t)})}),o=o(function(t,n){var e;i(t)||(e=t.element,Ji(e,"display"),Xr(e,"aria-hidden"),Uo(t,Po(),{name:n,visible:!0}))});return{uid:r.uid,dom:r.dom,components:t,behaviours:cl(r.slotBehaviours),apis:{getSlotNames:n,getSlot:function(t,n){return Il(t,r,n)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,n())},showSlot:o}}},fu=kt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},mi),FC=Z(Z({},fu),{sketch:function(t){var e,n=(e=[],{slot:function(t,n){return e.push(t),Dl(DC,AC(t),n)},record:function(){return e}}),t=t(n),n=n.record(),n=F(n,function(t){return kl({name:t,pname:AC(t)})});return Ul(DC,BC,n,MC,t)}}),IC=an([qn("icon"),qn("tooltip"),oe("onShow",Q),oe("onHide",Q),oe("onSetup",function(){return Q})]),RC=function(t){return{element:function(){return t.element.dom}}},VC=function(e,o){var r=F(xt(o),function(t){var n=o[t],n=kn(Sn("sidebar",IC,n));return{name:t,getApi:RC,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}});return F(r,function(t){var n=ae(Q);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:bg([mp(t,n),gp(t,n),$o(Po(),function(n,t){var e=t.event;H(r,function(t){return t.name===e.name}).each(function(t){(e.visible?t.onShow:t.onHide)(t.getApi(n))})})])})})},PC=function(t,e){$l.getCurrent(t).each(function(t){return md.set(t,[(n=e,FC.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:VC(t,n),slotBehaviours:bg([rr(function(t){return FC.hideAllSlots(t)})])}}))]);var n})},HC=function(t){return $l.getCurrent(t).bind(function(t){return MS.isGrowing(t)||MS.hasGrown(t)?$l.getCurrent(t).bind(function(n){return H(FC.getSlotNames(n),function(t){return FC.isShowing(n,t)})}):tt.none()})},zC=Qr("FixSizeEvent"),NC=Qr("AutoSizeEvent"),LC=function(t){var n=se.fromHtml(t),e=wr(n),o=function(t){t=t.dom.attributes!==undefined?t.dom.attributes:[];return P(t,function(t,n){return"class"===n.name?t:Z(Z({},t),((t={})[n.name]=n.value,t))},{})}(n),t=Array.prototype.slice.call(n.dom.classList,0),e=0===e.length?{}:{innerHtml:zr(n)};return Z({tag:cr(n),classes:t,attributes:o},e)},jC=function(t,n,e){var o=t.element;!0===n?(md.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:LC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Ka([cd.config({mode:"special",onTab:function(){return tt.some(!0)},onShiftTab:function(){return tt.some(!0)}}),hd.config({})])}]),Ji(o,"display"),Xr(o,"aria-hidden")):(md.set(t,[]),Ui(o,"display","none"),jr(o,"aria-hidden","true"))},Ua=xe.optional({factory:EC,name:"menubar",schema:[Pn("backstage")]}),re=xe.optional({factory:{sketch:function(t){return tC.sketch({uid:t.uid,dom:t.dom,listBehaviours:Ka([cd.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return US({type:t.type,uid:Qr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),tt.some(!0)}})},setupItem:function(t,n,e,o){iS.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Pn("dom"),Pn("onEscape")]}),ra=xe.optional({factory:{sketch:function(t){var n;return((n=t).type===Pm.sliding?jS:n.type===Pm.floating?LS:US)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),tt.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Pn("dom"),Pn("onEscape"),Pn("getSink")]}),ho=xe.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?_C:nC;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Ka(e(n,t.sharedBackstage))}}},name:"header",schema:[Pn("dom")]}),oa=xe.optional({name:"socket",schema:[Pn("dom")]}),fu=xe.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Ka([lv.config({}),hd.config({}),MS.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){$l.getCurrent(t).each(FC.hideAllSlots),jo(t,NC)},onGrown:function(t){jo(t,NC)},onStartGrow:function(t){Uo(t,zC,{width:qi(t.element,"width").getOr("")})},onStartShrink:function(t){Uo(t,zC,{width:wu(t.element)+"px"})}}),md.config({}),$l.config({find:function(t){t=md.contents(t);return Y(t)}})])}],behaviours:Ka([By(0),gd("sidebar-sliding-events",[$o(zC,function(t,n){Ui(t.element,"width",n.event.width)}),$o(NC,function(t,n){Ji(t.element,"width")})])])}}},name:"sidebar",schema:[Pn("dom")]}),xe=xe.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Ka([md.config({})]),components:[]}}},name:"throbber",schema:[Pn("dom")]}),UC=il({name:"OuterContainer",factory:function(e,t,n){return{uid:e.uid,dom:e.dom,components:t,apis:{getSocket:function(t){return Zk.getPart(t,e,"socket")},setSidebar:function(t,n){Zk.getPart(t,e,"sidebar").each(function(t){return PC(t,n)})},toggleSidebar:function(t,n){Zk.getPart(t,e,"sidebar").each(function(t){var e;e=n,$l.getCurrent(t).each(function(n){$l.getCurrent(n).each(function(t){MS.hasGrown(n)?FC.isShowing(t,e)?MS.shrink(n):(FC.hideAllSlots(t),FC.showSlot(t,e)):(FC.hideAllSlots(t),FC.showSlot(t,e),MS.grow(n))})})})},whichSidebar:function(t){return Zk.getPart(t,e,"sidebar").bind(HC).getOrNull()},getHeader:function(t){return Zk.getPart(t,e,"header")},getToolbar:function(t){return Zk.getPart(t,e,"toolbar")},setToolbar:function(t,n){Zk.getPart(t,e,"toolbar").each(function(t){t.getApis().setGroups(t,n)})},setToolbars:function(t,n){Zk.getPart(t,e,"multiple-toolbar").each(function(t){tC.setItems(t,n)})},refreshToolbar:function(t){Zk.getPart(t,e,"toolbar").each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(t){Zk.getPart(t,e,"toolbar").each(function(n){var t,e;t=n.getApis().toggle,e=function(t){return t(n)},t!==undefined&&null!==t?tt.some(e(t)):tt.none()})},isToolbarDrawerToggled:function(t){return Zk.getPart(t,e,"toolbar").bind(function(n){return tt.from(n.getApis().isOpen).map(function(t){return t(n)})}).getOr(!1)},getThrobber:function(t){return Zk.getPart(t,e,"throbber")},focusToolbar:function(t){Zk.getPart(t,e,"toolbar").orThunk(function(){return Zk.getPart(t,e,"multiple-toolbar")}).each(function(t){cd.focusIn(t)})},setMenubar:function(t,n){Zk.getPart(t,e,"menubar").each(function(t){EC.setMenus(t,n)})},focusMenubar:function(t){Zk.getPart(t,e,"menubar").each(function(t){EC.focus(t)})}},behaviours:e.behaviours}},configFields:[Pn("dom"),Pn("behaviours")],partFields:[ho,Ua,ra,re,oa,fu,xe],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){e=F(e,HS);t.setToolbar(n,e)},setToolbars:function(t,n,e){e=F(e,function(t){return F(t,HS)});t.setToolbars(n,e)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),WC={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},GC=function(t){return"string"==typeof t?t.split(" "):t},XC=function(r,i){var u=Z(Z({},WC),i.menus),n=0<xt(i.menus).length,t=i.menubar===undefined||!0===i.menubar?GC("file edit view insert format tools table help"):GC(!1===i.menubar?"":i.menubar),t=R(t,function(t){return n&&i.menus.hasOwnProperty(t)&&i.menus[t].hasOwnProperty("items")||WC.hasOwnProperty(t)}),t=F(t,function(t){var n,e,o,t=u[t];return n={title:t.title,items:GC(t.items)},e=i,o=r.getParam("removed_menuitems","").split(/[ ,]/),{text:n.title,getItems:function(){return N(n.items,function(t){var n=t.toLowerCase();return 0===n.trim().length||B(o,function(t){return t===n})?[]:"separator"===n||"|"===n?[{type:"separator"}]:e.menuItems[n]?[e.menuItems[n]]:[]})}}});return R(t,function(t){return 0<t.getItems().length&&B(t.getItems(),function(t){return"separator"!==t.type})})},YC=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},qC=function(n,e){return function(){return t={message:e},n.fire("SkinLoadError",t);var t}},KC=function(e,o,r){return new xm(function(t,n){r.load(o,t,n),e.on("remove",function(){return r.unload(o)})})},JC=function(t,n){var e;return(e=se.fromDom(t.getElement()),Er(e).isSome())?KC(t,n+"/skin.shadowdom.min.css",Cg.DOM.styleSheetLoader):xm.resolve()},Ua=function(t,n){var e,o,r,r=(o=(e=n).getParam("skin"),r=e.getParam("skin_url"),!1!==o&&(o=o||"oxide",r=r?e.documentBaseURI.toAbsolute(r):Pg.baseURL+"/skins/ui/"+o),r);r&&n.contentCSS.push(r+(t?"/content.inline":"/content")+".min.css"),!1===n.getParam("skin")==!1&&v(r)?xm.all([KC(n,r+"/skin.min.css",n.ui.styleSheetLoader),JC(n,r)]).then(YC(n),qC(n,"Skin could not be loaded")):YC(n)()},$C=m(Ua,!1),QC=m(Ua,!0),ZC=function(n,t,e,o){var r=t.outerContainer,t=e.toolbar,i=e.buttons;u(t,v)?(t=t.map(function(t){t={toolbar:t,buttons:i,allowToolbarGroups:e.allowToolbarGroups};return Yk(n,t,{backstage:o},tt.none())}),UC.setToolbars(r,t)):UC.setToolbar(r,Yk(n,e,{backstage:o},tt.none()))},ra=Pe(),t1=ra.os.isiOS()&&ra.os.version.major<=12,n1=Object.freeze({__proto__:null,render:function(e,n,t,o,r){var i=ae(0),u=n.outerContainer;$C(e);var a=se.fromDom(r.targetNode),c=Tr(_r(a));r=n.mothership,Ls(a,r,Mr),Ns(c,n.uiMothership),e.on("PostRender",function(){ZC(e,n,t,o),i.set(e.getWin().innerWidth),UC.setMenubar(u,XC(e,t)),UC.setSidebar(u,t.sidebar),function(e,t){var n=e.dom,o=e.getWin(),r=e.getDoc().documentElement,i=ae(hu(o.innerWidth,o.innerHeight)),u=ae(hu(r.offsetWidth,r.offsetHeight)),a=function(){var t=i.get();t.left===o.innerWidth&&t.top===o.innerHeight||(i.set(hu(o.innerWidth,o.innerHeight)),Zp(e))},r=function(){var t=e.getDoc().documentElement,n=u.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(u.set(hu(t.offsetWidth,t.offsetHeight)),Zp(e))},c=function(t){return e.fire("ScrollContent",t)};n.bind(o,"resize",a),n.bind(o,"scroll",c);var s=Wh(se.fromDom(e.getBody()),"load",r),l=t.uiMothership.element;e.on("hide",function(){Ui(l,"display","none")}),e.on("show",function(){Ji(l,"display")}),e.on("NodeChange",r),e.on("remove",function(){s.unbind(),n.unbind(o,"resize",a),n.unbind(o,"scroll",c),o=null})}(e,n)});var s,l,f,c=UC.getSocket(u).getOrDie("Could not find expected socket element");t1&&(Wi(c.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),s=function(){e.fire("ScrollContent")},l=20,f=null,d=Uh(c.element,"scroll",{cancel:function(){null!==f&&(clearTimeout(f),f=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===f&&(f=setTimeout(function(){s.apply(null,t),f=null},l))}}.throttle),e.on("remove",d.unbind)),up(e,n),e.addCommand("ToggleSidebar",function(t,n){UC.toggleSidebar(u,n),e.fire("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",function(){return UC.whichSidebar(u)});var d=Kg(e);return d!==Pm.sliding&&d!==Pm.floating||e.on("ResizeWindow ResizeEditor ResizeContent",function(){var t=e.getWin().innerWidth;t!==i.get()&&(UC.refreshToolbar(n.outerContainer),i.set(t))}),{iframeContainer:c.element.dom,editorContainer:u.element.dom,api:{enable:function(){ip(n,!1)},disable:function(){ip(n,!0)},isDisabled:function(){return Vg.isDisabled(u)}}}}}),e1=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?tt.some(parseInt(""+t,10)):tt.none()},o1=function(t){return $(t)?t+"px":t},r1=function(n,t,e){t=t.filter(function(t){return n<t}),e=e.filter(function(t){return t<n});return t.or(e).getOr(n)},i1=function(t){var n,e,o,r;return(e=Hg(n=t),o=Lg(n),r=Ug(n),e1(e).map(function(t){return r1(t,o,r)})).getOr(Hg(t))},u1=function(t){var n=zg(t),e=Ng(t),o=jg(t);return e1(n).map(function(t){return r1(t,e,o)})},a1=function(r,i,t,n,o){var e=t.uiMothership,u=t.outerContainer,a=Cg.DOM,c=Zg(r),s=ep(r),l=jg(r).or(u1(r)),f=n.shared.header,d=f.isPositionedAtTop,n=Kg(r),m=n===Pm.sliding||n===Pm.floating,g=ae(!1),p=function(){return g.get()&&!r.removed},h=function(t){return m?t.fold(function(){return 0},function(t){return 1<t.components().length?mu(t.components()[1].element):0}):0},v=function(){e.broadcastOn([$s()],{})},b=function(t){var n,e;void 0===t&&(t=!1),p()&&(c||(n=l.getOrThunk(function(){var t=e1(Xi(zi(),"margin-left")).getOr(0);return wu(zi())-bu(i).left+t}),Ui(o.get().element,"max-width",n+"px")),m&&UC.refreshToolbar(u),c||(e=UC.getToolbar(u),n=h(e),e=Iu(i),n=d()?Math.max(e.y-mu(o.get().element)+n,0):e.bottom,Wi(u.element,{position:"absolute",top:Math.round(n)+"px",left:Math.round(e.x)+"px"})),s&&(e=o.get(),t?yC.reset(e):yC.refresh(e)),v())},y=function(t){var n,e;void 0===t&&(t=!0),!c&&s&&p()&&(n=f.getDockingMode(),(e=function(t){switch(Jg(r)){case qg.auto:var n=UC.getToolbar(u),e=h(n),o=mu(t.element)-e,n=Iu(i);if(n.y>o)return"top";e=hr(i),e=Math.max(e.dom.scrollHeight,mu(e));return n.bottom<e-o||Vu().bottom<n.bottom-o?"bottom":"top";case qg.bottom:return"bottom";case qg.top:default:return"top"}}(o.get()))!==n&&(function(t){var n=o.get();yC.setModes(n,[t]),f.setDockingMode(t);t=d()?Ku.TopToBottom:Ku.BottomToTop;jr(n.element,Ic,t)}(e),t&&b(!0)))};return{isVisible:p,isPositionedAtTop:d,show:function(){g.set(!0),Ui(u.element,"display","flex"),a.addClass(r.getBody(),"mce-edit-focus"),Ji(e.element,"display"),y(!1),b()},hide:function(){g.set(!1),t.outerContainer&&(Ui(u.element,"display","none"),a.removeClass(r.getBody(),"mce-edit-focus")),Ui(e.element,"display","none")},update:b,updateMode:y,repositionPopups:v}},c1=function(t,n){t=Iu(t);return{pos:n?t.y:t.bottom,bounds:t}},s1=Object.freeze({__proto__:null,render:function(n,e,o,r,t){var i=e.mothership,u=e.uiMothership,a=e.outerContainer,c=ae(null),s=se.fromDom(t.targetNode),l=a1(n,s,e,r,c),f=n.getParam("toolbar_persist",!1,"boolean");QC(n);var d=function(){var t;c.get()?l.show():(c.set(UC.getHeader(a).getOrDie()),t=tp(n),Ns(t,i),Ns(t,u),ZC(n,e,o,r),UC.setMenubar(a,XC(n,o)),l.show(),function(i,u,a,t){var c=ae(c1(u,a.isPositionedAtTop())),n=function(t){var n=c1(u,a.isPositionedAtTop()),e=n.pos,o=n.bounds,r=c.get(),n=r.pos,r=r.bounds,r=o.height!==r.height||o.width!==r.width;c.set({pos:e,bounds:o}),r&&Zp(i,t),a.isVisible()&&(n!==e?a.update(!0):r&&(a.updateMode(),a.repositionPopups()))};t||(i.on("activate",a.show),i.on("deactivate",a.hide)),i.on("SkinLoaded ResizeWindow",function(){return a.update(!0)}),i.on("NodeChange keydown",function(t){nm.requestAnimationFrame(function(){return n(t)})}),i.on("ScrollWindow",function(){return a.updateMode()});var e=Pk();e.set(Wh(se.fromDom(i.getBody()),"load",n)),i.on("remove",function(){e.clear()})}(n,s,l,f),n.nodeChanged())};return n.on("show",d),n.on("hide",l.hide),f||(n.on("focus",d),n.on("blur",l.hide)),n.on("init",function(){(n.hasFocus()||f)&&d()}),up(n,e),{editorContainer:a.element.dom,api:{show:function(){l.show()},hide:function(){l.hide()},enable:function(){ip(e,!1)},disable:function(){ip(e,!0)},isDisabled:function(){return Vg.isDisabled(a)}}}}}),l1=function(t,n){var e,o,r,i,u,a,c,s;e=wk(0,a=n,_k(r=t)),r.ui.registry.addNestedMenuItem("align",{text:a.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}}),o=wk(0,i=n,Dk(r=t)),r.ui.registry.addNestedMenuItem("fontformats",{text:i.shared.providers.translate("Fonts"),getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}}),a=t,i=Z({type:"advanced"},(r=n).styleselect),u=wk(0,r,Lk(a,i)),a.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return u.items.validateItems(u.getStyleItems())}}),c=wk(0,n,Nk(a=t)),a.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return c.items.validateItems(c.getStyleItems())}}),s=wk(0,n,Fk(t=t)),t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}})},f1={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},d1=(re="[eE][+-]?[0-9]+",re=["Infinity",(oa="[0-9]+")+"\\."+(fu=function(t){return"(?:"+t+")?"})(oa)+fu(re),"\\."+oa+fu(re),oa+fu(re)].join("|"),new RegExp("^("+("[+-]?(?:"+re+")")+")(.*)$")),m1=function(t,o){return tt.from(d1.exec(t)).bind(function(t){var n,e=Number(t[1]),t=t[2];return n=t,B(o,function(t){return B(f1[t],function(t){return n===t})})?tt.some({value:e,unit:t}):tt.none()})},g1=function(t){return m1(t,["fixed","relative","empty"]).map(function(t){return t.value+t.unit}).getOr(t)},p1=function(o){var r=o.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),i=new Map,u=Vk(),a=function(){var t=g1(o.queryCommandValue("LineHeight"));tt.from(i.get(t)).fold(function(){return u.clear()},function(t){u.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)})};return o.on("nodeChange",a),F(r,function(n,e){return{type:"togglemenuitem",text:n,onSetup:function(t){return i.set(g1(n),t),e+1===r.length&&a(),function(){0===e&&(o.off("nodeChange",a),u.clear())}},onAction:function(){return o.execCommand("LineHeight",!1,n)}}})},h1=function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return p1(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(p1(e))}})},v1=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},b1=function(t){var n,e;!function(e){Iy.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t,n){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:Hk(e,t.name),onAction:v1(e,t.name)})});for(var t=1;t<=6;t++){var n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:Hk(e,n),onAction:v1(e,n)})}}(t),n=t,Iy.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}),e=t,Iy.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:Hk(e,t.name)})})},y1=function(t){var n;b1(t),n=t,Iy.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:v1(n,"code")})},x1=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},w1=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return x1(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return x1(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return x1(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return x1(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})},S1=function(t,n){var e,o,r;!function(n){Iy.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:Hk(n,t.name)})});var t="JustifyNone";n.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return n.execCommand(t)},icon:"align-none"})}(t),y1(t),l1(t,n),w1(t),function(t){lh(t);var n=ae(null),e=ae(null);hh(t,"forecolor","forecolor","Text color",n),hh(t,"backcolor","hilitecolor","Background color",e),vh(t,"forecolor","forecolor","Text color"),vh(t,"backcolor","hilitecolor","Background color")}(t),(e=n=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return e.execCommand("mceToggleVisualAid")}}),(o=n).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}}(t,o)},onAction:function(){o.execCommand("mceToggleVisualAid")}}),(r=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,r)},onAction:function(){return r.execCommand("outdent")}}),r.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return r.execCommand("indent")}}),h1(t)},k1=function(t,n){return{anchor:"makeshift",x:t,y:n}},C1=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},O1=function(t,n){var e=Cg.DOM.getPos(t);return t=e.x,e=e.y,k1(n.x+t,n.y+e)},_1=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(C1(t)){var n=t.touches[0];return k1(n.pageX,n.pageY)}return k1(t.pageX,t.pageY)}(n):O1(t.getContentAreaContainer(),function(t){if(C1(t)){var n=t.touches[0];return k1(n.clientX,n.clientY)}return k1(t.clientX,t.clientY)}(n)):T1(t)},T1=function(t){return{anchor:"selection",root:se.fromDom(t.selection.getNode())}},E1=function(t){return{anchor:"node",node:tt.some(se.fromDom(t.selection.getNode())),root:se.fromDom(t.getBody())}},D1=function(t,n,e,o,r,i){var e=e(),u=i?E1(t):_1(t,n);c0(e,Hm.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),Gd.showMenuAt(r,u,{menu:{markers:$m("normal")},data:t})})},B1={onLtr:function(){return[Fa,Ea,Da,Ba,Aa,Ma,Zd,tm,$d,Kd,Qd,Jd]},onRtl:function(){return[Fa,Da,Ea,Aa,Ba,Ma,Zd,tm,Qd,Jd,$d,Kd]}},A1={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},M1=function(n,e,t,o,r,i,u){var a,c=i?E1(n):(a=n,i=e,Z({bubble:_c(0,12,A1),layouts:B1,overrides:{maxWidthFunction:oS(),maxHeightFunction:wc()}},_1(a,i)));c0(t,Hm.CLOSE_ON_EXECUTE,o,!0).map(function(t){e.preventDefault(),Gd.showMenuWithinBounds(r,c,{menu:{markers:$m("normal"),highlightImmediately:u},data:t,type:"horizontal"},function(){return tt.some(fk(n,o.shared))}),n.fire(rS)})},F1=function(n,e,o,r,i,u){var t,a=Pe(),c=a.os.isiOS(),s=a.os.isOSX(),l=a.os.isAndroid(),f=a.deviceType.isTouch(),d=function(){var t=o();M1(n,e,t,r,i,u,!(l||c||s&&f))};!s&&!c||u?(l&&!u&&n.selection.setCursorLocation(e.target,0),d()):(t=function(){!function(t){var n=t.selection.getRng(),e=function(){nm.setEditorTimeout(t,function(){t.selection.setRng(n)},10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(n),d()},!function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],e=e.getRng();return ds(t.getWin(),Kc.domRange(e)).exists(function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY})}(n,e)?(n.once("selectionchange",t),n.once("touchend",function(){return n.off("selectionchange",t)})):t())},I1=function(t){return"string"==typeof t?t.split(/[ ,]/):t},R1=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},V1=function(t){return n="contextmenu",e="link linkchecker image imagetools table spellchecker configurepermanentpen",o=(t=t).ui.registry.getAll().contextMenus,tt.from(t.getParam(n)).map(I1).getOrThunk(function(){return R(I1(e),function(t){return Bt(o,t)})});var n,e,o},P1=function(t){return v(t)?"|"===t:"separator"===t.type},H1={type:"separator"},z1=function(n){var t,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(v(n))return n;switch(n.type){case"separator":return H1;case"submenu":return Z(Z({type:"nestedmenuitem"},e(n)),{getSubmenuItems:function(){var t=n.getSubmenuItems();return v(t)?t:F(t,z1)}});default:return Z(Z({type:"menuitem"},e(n)),{onAction:(t=n.onAction,function(){return t()})})}},N1=function(t,n){if(0===n.length)return t;var e=q(t).filter(function(t){return!P1(t)}).fold(function(){return[]},function(t){return[H1]});return t.concat(e).concat(n).concat([H1])},L1=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},j1=function(t,n){return L1(t,n)?t.selection.getStart(!0):n.target},U1=function(r,t,n){var e=Pe().deviceType.isTouch,i=su(Gd.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return r.focus()},onShow:function(){return n.setContextMenuState(!0)},onHide:function(){return n.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Ka([gd("dismissContextMenu",[$o(Io(),function(t,n){Ks.close(t),r.focus()})])])})),o=function(t){return Gd.hide(i)},u=function(o){var t;R1(r)&&o.preventDefault(),t=r,o.ctrlKey&&!R1(t)||!1===r.getParam("contextmenu")||(t=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string");if(L1(t,n))return!0;if(e){n=j1(t,n);return Xh(se.fromDom(n),e)}return!1}(r,o),(e()?F1:D1)(r,o,function(){var t=j1(r,o),n=r.ui.registry.getAll(),e=V1(r);return function(e,t,o){t=P(t,function(n,t){return Dt(e,t.toLowerCase()).map(function(t){t=t.update(o);if(v(t))return N1(n,t.split(" "));if(0<t.length){t=F(t,z1);return N1(n,t)}return n}).getOrThunk(function(){return n.concat([t])})},[]);return 0<t.length&&P1(t[t.length-1])&&t.pop(),t}(n.contextMenus,e,t)},n,i,t))};r.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(e()?"":" ResizeWindow");r.on(t,o),r.on("longpress contextmenu",u)})},xe=Mt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),W1=function(n){return function(t){return t.translate(-n.left,-n.top)}},G1=function(n){return function(t){return t.translate(n.left,n.top)}},X1=function(e){return function(t,n){return P(e,function(t,n){return n(t)},hu(t,n))}},Y1=function(t,n,e){return t.fold(X1([G1(e),W1(n)]),X1([W1(n)]),X1([]))},q1=function(t,n,e){return t.fold(X1([G1(e)]),X1([]),X1([G1(n)]))},K1=function(t,n,e){return t.fold(X1([]),X1([W1(e)]),X1([G1(n),W1(e)]))},J1=function(t,n,e){t=t.fold(function(t,n){return{position:tt.some("absolute"),left:tt.some(t+"px"),top:tt.some(n+"px")}},function(t,n){return{position:tt.some("absolute"),left:tt.some(t-e.left+"px"),top:tt.some(n-e.top+"px")}},function(t,n){return{position:tt.some("fixed"),left:tt.some(t+"px"),top:tt.some(n+"px")}});return Z({right:tt.none(),bottom:tt.none()},t)},$1=function(t,i,u,a){var n=function(o,r){return function(t,n){var e=o(i,u,a);return r(t.getOr(e.left),n.getOr(e.top))}};return t.fold(n(K1,Q1),n(q1,Z1),n(Y1,tO))},Q1=xe.offset,Z1=xe.absolute,tO=xe.fixed,nO=function(t,n){n=Ur(t,n);return o(n)?NaN:parseInt(n,10)},eO=function(t,n,e,o){return r=n,t=(n=t).element,n=nO(t,r.leftAttr),r=nO(t,r.topAttr),(isNaN(n)||isNaN(r)?tt.none():tt.some(hu(n,r))).fold(function(){return e},function(t){return tO(t.left+o.left,t.top+o.top)});var r},oO=function(t,n,e,o,r,i){var e=eO(t,n,e,o),o=(n.mustSnap?uO:aO)(t,n,e,r,i),u=Y1(e,r,i);return function(t,n,e){t=t.element;jr(t,n.leftAttr,e.left+"px"),jr(t,n.topAttr,e.top+"px")}(t,n,u),o.fold(function(){return{coord:tO(u.left,u.top),extra:tt.none()}},function(t){return{coord:t.output,extra:t.extra}})},rO=function(t,n){!function(t,n){t=t.element;Xr(t,n.leftAttr),Xr(t,n.topAttr)}(t,n)},iO=function(t,e,o,r){return J(t,function(t){var n=t.sensor;return function(t,n,e,o,r,i){t=q1(t,r,i),i=q1(n,r,i);return Math.abs(t.left-i.left)<=e&&Math.abs(t.top-i.top)<=o}(e,n,t.range.left,t.range.top,o,r)?tt.some({output:$1(t.output,e,o,r),extra:t.extra}):tt.none()})},uO=function(t,n,r,i,u){var e=n.getSnapPoints(t);return iO(e,r,i,u).orThunk(function(){return P(e,function(n,e){var t=e.sensor,o=function(t,n,e,o){t=q1(t,e,o),e=q1(n,e,o),o=Math.abs(t.left-e.left),e=Math.abs(t.top-e.top);return hu(o,e)}(r,t,(e.range.left,e.range.top,i),u);return n.deltas.fold(function(){return{deltas:tt.some(o),snap:tt.some(e)}},function(t){return(o.left+o.top)/2<=(t.left+t.top)/2?{deltas:tt.some(o),snap:tt.some(e)}:n})},{deltas:tt.none(),snap:tt.none()}).snap.map(function(t){return{output:$1(t.output,r,i,u),extra:t.extra}})})},aO=function(t,n,e,o,r){t=n.getSnapPoints(t);return iO(t,e,o,r)},Ua=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);n.repositionTarget&&(n=gr(t.element),t=_u(n),n=rC(r),o={coord:$1((o=o).output,o.output,t,n),extra:o.extra},n=J1(o.coord,0,n),Gi(r,n))}}),cO="data-initial-z-index",sO=function(t,n){var e;t.getSystem().addToGui(n),br((e=n).element).filter(lr).each(function(n){qi(n,"z-index").each(function(t){jr(n,cO,t)}),Ui(n,"z-index",Xi(e.element,"z-index"))})},lO=function(t){br(t.element).filter(lr).each(function(n){Wr(n,cO).fold(function(){return Ji(n,"z-index")},function(t){return Ui(n,"z-index",t)}),Xr(n,cO)}),t.getSystem().removeFromGui(t)},fO=function(t,n,e){return t.getSystem().build(av.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},ra=Jn("snaps",[Pn("getSnapPoints"),aa("onSensor"),Pn("leftAttr"),Pn("topAttr"),$n("lazyViewport",Vu),$n("mustSnap",!1)]),oa=[$n("useFixed",l),Pn("blockerClass"),$n("getTarget",w),$n("onDrag",Q),$n("repositionTarget",!0),$n("onDrop",Q),oe("getBounds",Vu),ra],dO=function(n){return t=qi(n,"left"),e=qi(n,"top"),o=qi(n,"position"),r=function(t,n,e){return("fixed"===e?tO:Q1)(parseInt(t,10),parseInt(n,10))},(t.isSome()&&e.isSome()&&o.isSome()?tt.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):tt.none()).getOrThunk(function(){var t=bu(n);return Z1(t.left,t.top)});var t,e,o,r},mO=function(e,t,r,i,u,a,n){var o,c,s,l,f,d=t.fold(function(){var e,o,t=(e=a.left,o=a.top,r.fold(function(t,n){return Q1(t+e,n+o)},function(t,n){return Z1(t+e,n+o)},function(t,n){return tO(t+e,n+o)})),t=Y1(t,i,u);return tO(t.left,t.top)},function(n){var t=oO(e,n,r,a,i,u);return t.extra.each(function(t){n.onSensor(e,t)}),t.coord});return o=d,c=i,s=u,t=(l=n).bounds,d=q1(o,c,s),n=gc(d.left,t.x,t.x+t.width-l.width),l=gc(d.top,t.y,t.y+t.height-l.height),f=Z1(n,l),o.fold(function(){var t=K1(f,c,s);return Q1(t.left,t.top)},function(){return f},function(){var t=Y1(f,c,s);return tO(t.left,t.top)})},gO=function(t,n){return{bounds:t.getBounds(),height:gu(n.element),width:Su(n.element)}},pO=function(c,s,t,n,e){var e=t.update(n,e),l=t.getStartData().getOrThunk(function(){return gO(s,c)});e.each(function(t){var n,e,o,r,i,u,a;n=c,o=l,r=t,a=(e=s).getTarget(n.element),e.repositionTarget&&(u=gr(n.element),i=_u(u),t=rC(a),u=dO(a),o=mO(n,e.snaps,u,i,t,r,o),t=J1(o,0,t),Gi(a,t)),e.onDrag(n,a,r)})},hO=function(n,t,e,o){t.each(lO),e.snaps.each(function(t){rO(n,t)});t=e.getTarget(n.element);o.reset(),e.onDrop(n,t)},fu=function(t){return function(n,e){var o=function(t){e.setStartData(gO(n,t))};return qo(p([$o(Bo(),function(t){e.getStartData().each(function(){return o(t)})})],t(n,e,o)))}},vO=Object.freeze({__proto__:null,getData:function(t){return tt.from(hu(t.x,t.y))},getDelta:function(t,n){return hu(n.left-t.left,n.top-t.top)}}),bO=function(i,u,a){return[$o(to(),function(n,t){var e,o,r;0===t.event.raw.button&&(t.stop(),t={drop:t=function(){return hO(n,tt.some(o),i,u)},delayDrop:(e=Yh(t,200)).schedule,forceDrop:t,move:function(t){e.cancel(),pO(n,i,u,vO,t)}},o=fO(n,i.blockerClass,(r=t,qo([$o(to(),r.forceDrop),$o(oo(),r.drop),$o(no(),function(t,n){r.move(n.event)}),$o(eo(),r.delayDrop)]))),a(n),sO(n,o))})]},re=p(oa,[la("dragger",{handlers:fu(bO)})]),yO=Object.freeze({__proto__:null,getData:function(t){t=t.raw.touches;return 1===t.length?function(t){t=t[0];return tt.some(hu(t.clientX,t.clientY))}(t):tt.none()},getDelta:function(t,n){return hu(n.left-t.left,n.top-t.top)}}),xO=function(r,i,u){var a=ae(tt.none());return[$o(Je(),function(n,t){t.stop();var e,t=function(){hO(n,a.get(),r,i),a.set(tt.none())},o=fO(n,r.blockerClass,(e={drop:t,delayDrop:Q,forceDrop:t,move:function(t){pO(n,r,i,yO,t)}},qo([$o(Je(),e.forceDrop),$o(Qe(),e.drop),$o(Ze(),e.drop),$o($e(),function(t,n){e.move(n.event)})])));a.set(tt.some(o));u(n),sO(n,o)}),$o($e(),function(t,n){n.stop(),pO(t,r,i,yO,n.event)}),$o(Qe(),function(t,n){n.stop(),hO(t,a.get(),r,i),a.set(tt.none())}),$o(Ze(),function(t){hO(t,a.get(),r,i),a.set(tt.none())})]},Mt=p(oa,[la("dragger",{handlers:fu(xO)})]),xe=p(oa,[la("dragger",{handlers:fu(function(t,n,e){return p(bO(t,n,e),xO(t,n,e))})})]),wO=h({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:re,touch:Mt,mouseOrTouch:xe}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:tt.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var r=tt.none(),n=tt.none(),t=W({});return pi({readState:t,reset:function(){r=tt.none(),n=tt.none()},update:function(o,t){return o.getData(t).bind(function(t){return n=o,e=t,t=r.map(function(t){return n.getDelta(t,e)}),r=tt.some(e),t;var n,e})},getStartData:function(){return n},setStartData:function(t){n=tt.some(t)}})}}),apis:Ua}),SO=function(t,o,r,i,n,e){return t.fold(function(){return wO.snap({sensor:Z1(r-20,i-20),range:hu(n,e),output:Z1(tt.some(r),tt.some(i)),extra:{td:o}})},function(t){var n=r-20,e=i-20,t=t.element.dom.getBoundingClientRect();return wO.snap({sensor:Z1(n,e),range:hu(40,40),output:Z1(tt.some(r-t.width/2),tt.some(i-t.height/2)),extra:{td:o}})})},kO=function(t,r,i){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,n){var e,o=n.td;n=r.get(),e=o,n.exists(function(t){return Ne(t,e)})||(r.set(tt.some(o)),i(o))},mustSnap:!0}},CO=function(t){return om(em.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Ka([wO.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),sb.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},OO=function(i,e){var o=ae([]),r=ae([]),t=ae(!1),u=ae(tt.none()),a=ae(tt.none()),n=function(t){var n=Ru(t);return SO(f.getOpt(e),t,n.x,n.y,n.width,n.height)},c=function(t){var n=Ru(t);return SO(d.getOpt(e),t,n.right,n.bottom,n.width,n.height)},s=kO(function(){return F(o.get(),n)},u,function(n){a.get().each(function(t){i.fire("TableSelectorChange",{start:n,finish:t})})}),l=kO(function(){return F(r.get(),c)},a,function(n){u.get().each(function(t){i.fire("TableSelectorChange",{start:t,finish:n})})}),f=CO(s),d=CO(l),m=su(f.asSpec()),g=su(d.asSpec()),p=function(t,n,e,o){e=e(n);wO.snapTo(t,e);!function(t,n,e,o){var r=n.dom.getBoundingClientRect();Ji(t.element,"display");n=vr(se.fromDom(i.getBody())).dom.innerHeight,e=e(r),n=o(r,n);(e||n)&&Ui(t.element,"display","none")}(t,n,function(t){return t[o]<0},function(t,n){return t[o]>n})},h=function(t){return p(m,t,n,"top")},v=function(t){return p(g,t,c,"bottom")};Pe().deviceType.isTouch()&&(i.on("TableSelectionChange",function(n){t.get()||(Rs(e,m),Rs(e,g),t.set(!0)),u.set(tt.some(n.start)),a.set(tt.some(n.finish)),n.otherCells.each(function(t){o.set(t.upOrLeftCells),r.set(t.downOrRightCells),h(n.start),v(n.finish)})}),i.on("ResizeEditor ResizeWindow ScrollContent",function(){u.get().each(h),a.get().each(v)}),i.on("TableSelectionClear",function(){t.get()&&(Hs(m),Hs(g),t.set(!1)),u.set(tt.none()),a.set(tt.none())}))},_O=function(i,o,r){o.delimiter||(o.delimiter="\xbb");return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Ka([cd.config({mode:"flow",selector:"div[role=button]"}),Vg.config({disabled:r.isDisabled}),ap(),lv.config({}),md.config({}),gd("elementPathEvents",[rr(function(n,t){i.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return cd.focusIn(n)}),i.on("NodeChange",function(t){var e,t=function(t){for(var n=[],e=t.length;0<e--;){var o=t[e];if(1===o.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(o)){var r=i.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||n.push({name:r.name,element:o}),r.isPropagationStopped())break}}return n}(t.parents);0<t.length?md.set(n,(t=F((t=t)||[],function(n,t){return em.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":t,"tab-index":-1,"aria-level":t+1},innerHtml:n.name},action:function(t){i.focus(),i.selection.select(n.element),i.nodeChanged()},buttonBehaviours:Ka([sp(r.isDisabled),ap()])})}),e={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+o.delimiter+" "}},P(t.slice(1),function(t,n){return t.push(e),t.push(n),t},[t[0]]))):md.set(n,[])})})])]),components:[]}};(ra=kk=kk||{})[ra.None=0]="None",ra[ra.Both=1]="Both",ra[ra.Vertical=2]="Vertical";var TO,EO,DO,BO=function(t,n,e){var o,r,i,u,a=se.fromDom(t.getContainer()),e=(o=t,r=n,i=e,u=mu(a),n=wu(a),(e={}).height=r1(u+r.top,Lg(o),Ug(o)),i===kk.Both&&(e.width=r1(n+r.left,Ng(o),jg(o))),e);St(e,function(t,n){return Ui(a,n,o1(t)),0}),t.fire("ResizeEditor")},AO=function(t,n,e,o){o=hu(20*e,20*o);return BO(t,o,n),tt.some(!0)},MO=function(o,t){var n,e,r=(e=!(n=o).hasPlugin("autoresize"),!1===(e=n.getParam("resize",e))?kk.None:"both"===e?kk.Both:kk.Vertical);return r===kk.None?tt.none():tt.some({dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},innerHtml:im("resize-handle",t.icons)},behaviours:Ka([wO.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,e){return BO(o,e,r)},blockerClass:"tox-blocker"}),cd.config({mode:"special",onLeft:function(){return AO(o,r,-1,0)},onRight:function(){return AO(o,r,1,0)},onUp:function(){return AO(o,r,0,-1)},onDown:function(){return AO(o,r,0,1)}}),lv.config({}),hd.config({})])})},FO=function(i,u){var t,n;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(t=function(){var t,o,r,n,e=[];return i.getParam("elementpath",!0,"boolean")&&e.push(_O(i,{},u)),i.hasPlugin("wordcount")&&e.push((t=i,o=u,r=function(t,n,e){return md.set(t,[uu(o.translate(["{0} "+e,n[e]]))])},em.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Ka([sp(o.isDisabled),ap(),lv.config({}),md.config({}),al.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),gd("wordcount-events",[ar(function(t){var n=al.getValue(t),e="words"===n.mode?"characters":"words";al.setValue(t,{mode:e,count:n.count}),r(t,n.count,e)}),rr(function(e){t.on("wordCountUpdate",function(t){var n=al.getValue(e).mode;al.setValue(e,{mode:n,count:t.wordCount}),r(e,t.wordCount,n)})})])]),eventOrder:((n={})[wo()]=["disabling","alloy.base.behaviour","wordcount-events"],n)}))),i.getParam("branding",!0,"boolean")&&e.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(n=Og.translate(["Powered by {0}","Tiny"]))+'">'+n+"</a>"}}),0<e.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]}(),n=MO(i,u),t.concat(n.toArray()))}},IO=function(m){var t,n,e,o=m.inline,g=o?s1:n1,p=ep(m)?TC:eC,r=tt.none(),i=Pe(),u=i.browser.isIE()?["tox-platform-ie"]:[],a=i.deviceType.isTouch()?["tox-platform-touch"]:[],c=$g(m),s=tp(m),l=Og.isRtl()?{attributes:{dir:"rtl"}}:{},f={attributes:((E={})[Ic]=c?Ku.BottomToTop:Ku.TopToBottom,E)},h=function(){return r.bind(UC.getHeader)},d=function(){Ui(K.element,"width",document.body.clientWidth+"px")},v=su((t=Ne(zi(),s)&&"grid"===Xi(s,"display"),n={dom:Z({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(u).concat(a)},l),behaviours:Ka([Bs.config({useFixed:function(){return p.isDocked(h)}})])},e={dom:{styles:{width:document.body.clientWidth+"px"}},events:qo([$o(Ao(),d)])},Rt(n,t?e:{}))),b=function(){return it.value(v)},y=om({dom:{tag:"div",classes:["tox-anchorbar"]}}),x=function(){return r.bind(function(t){return UC.getThrobber(t)}).getOrDie("Could not find throbber element")},w=eS(v,m,function(){return r.bind(function(t){return y.getOpt(t)}).getOrDie("Could not find a anchor bar element")}),S=UC.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:w,onEscape:function(){m.focus()}}),k=Kg(m),C=UC.parts.toolbar(Z({dom:{tag:"div",classes:["tox-toolbar"]},getSink:b,providers:w.shared.providers,onEscape:function(){m.focus()},type:k,lazyToolbar:function(){return r.bind(function(t){return UC.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return h().getOrDie("Could not find header element")}},f)),O=UC.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:w.shared.providers,onEscape:function(){m.focus()},type:k}),_=UC.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),T=UC.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),i=UC.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:w}),E=m.getParam("statusbar",!0,"boolean")&&!o?tt.some(FO(m,w.shared.providers)):tt.none(),_={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[_,T]},D=Yg(m),B=Gg(m),T=Wg(m),S=UC.parts.header({dom:Z({tag:"div",classes:["tox-editor-header"]},f),components:et([T?[S]:[],D?[O]:B?[C]:[],Zg(m)?[]:[y.asSpec()]]),sticky:ep(m),editor:m,sharedBackstage:w.shared}),S=et([c?[]:[S],o?[]:[_],c?[S]:[]]),S=et([[{dom:{tag:"div",classes:["tox-editor-container"]},components:S}],o?[]:E.toArray(),[i]]),E=np(m),i=Z(Z({role:"application"},Og.isRtl()?{dir:"rtl"}:{}),E?{"aria-hidden":"true"}:{}),A=su(UC.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(o?["tox-tinymce-inline"]:[]).concat(c?["tox-tinymce--toolbar-bottom"]:[]).concat(a).concat(u),styles:Z({visibility:"hidden"},E?{opacity:"0",border:"0"}:{}),attributes:i},components:S,behaviours:Ka([ap(),Vg.config({disableClass:"tox-tinymce--disabled"}),cd.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),r=tt.some(A);m.shortcuts.add("alt+F9","focus menubar",function(){UC.focusMenubar(A)}),m.shortcuts.add("alt+F10","focus toolbar",function(){UC.focusToolbar(A)}),m.addCommand("ToggleToolbarDrawer",function(){UC.toggleToolbarDrawer(A)}),m.addQueryStateHandler("ToggleToolbarDrawer",function(){return UC.isToolbarDrawerToggled(A)});var M,F,I,R,V,P,H,z,N,L,j,U,W,G,X,Y,q=cv(A),K=cv(v);M=m,F=q,I=K,R=function(n,e){nt([F,I],function(t){t.broadcastEvent(n,e)})},V=function(n,e){nt([F,I],function(t){t.broadcastOn([n],e)})},S=function(t){return V(Js(),{target:t.target})},P=Uh(se.fromDom(document),"touchstart",S),H=Uh(se.fromDom(document),"touchmove",function(t){return R(Eo(),t)}),z=Uh(se.fromDom(document),"touchend",function(t){return R(Do(),t)}),N=Uh(se.fromDom(document),"mousedown",S),L=Uh(se.fromDom(document),"mouseup",function(t){0===t.raw.button&&V(Qs(),{target:t.target})}),j=function(t){return V(Js(),{target:se.fromDom(t.target)})},U=function(t){0===t.button&&V(Qs(),{target:se.fromDom(t.target)})},W=function(t){return R(Bo(),Gh(t))},G=function(t){V($s(),{}),R(Ao(),Gh(t))},X=function(){return V($s(),{})},Y=function(t){t.state&&V(Js(),{target:se.fromDom(M.getContainer())})},M.on("PostRender",function(){M.on("click",j),M.on("tap",j),M.on("mouseup",U),M.on("ScrollWindow",W),M.on("ResizeWindow",G),M.on("ResizeEditor",X),M.on("AfterProgressState",Y)}),M.on("remove",function(){M.off("click",j),M.off("tap",j),M.off("mouseup",U),M.off("ScrollWindow",W),M.off("ResizeWindow",G),M.off("ResizeEditor",X),M.off("AfterProgressState",Y),N.unbind(),P.unbind(),H.unbind(),z.unbind(),L.unbind()}),M.on("detach",function(){js(F),js(I),F.destroy(),I.destroy()});var J=function(){var t,n=o1(i1(m)),t=o1(u1(t=m).getOr(zg(t)));return m.inline||(Ki("div","width",t)&&Ui(A.element,"width",t),Ki("div","height",n)?Ui(A.element,"height",n):Ui(A.element,"height","200px")),n};return{mothership:q,uiMothership:K,backstage:w,renderUI:function(){var o,r,e,n,i,u,a,c;p.setup(m,w.shared,h),S1(m,w),U1(m,b,w),r=(o=m).ui.registry.getAll().sidebars,nt(xt(r),function(n){var t=r[n],e=function(){return tt.from(o.queryCommandValue("ToggleSidebar")).is(n)};o.ui.registry.addToggleButton(n,{icon:t.icon,tooltip:t.tooltip,onAction:function(t){o.execCommand("ToggleSidebar",!1,n),t.setActive(e())},onSetup:function(t){var n=function(){return t.setActive(e())};return o.on("ToggleSidebar",n),function(){o.off("ToggleSidebar",n)}}})}),e=m,n=x,i=w.shared,u=ae(!1),a=ae(tt.none()),c=function(t){t!==u.get()&&(jC(n(),t,i.providers),u.set(t),e.fire("AfterProgressState",{state:t}))},e.on("ProgressState",function(t){var n;a.get().each(nm.clearTimeout),$(t.time)?(n=nm.setEditorTimeout(e,function(){return c(t.state)},t.time),a.set(tt.some(n))):(c(t.state),a.set(tt.none()))}),kt(m.getParam("toolbar_groups",{},"object"),function(t,n){m.ui.registry.addGroupToolbarButton(n,t)});var t=m.ui.registry.getAll(),s=t.buttons,l=t.menuItems,f=t.contextToolbars,d=t.sidebars,t=Xg(m),s={menuItems:l,menus:function(t){t=t.getParam("menu");return t?kt(t,function(t){return Z(Z({},t),{items:t.items})}):{}}(m),menubar:m.getParam("menubar"),toolbar:t.getOrThunk(function(){return m.getParam("toolbar",!0)}),allowToolbarGroups:k===Pm.floating,buttons:s,sidebar:d};Qk(m,f,v,{backstage:w}),OO(m,v);d=m.getElement(),f=J();return g.render(m,{mothership:q,uiMothership:K,outerContainer:A},s,w,{targetNode:d,height:f})},getUi:function(){return{channels:{broadcastAll:K.broadcast,broadcastOn:K.broadcastOn,register:Q}}}}},oa=W([Pn("lazySink"),Gn("dragBlockClass"),oe("getBounds",Vu),$n("useTabstopAt",S),$n("eventOrder",{}),po("modalBehaviours",[cd]),ca("onExecute"),t("onEscape")]),fu={sketch:w},h=W([Cl({name:"draghandle",overrides:function(t,n){return{behaviours:Ka([wO.config({mode:"mouse",getTarget:function(t){return ju(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),kl({schema:[Pn("dom")],name:"title"}),kl({factory:fu,schema:[Pn("dom")],name:"close"}),kl({factory:fu,schema:[Pn("dom")],name:"body"}),Cl({factory:fu,schema:[Pn("dom")],name:"footer"}),Dn({factory:{sketch:function(t,n){return Z(Z({},t),{dom:n.dom,components:n.components})}},schema:[$n("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),$n("components",[])],name:"blocker"})]),re=Object.freeze({__proto__:null,block:function(t,n,e,o){jr(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=Ka([cd.config({mode:"special",onTab:function(){return tt.some(!0)},onShiftTab:function(){return tt.some(!0)}}),hd.config({})]),i=o(r,i),u=r.getSystem().build(i);md.append(r,lu(u)),u.hasConfigured(cd)&&cd.focusIn(u),e.isBlocked()||n.onBlock(t),e.blockWith(function(){return md.remove(r,u)})},unblock:function(t,n,e){Xr(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),Mt=[oe("getRoot",tt.none),aa("onBlock"),aa("onUnblock")],RO=$a({fields:Mt,name:"blocking",apis:re,state:Object.freeze({__proto__:null,init:function(){var n=Vk();return pi({readState:n.isSet,blockWith:function(t){n.set({destroy:t})},clear:n.clear,isBlocked:n.isSet})}})}),VO=il({name:"ModalDialog",configFields:oa(),partFields:h(),factory:function(i,t,n,o){var r=ae(tt.none()),e=Qr("modal-events"),u=Z(Z({},i.eventOrder),((u={})[Mo()]=[e].concat(i.eventOrder["alloy.system.attached"]||[]),u));return{uid:i.uid,dom:i.dom,components:t,apis:{show:function(t){r.set(tt.some(t));var n=i.lazySink(t).getOrDie(),e=o.blocker(),e=n.getSystem().build(Z(Z({},e),{components:e.components.concat([lu(t)]),behaviours:Ka([hd.config({}),gd("dialog-blocker-events",[or(io(),function(){cd.focusIn(t)})])])}));Rs(n,e),cd.focusIn(t)},hide:function(n){r.set(tt.none()),br(n.element).each(function(t){n.getSystem().getByDom(t).each(function(t){Hs(t)})})},getBody:function(t){return Rl(t,i,"body")},getFooter:function(t){return Rl(t,i,"footer")},setIdle:function(t){RO.unblock(t)},setBusy:function(t,n){RO.block(t,n)}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:sl(i.modalBehaviours,[md.config({}),cd.config({mode:"cyclic",onEnter:i.onExecute,onEscape:i.onEscape,useTabstopAt:i.useTabstopAt}),RO.config({getRoot:r.get}),gd(e,[rr(function(t){var n,e,o,r;n=t.element,e=Rl(t,i,"title").element,o=Wr(n,"id").fold(function(){var t=Qr("dialog-label");return jr(e,"id",t),t},w),jr(n,"aria-labelledby",o),o=t.element,r=Rl(t,i,"body").element,t=tt.from(Ur(o,"id")).fold(function(){var t=Qr("dialog-describe");return jr(r,"id",t),t},w),jr(o,"aria-describedby",t)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),xe=an([zn("type"),zn("name")].concat(Kr)),Ua=Mn,ra=[gn("name","name",jt(function(){return Qr("button-name")}),An),qn("icon"),ne("align","end",["start","end"]),ee("primary",!1),ee("disabled",!1)],ca=p(ra,[zn("text")]),t=p([Nn("type",["submit","cancel","custom"])],ca),fu=p([Nn("type",["menu"]),qn("text"),qn("tooltip"),qn("icon"),Wn("items",xe)],ra),Dn=Tn("type",{submit:t,cancel:t,custom:t,menu:fu}),Mt=[zn("type"),zn("text"),Nn("level",["info","warn","error","success"]),zn("icon"),$n("url","")],PO=an(Mt),re=[zn("type"),zn("text"),ee("disabled",!1),ee("primary",!1),gn("name","name",jt(function(){return Qr("button-name")}),An),qn("icon"),ee("borderless",!1)],HO=an(re),oa=[zn("type"),zn("name"),zn("label"),ee("disabled",!1)],zO=an(oa),h=Mn,Kr=[zn("type"),zn("name")],xe=Kr.concat([qn("label")]),ra=xe.concat([$n("columns","auto")]),NO=an(ra),t=bn([zn("value"),zn("text"),zn("icon")]),LO=an(xe),fu=An,jO=an(xe),Mt=An,UO=Kr.concat([te("tag","textarea"),zn("scriptId"),zn("scriptUrl"),(TO=undefined,Qn("settings",TO,Rn))]),WO=Kr.concat([te("tag","textarea"),Ln("init")]),GO=xn(function(t){return Sn("customeditor.old",un(WO),t).orThunk(function(){return Sn("customeditor.new",un(UO),t)})}),re=An,XO=an(xe),oa=cn(vn),YO=function(t){return[zn("type"),Hn("columns",Bn),t]},ra=[zn("type"),zn("html"),ne("presets","presentation",["presentation","document"])],qO=an(ra),bn=xe.concat([ee("sandboxed",!0)]),KO=an(bn),Kr=An,Ln=xe.concat([Hn("currentState",an([Pn("blob"),zn("url")]))]),JO=an(Ln),ra=xe.concat([qn("inputMode"),qn("placeholder"),ee("maximized",!1),ee("disabled",!1)]),$O=an(ra),bn=An,Ln=[zn("text"),zn("value")],ra=[zn("text"),Wn("items",(EO=function(){return QO},DO=Pt(function(){return EO()}),{extract:function(t,n,e){return DO().extract(t,n,e)},toString:function(){return DO().toString()}}))],QO=sn([an(Ln),an(ra)]),sn=xe.concat([Wn("items",QO),ee("disabled",!1)]),ZO=an(sn),Ln=An,ra=xe.concat([Un("items",[zn("text"),zn("value")]),Zn("size",1),ee("disabled",!1)]),t_=an(ra),sn=An,Zn=xe.concat([ee("constrain",!0),ee("disabled",!1)]),n_=an(Zn),ra=an([zn("width"),zn("height")]),Zn=[zn("type"),Wn("header",An),Wn("cells",cn(An))],e_=an(Zn),ee=xe.concat([qn("placeholder"),ee("maximized",!1),ee("disabled",!1)]),o_=an(ee),ee=An,ne=xe.concat([ne("filetype","file",["image","media","file"]),$n("disabled",!1)]),r_=an(ne),ne=an([zn("value"),$n("meta",{})]),i_=function(n){return gn("items","items",Nt(),cn(xn(function(t){return Sn("Checking item of "+n,u_,t).fold(function(t){return it.error(On(t))},function(t){return it.value(t)})})))},u_=yn(function(){return _n("type",{alertbanner:PO,bar:an((t=i_("bar"),[zn("type"),t])),button:HO,checkbox:zO,colorinput:LO,colorpicker:jO,dropzone:XO,grid:an(YO(i_("grid"))),iframe:KO,input:$O,listbox:ZO,selectbox:t_,sizeinput:n_,textarea:o_,urlinput:r_,customeditor:GO,htmlpanel:qO,imagetools:JO,collection:NO,label:an((t=i_("label"),[zn("type"),zn("label"),t])),table:e_,panel:a_});var t}),yn=[zn("type"),$n("classes",[]),Wn("items",u_)],a_=an(yn),jt=[gn("name","name",jt(function(){return Qr("tab-name")}),An),zn("title"),Wn("items",u_)],jt=[zn("type"),Un("tabs",jt)],jt=an(jt),ca=ca,Dn=Dn,c_=an([zn("title"),Hn("body",_n("type",{panel:a_,tabpanel:jt})),te("size","normal"),Wn("buttons",Dn),$n("initialData",{}),oe("onAction",Q),oe("onChange",Q),oe("onSubmit",Q),oe("onClose",Q),oe("onCancel",Q),$n("onTabChange",Q)]),s_=an(p([Nn("type",["cancel","custom"])],ca)),l_=an([zn("title"),zn("url"),Yn("height"),Yn("width"),Xn("buttons",cn(s_)),oe("onAction",Q),oe("onCancel",Q),oe("onClose",Q),oe("onMessage",Q)]),f_=function(t){return b(t)?[t].concat(N(Et(t),f_)):c(t)?N(t,f_):[]},d_=function(t){return v(t.type)&&v(t.name)},m_={checkbox:h,colorinput:fu,colorpicker:Mt,dropzone:oa,input:bn,iframe:Kr,sizeinput:ra,selectbox:sn,listbox:Ln,size:ra,textarea:ee,urlinput:ne,customeditor:re,collection:t,togglemenuitem:Ua},g_=function(t){t=R(f_(t),d_),t=N(t,function(n){return tt.from(m_[n.type]).fold(function(){return[]},function(t){return[Hn(n.name,t)]})});return an(t)},p_=function(t){return{internalDialog:kn(Sn("dialog",c_,t)),dataValidator:g_(t),initialData:t.initialData}},h_={open:function(t,n){n=p_(n);return t(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(t,n){return t(kn(Sn("dialog",l_,n)))},redial:p_},v_=function(t){var e=[],o={};return St(t,function(t,n){t.fold(function(){e.push(n)},function(t){o[n]=t})}),0<e.length?it.error(e):it.value(o)},Ua=Yl({name:"TabButton",configFields:[$n("uid",undefined),Pn("value"),gn("dom","dom",Ut(function(){return{attributes:{role:"tab",id:Qr("aria"),"aria-selected":"false"}}}),En()),Gn("action"),$n("domModification",{}),po("tabButtonBehaviours",[hd,cd,al]),Pn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Td(t.action),behaviours:sl(t.tabButtonBehaviours,[hd.config({}),cd.config({mode:"execution",useSpace:!0,useEnter:!0}),al.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),ia=W([Pn("tabs"),Pn("dom"),$n("clickToDismiss",!1),po("tabbarBehaviours",[af,cd]),ia(["tabClass","selectedClass"])]),Ua=It({factory:Ua,name:"tabs",unit:"tab",overrides:function(o){var r=function(t,n){af.dehighlight(t,n),Uo(t,zo(),{tabbar:t,button:n})},i=function(t,n){af.highlight(t,n),Uo(t,Ho(),{tabbar:t,button:n})};return{action:function(t){var n=t.getSystem().getByUid(o.uid).getOrDie(),e=af.isHighlighted(n,t);(e&&o.clickToDismiss?r:e?Q:i)(n,t)},domModification:{classes:[o.markers.tabClass]}}}}),Ua=W([Ua]),b_=il({name:"Tabbar",configFields:ia(),partFields:Ua(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:sl(t.tabbarBehaviours,[af.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){jr(n.element,"aria-selected","true")},onDehighlight:function(t,n){jr(n.element,"aria-selected","false")}}),cd.config({mode:"flow",getInitial:function(t){return af.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),Ua=Yl({name:"Tabview",configFields:[po("tabviewBehaviours",[md])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:sl(t.tabviewBehaviours,[md.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),aa=W([$n("selectFirst",!0),aa("onChangeTab"),aa("onDismissTab"),$n("tabs",[]),po("tabSectionBehaviours",[])]),po=kl({factory:b_,schema:[Pn("dom"),jn("markers",[Pn("tabClass"),Pn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),Ua=kl({factory:Ua,name:"tabview"}),Ua=W([po,Ua]),y_=il({name:"TabSection",configFields:aa(),partFields:Ua(),factory:function(r,t,n,e){var o=function(t,n){Il(t,r,"tabbar").each(function(t){n(t).each(Wo)})};return{uid:r.uid,dom:r.dom,components:t,behaviours:cl(r.tabSectionBehaviours),events:qo(et([r.selectFirst?[rr(function(t,n){o(t,af.getFirst)})]:[],[$o(Ho(),function(t,n){var e,o,n=n.event.button;e=n,o=al.getValue(e),Il(e,r,"tabview").each(function(n){H(r.tabs,function(t){return t.value===o}).each(function(t){t=t.view();Wr(e.element,"id").each(function(t){jr(n.element,"aria-labelledby",t)}),md.set(n,t),r.onChangeTab(n,e,t)})})}),$o(zo(),function(t,n){n=n.event.button;r.onDismissTab(t,n)})]])),apis:{getViewItems:function(t){return Il(t,r,"tabview").map(function(t){return md.contents(t)}).getOr([])},showTab:function(t,e){o(t,function(n){var t=af.getCandidates(n);return H(t,function(t){return al.getValue(t)===e}).filter(function(t){return!af.isHighlighted(n,t)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),x_=function(t,n){Ui(t,"height",n+"px"),Pe().browser.isIE()?Ji(t,"flex-basis"):Ui(t,"flex-basis",n+"px")},w_=function(t,a,n){ju(t,'[role="dialog"]').each(function(u){Uu(u,'[role="tablist"]').each(function(i){n.get().map(function(t){return Ui(a,"height","0"),Ui(a,"flex-basis","0"),Math.min(t,(e=a,o=i,r=hr(n=u).dom,t=ju(n,".tox-dialog-wrap").getOr(n),t="fixed"===Xi(t,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight),r=mu(e),e=e.dom.offsetLeft>=o.dom.offsetLeft+wu(o)?Math.max(mu(o),r):r,o=parseInt(Xi(n,"margin-top"),10)||0,r=parseInt(Xi(n,"margin-bottom"),10)||0,t-(mu(n)+o+r-e)));var n,e,o,r}).each(function(t){x_(a,t)})})})},S_=function(t){return Uu(t,'[role="tabpanel"]')},k_=function(i){var u;return{smartTabHeight:(u=ae(tt.none()),{extraEvents:[rr(function(t){var o=t.element;S_(o).each(function(n){var e;Ui(n,"visibility","hidden"),t.getSystem().getByDom(n).toOptional().each(function(t){var e,o,r,t=(o=n,r=t,F(e=i,function(t,n){md.set(r,e[n].view());n=o.dom.getBoundingClientRect();return md.set(r,[]),n.height})),t=Y(G(t,function(t,n){return n<t?-1:t<n?1:0}));u.set(t)}),w_(o,n,u),Ji(n,"visibility"),e=t,Y(i).each(function(t){return y_.showTab(e,t.value)}),nm.requestAnimationFrame(function(){w_(o,n,u)})})}),$o(Ao(),function(t){var n=t.element;S_(n).each(function(t){w_(n,t,u)})}),$o(Cv,function(t,n){var r=t.element;S_(r).each(function(n){var t=oc(_r(n));Ui(n,"visibility","hidden");var e=qi(n,"height").map(function(t){return parseInt(t,10)});Ji(n,"height"),Ji(n,"flex-basis");var o=n.dom.getBoundingClientRect().height;e.forall(function(t){return t<o})?(u.set(tt.from(o)),w_(r,n,u)):e.each(function(t){x_(n,t)}),Ji(n,"visibility"),t.each(ec)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},C_="send-data-to-section",O_="send-data-to-view",__=Qr("update-dialog"),T_=Qr("update-title"),E_=Qr("update-body"),D_=Qr("update-footer"),B_=Qr("body-send-message"),A_=function(t,n,s,e){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:Z(Z({},n.map(function(t){return{id:t}}).getOr({})),e?{"aria-live":"polite"}:{})},components:[],behaviours:Ka([By(0),qS.config({channel:E_,updateState:function(t,n){return tt.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"!==t.body.type?[(e=t.body,o=s,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(n=om(xy.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:F(e.items,function(t){return vw(n,t,o)})}}))).asSpec()]}],behaviours:Ka([cd.config({mode:"acyclic",useTabstopAt:x(Ky)}),Dy(n),Hy(n,{postprocess:function(t){return v_(t).fold(function(t){return console.error(t),{}},function(t){return t})}})])})]:[(n=t.body,r=s,i=ae({}),u=function(t){var n=al.getValue(t),t=v_(n).getOr({}),n=i.get(),t=Rt(n,t);i.set(t)},a=function(t){var n=i.get();al.setValue(t,n)},c=ae(null),t=F(n.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:r.shared.providers.translate(t.title)},view:function(){return[xy.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:F(t.items,function(t){return vw(n,t,r)}),formBehaviours:Ka([cd.config({mode:"acyclic",useTabstopAt:x(Ky)}),gd("TabView.form.events",[rr(a),ir(u)]),tc.config({channels:Yt([{key:C_,value:{onReceive:u}},{key:O_,value:{onReceive:a}}])})])}})]}}}),n=k_(t).smartTabHeight,y_.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){n=al.getValue(n);Uo(t,kv,{name:n,oldName:c.get()}),c.set(n)},tabs:t,components:[y_.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[b_.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Ka([lv.config({})])}),y_.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:n.selectFirst,tabSectionBehaviours:Ka([gd("tabpanel",n.extraEvents),cd.config({mode:"acyclic"}),$l.config({find:function(t){return Y(y_.getViewItems(t))}}),al.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([C_],{}),i.get()},setValue:function(t,n){i.set(n),t.getSystem().broadcastOn([O_],{})}}})])}))];var e,o,n,r,i,u,a,c},initialData:t})])}},M_=yp.deviceType.isTouch(),F_=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},I_=function(t,n){return VO.parts.close(em.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Ka([lv.config({})])}))},R_=function(){return VO.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},V_=function(t,n){return VO.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:LC("<p>"+n.translate(t)+"</p>")}]}]})},P_=function(t){return VO.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},H_=function(t,n){return[av.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),av.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},z_=function(n){var t="tox-dialog",e=t+"-wrap",o=e+"__backdrop",r=t+"__disable-scroll";return VO.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),tt.some(!0)},useTabstopAt:function(t){return!Ky(t)},dom:{tag:"div",classes:[t].concat(n.extraClasses),styles:Z({position:"relative"},n.extraStyles)},components:p([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:LC('<div class="'+e+'"></div>'),components:[{dom:{tag:"div",classes:M_?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:e,modalBehaviours:Ka(p([hd.config({}),gd("dialog-events",n.dialogEvents.concat([or(io(),function(t,n){cd.focusIn(t)})])),gd("scroll-lock",[rr(function(){Ai(zi(),r)}),ir(function(){Fi(zi(),r)})])],n.extraBehaviours)),eventOrder:Z(((e={})[wo()]=["dialog-events"],e[Mo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],e[Fo()]=["alloy.base.behaviour","dialog-events","scroll-lock"],e),n.eventOrder)})},N_=function(t){return em.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:im("close",t.icons)}}],action:function(t){jo(t,bv)}})},L_=function(t,n,e){var o=function(t){return[uu(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:Z({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:Ka([qS.config({channel:T_,renderComponents:o})])}},j_=function(){return{dom:LC('<div class="tox-dialog__draghandle"></div>')}},U_=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,t=VO.parts.title(L_(e,tt.none(),o)),n=VO.parts.draghandle(j_()),o=VO.parts.close(N_(o)),o=[t].concat(e.draggable?[n]:[]).concat([o]),av.sketch({dom:LC('<div class="tox-dialog__header"></div>'),components:o});var e,o},W_=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:LC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},G_=function(t,o,n){return{onClose:function(){return n.closeWindow()},onBlock:function(e){VO.setBusy(t(),function(t,n){return W_(e.message,n,o)})},onUnblock:function(){VO.setIdle(t())}}},X_=function(t,n,e,o){return su(z_(Z(Z({},t),{lazySink:o.shared.getSink,extraBehaviours:p([qS.config({channel:__,updateState:function(t,n){return tt.some(n)},initialData:n}),Ly({})],t.extraBehaviours),onEscape:function(t){jo(t,bv)},dialogEvents:e,eventOrder:((e={})[xo()]=[qS.name(),tc.name()],e[Mo()]=["scroll-lock",qS.name(),"messages","dialog-events","alloy.base.behaviour"],e[Fo()]=["alloy.base.behaviour","dialog-events","messages",qS.name(),"scroll-lock"],e)})))},Y_=function(t){return F(t,function(t){return"menu"===t.type?(e=F((n=t).items,function(t){var n=ae(!1);return Z(Z({},t),{storage:n})}),Z(Z({},n),{items:e})):t;var n,e})},q_=function(t){return P(t,function(t,n){return"menu"!==n.type?t:P(n.items,function(t,n){return t[n.name]=n.storage,t},t)},{})},K_=function(t,e){return[nr(io(),qy),t(vv,function(t,n){e.onClose(),n.onClose()}),t(bv,function(t,n,e,o){n.onCancel(t),jo(o,vv)}),$o(Sv,function(t,n){return e.onUnblock()}),$o(wv,function(t,n){return e.onBlock(n.event)})]},J_=function(i,t){var n=function(t,r){return $o(t,function(e,o){u(e,function(t,n){r(i(),t,o.event,e)})})},u=function(n,e){qS.getState(n).get().each(function(t){e(t,n)})};return p(K_(n,t),[n(yv,function(t,n,e){n.onAction(t,{name:e.name})})])},$_=function(i,t,c){var n=function(t,r){return $o(t,function(e,o){u(e,function(t,n){r(i(),t,o.event,e)})})},u=function(n,e){qS.getState(n).get().each(function(t){e(t.internalDialog,n)})};return p(K_(n,t),[n(xv,function(t,n){return n.onSubmit(t)}),n(hv,function(t,n,e){n.onChange(t,{name:e.name})}),n(yv,function(t,n,e,o){var r=function(){return cd.focusIn(o)},i=function(t){return Gr(t,"disabled")||Wr(t,"aria-disabled").exists(function(t){return"true"===t})},u=_r(o.element),a=oc(u);n.onAction(t,{name:e.name,value:e.value}),oc(u).fold(r,function(n){i(n)||a.exists(function(t){return je(n,t)&&i(t)})?r():c().toOptional().filter(function(t){return!je(t.element,n)}).each(r)})}),n(kv,function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})}),ir(function(t){var n=i();al.setValue(t,n.getData())})])},Q_=function(t,n){var e=n.map(function(t){return t.footerButtons}).getOr([]),n=I(e,function(t){return"start"===t.align}),e=function(t,n){return av.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:F(n,function(t){return t.memento.asSpec()})})};return[e("start",n.pass),e("end",n.fail)]},Z_=function(t,e){return{dom:LC('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Ka([qS.config({channel:D_,initialData:t,updateState:function(t,n){var r=F(n.buttons,function(t){var n=om(b0(t,t.type,e));return{name:t.name,align:t.align,memento:n}});return tt.some({lookupByName:function(t,n){return e=t,o=n,H(r,function(t){return t.name===o}).bind(function(t){return t.memento.getOpt(e)});var e,o},footerButtons:r})},renderComponents:Q_})])}},tT=Z_,nT=function(t,n){return VO.parts.footer(Z_(t,n))},eT=function(n,e){if(n.getRoot().getSystem().isConnected()){var o=$l.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return xy.getField(o,e).fold(function(){var t=n.getFooter();return qS.getState(t).get().bind(function(t){return t.lookupByName(o,e)})},function(t){return tt.some(t)})}return tt.none()},oT=function(i,o,u){var t=function(t){var n=i.getRoot();n.getSystem().isConnected()&&t(n)},a={getData:function(){var t=i.getRoot(),n=t.getSystem().isConnected()?i.getFormWrapper():t,t=al.getValue(n),n=kt(u,function(t){return t.get()});return Z(Z({},t),n)},setData:function(r){t(function(t){var n=a.getData(),e=Z(Z({},n),r),o=function(t,n){t=t.getRoot();return qS.getState(t).get().map(function(t){return kn(Sn("data",t.dataValidator,n))}).getOr(n)}(i,e),n=i.getFormWrapper();al.setValue(n,o),St(u,function(t,n){Bt(e,n)&&t.set(e[n])})})},disable:function(t){eT(i,t).each(Vg.disable)},enable:function(t){eT(i,t).each(Vg.enable)},focus:function(t){eT(i,t).each(hd.focus)},block:function(n){if(!v(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){Uo(t,wv,{message:n})})},unblock:function(){t(function(t){jo(t,Sv)})},showTab:function(e){t(function(t){var n=i.getBody();qS.getState(n).get().exists(function(t){return t.isTabPanel()})&&$l.getCurrent(n).each(function(t){y_.showTab(t,e)})})},redial:function(e){t(function(t){var n=o(e);t.getSystem().broadcastOn([__],n),t.getSystem().broadcastOn([T_],n.internalDialog),t.getSystem().broadcastOn([E_],n.internalDialog),t.getSystem().broadcastOn([D_],n.internalDialog),a.setData(n.initialData)})},close:function(){t(function(t){jo(t,vv)})}};return a},rT=function(t,n,e){var o=U_(t.internalDialog.title,e),r=function(t,n){n=A_(t,tt.none(),n,!1);return VO.parts.body(n)}({body:t.internalDialog.body},e),i=Y_(t.internalDialog.buttons),u=q_(i),a=nT({buttons:i},e),c=$_(function(){return l},G_(function(){return s},e.shared.providers,n),e.shared.getSink),i=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),i={header:o,body:r,footer:tt.some(a),extraClasses:i,extraBehaviours:[],extraStyles:{}},s=X_(i,t,c,e),l=oT({getRoot:function(){return s},getBody:function(){return VO.getBody(s)},getFooter:function(){return VO.getFooter(s)},getFormWrapper:function(){var t=VO.getBody(s);return $l.getCurrent(t).getOr(t)}},n.redial,u);return{dialog:s,instanceApi:l}},iT=function(t,n,o,e){var r,i=Qr("dialog-label"),u=Qr("dialog-content"),r=om((r={title:t.internalDialog.title,draggable:!0},c=i,s=o.shared.providers,av.sketch({dom:LC('<div class="tox-dialog__header"></div>'),components:[L_(r,tt.some(c),s),j_(),N_(s)],containerBehaviours:Ka([wO.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Wu(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),a=om((c={body:t.internalDialog.body},s=o,e=e,A_(c,tt.some(u),s,e))),c=Y_(t.internalDialog.buttons),s=q_(c),l=om(tT({buttons:c},o)),e=$_(function(){return d},{onBlock:function(e){RO.block(f,function(t,n){return W_(e.message,n,o.shared.providers)})},onUnblock:function(){RO.unblock(f)},onClose:function(){return n.closeWindow()}},o.shared.getSink),f=su({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((c={role:"dialog"})["aria-labelledby"]=i,c["aria-describedby"]=""+u,c)},eventOrder:((c={})[xo()]=[qS.name(),tc.name()],c[wo()]=["execute-on-form"],c[Mo()]=["reflecting","execute-on-form"],c),behaviours:Ka([cd.config({mode:"cyclic",onEscape:function(t){return jo(t,vv),tt.some(!0)},useTabstopAt:function(t){return!Ky(t)&&("button"!==cr(t)||"disabled"!==Ur(t,"disabled"))}}),qS.config({channel:__,updateState:function(t,n){return tt.some(n)},initialData:t}),hd.config({}),gd("execute-on-form",e.concat([or(io(),function(t,n){cd.focusIn(t)})])),RO.config({getRoot:function(){return tt.some(f)}}),md.config({}),Ly({})]),components:[r.asSpec(),a.asSpec(),l.asSpec()]}),d=oT({getRoot:function(){return f},getFooter:function(){return l.get(f)},getBody:function(){return a.get(f)},getFormWrapper:function(){var t=a.get(f);return $l.getCurrent(t).getOr(t)}},n.redial,s);return{dialog:f,instanceApi:d}},uT=tinymce.util.Tools.resolve("tinymce.util.URI"),aT=["insertContent","setContent","execCommand","close","block","unblock"],cT=function(t){return b(t)&&-1!==aT.indexOf(t.mceAction)},sT=function(e,t,o,n){var r,i,u=U_(e.title,n),a=function(t){t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Xy({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Ka([lv.config({}),hd.config({})])})]}],behaviours:Ka([cd.config({mode:"acyclic",useTabstopAt:x(Ky)})])};return VO.parts.body(t)}(e),c=e.buttons.bind(function(t){return 0===t.length?tt.none():tt.some(nT({buttons:t},n))}),s=J_(function(){return h},G_(function(){return p},n.shared.providers,t)),l=Z(Z({},e.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),e.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),f=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],d=new uT(e.url,{base_uri:new uT(window.location.href)}),m=d.protocol+"://"+d.host+(d.port?":"+d.port:""),g=ae(tt.none()),t=[gd("messages",[rr(function(){var t=Uh(se.fromDom(window),"message",function(t){var n;d.isSameOrigin(new uT(t.raw.origin))&&(n=t.raw.data,cT(n)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!y(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(o,h,n):!cT(t=n)&&b(t)&&Bt(t,"mceAction")&&e.onMessage(h,n))});g.set(tt.some(t))}),ir(function(){g.get().each(function(t){return t.unbind()})})]),tc.config({channels:((t={})[B_]={onReceive:function(t,n){Uu(t.element,"iframe").each(function(t){t.dom.contentWindow.postMessage(n,m)})}},t)})],p=X_({header:u,body:a,footer:c,extraClasses:f,extraBehaviours:t,extraStyles:l},e,s,n),h=(i=function(t){r.getSystem().isConnected()&&t(r)},{block:function(n){if(!v(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");i(function(t){Uo(t,wv,{message:n})})},unblock:function(){i(function(t){jo(t,Sv)})},close:function(){i(function(t){jo(t,vv)})},sendMessage:function(n){i(function(t){t.getSystem().broadcastOn([B_],n)})}});return{dialog:r=p,instanceApi:h}},lT=function(t){var a,c,s,l,d=t.backstage,m=t.editor,g=ep(m),e=(c=(a=t).backstage.shared,{open:function(t,n){var e=function(){VO.hide(u),n()},o=om(b0({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:tt.none()},"cancel",a.backstage)),r=R_(),i=I_(e,c.providers),u=su(z_({lazySink:function(){return c.getSink()},header:F_(r,i),body:V_(t,c.providers),footer:tt.some(P_(H_([],[o.asSpec()]))),onEscape:e,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[$o(bv,e)],eventOrder:{}}));VO.show(u);o=o.get(u);hd.focus(o)}}),o=(l=(s=t).backstage.shared,{open:function(t,n){var e=function(t){VO.hide(a),n(t)},o=om(b0({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:tt.none()},"submit",s.backstage)),r=b0({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:tt.none()},"cancel",s.backstage),i=R_(),u=I_(function(){return e(!1)},l.providers),a=su(z_({lazySink:function(){return l.getSink()},header:F_(i,u),body:V_(t,l.providers),footer:tt.some(P_(H_([],[r,o.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[$o(bv,function(){return e(!1)}),$o(xv,function(){return e(!0)})],eventOrder:{}}));VO.show(a);o=o.get(a);hd.focus(o)}}),r=function(t,e){return h_.openUrl(function(t){var n=sT(t,{closeWindow:function(){VO.hide(n.dialog),e(n.instanceApi)}},m,d);return VO.show(n.dialog),n.instanceApi},t)},i=function(t,r){return h_.open(function(t,n,e){var n=n,o=rT({dataValidator:e,initialData:n,internalDialog:t},{redial:h_.redial,closeWindow:function(){VO.hide(o.dialog),r(o.instanceApi)}},d);return VO.show(o.dialog),o.instanceApi.setData(n),o.instanceApi},t)},u=function(t,s,l,f){return h_.open(function(t,n,e){var o,r,i=kn(Sn("data",e,n)),u=(o=ae(tt.none()),{clear:function(){return o.set(tt.none())},set:function(t){return o.set(tt.some(t))},isSet:function(){return o.get().isSome()},on:function(t){return o.get().each(t)}}),n=d.shared.header.isPositionedAtTop(),a=function(){return u.on(function(t){Gd.reposition(t),yC.refresh(t)})},c=iT({dataValidator:e,initialData:i,internalDialog:t},{redial:h_.redial,closeWindow:function(){u.on(Gd.hide),m.off("ResizeEditor",a),u.clear(),l(c.instanceApi)}},d,f),t=su(Gd.sketch(Z(Z({lazySink:d.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},n?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Ka(p([gd("window-manager-inline-events",[$o(Io(),function(t,n){jo(c.dialog,bv)})])],(r=m,t=n,g&&t?[]:[yC.config({contextual:{lazyContext:function(){return tt.some(Iu(se.fromDom(r.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return Xh(n=n,".tox-alert-dialog")||Xh(n,".tox-confirm-dialog")}})));return u.set(t),Gd.showWithin(t,s,lu(c.dialog),tt.some(zi())),g&&n||(yC.refresh(t),m.on("ResizeEditor",a)),c.instanceApi.setData(i),cd.focusIn(c.dialog),c.instanceApi},t)};return{open:function(t,n,e){return n!==undefined&&"toolbar"===n.inline?u(t,d.shared.anchors.inlineDialog(),e,n.ariaAttrs):n!==undefined&&"cursor"===n.inline?u(t,d.shared.anchors.cursor(),e,n.ariaAttrs):i(t,e)},openUrl:function(t,n){return r(t,n)},alert:function(t,n){e.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){o.open(t,function(t){n(t)})}}};r.add("silver",function(t){var n=IO(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,n=n.getUi;Lh(t,o.shared);t=lT({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:W(t),getNotificationManagerImpl:function(){return cm(0,{backstage:o},e)},ui:n()}})}();